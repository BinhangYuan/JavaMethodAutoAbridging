{"result":[{"Origin":"private void calculateCL(double[] x){\n\tvalue=0.0;\n\tif(derivativeNumerator == null){\n\t\tderivativeNumerator=new double[x.length];\n\t\tfor (int d=0; d < data.length; d++){\n\t\t\tint[] features=data[d];\n\t\t\tfor (int f=0; f < features.length; f++){\n\t\t\t\tint i=indexOf(features[f],labels[d]);\n\t\t\t\tif(dataweights == null){\n\t\t\t\t\tderivativeNumerator[i]-=1;\n\t\t\t\t} else {\n\t\t\t\t\tderivativeNumerator[i]-=dataweights[d];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tcopy(derivative,derivativeNumerator);\n\tdouble[] sums=new double[numClasses];\n\tdouble[] probs=new double[numClasses];\n\tfor (int d=0; d < data.length; d++){\n\t\tint[] features=data[d];\n\t\tArrays.fill(sums,0.0);\n\t\tfor (int c=0; c < numClasses; c++){\n\t\t\tfor (int f=0; f < features.length; f++){\n\t\t\t\tint i=indexOf(features[f],c);\n\t\t\t\tsums[c]+=x[i];\n\t\t\t}\n\t\t}\n\t\tdouble total=ArrayMath.logSum(sums);\n\t\tfor (int c=0; c < numClasses; c++){\n\t\t\tprobs[c]=Math.exp(sums[c] - total);\n\t\t\tif(dataweights != null){\n\t\t\t\tprobs[c]*=dataweights[d];\n\t\t\t}\n\t\t\tfor (int f=0; f < features.length; f++){\n\t\t\t\tint i=indexOf(features[f],c);\n\t\t\t\tderivative[i]+=probs[c];\n\t\t\t}\n\t\t}\n\t\tdouble dV=sums[labels[d]] - total;\n\t\tif(dataweights != null){\n\t\t\tdV*=dataweights[d];\n\t\t}\n\t\tvalue-=dV;\n\t}\n\tdouble[] newX=ArrayMath.pairwiseSubtract(x,weights);\n\tvalue+=prior.compute(newX,derivative);\n}","Original_Lines":46,"Target_Lines":15,"Manual":"private void calculateCL(double[] x){\n\tcopy(derivative,derivativeNumerator);\n\tdouble[] sums=new double[numClasses];\n\tdouble[] probs=new double[numClasses];\n\tfor (int d=0; d < data.length; d++){\n\t\tint[] features=data[d];\n\t\tArrays.fill(sums,0.0);\n\t\tdouble total=ArrayMath.logSum(sums);\n\t\tdouble dV=sums[labels[d]] - total;\n\t\tif(dataweights != null){\n\t\t\tdV*=dataweights[d];\n\t\t}\n\t\tvalue-=dV;\n\t}\n\tdouble[] newX=ArrayMath.pairwiseSubtract(x,weights);\n\tvalue+=prior.compute(newX,derivative);\n}","Distance":0.6666666666666666,"Automatic":"private void calculateCL(double[] x){\n\tif(derivativeNumerator == null){\n\t\tfor (int d=0; d < data.length; d++){\n\t\t\tint[] features=data[d];\n\t\t}\n\t}\n\tfor (int d=0; d < data.length; d++){\n\t\tint[] features=data[d];\n\t\tdouble total=ArrayMath.logSum(sums);\n\t\tfor (int c=0; c < numClasses; c++){\n\t\t\tprobs[c]=Math.exp(sums[c] - total);\n\t\t}\n\t\tdouble dV=sums[labels[d]] - total;\n\t}\n\tdouble[] newX=ArrayMath.pairwiseSubtract(x,weights);\n\tvalue+=prior.compute(newX,derivative);\n}"},{"Origin":"@Override protected void calculate(double[] x){\n\tif(derivative == null){\n\t\tderivative=new double[x.length];\n\t} else {\n\t\tArrays.fill(derivative,0.0);\n\t}\n\tvalue=0.0;\n\tdouble[] sums=new double[numClasses];\n\tdouble[] probs=new double[numClasses];\n\tdouble[] weightedProbs=new double[numClasses];\n\tfor (int d=0; d < data.length; d++){\n\t\tint[] features=data[d];\n\t\tint observedLabel=labels[d];\n\t\tArrays.fill(sums,0.0);\n\t\tfor (int c=0; c < numClasses; c++){\n\t\t\tfor (int f=0; f < features.length; f++){\n\t\t\t\tint i=indexOf(features[f],c);\n\t\t\t\tsums[c]+=x[i];\n\t\t\t}\n\t\t}\n\t\tdouble total=ArrayMath.logSum(sums);\n\t\tdouble[] weightedSums=new double[numClasses];\n\t\tfor (int trueLabel=0; trueLabel < numClasses; trueLabel++){\n\t\t\tweightedSums[trueLabel]=Math.log(confusionMatrix[observedLabel][trueLabel]) + sums[trueLabel];\n\t\t}\n\t\tdouble weightedTotal=ArrayMath.logSum(weightedSums);\n\t\tfor (int c=0; c < numClasses; c++){\n\t\t\tprobs[c]=Math.exp(sums[c] - total);\n\t\t\tweightedProbs[c]=Math.exp(weightedSums[c] - weightedTotal);\n\t\t\tfor (int f=0; f < features.length; f++){\n\t\t\t\tint i=indexOf(features[f],c);\n\t\t\t\tderivative[i]+=probs[c] - weightedProbs[c];\n\t\t\t}\n\t\t}\n\t\tdouble tmpValue=0.0;\n\t\tfor (int c=0; c < numClasses; c++){\n\t\t\ttmpValue+=confusionMatrix[observedLabel][c] * Math.exp(sums[c] - total);\n\t\t}\n\t\tvalue-=Math.log(tmpValue);\n\t}\n\tvalue+=prior.compute(x,derivative);\n}","Original_Lines":40,"Target_Lines":18,"Manual":"@Override protected void calculate(double[] x){\n\tfor (int d=0; d < data.length; d++){\n\t\tint[] features=data[d];\n\t\tint observedLabel=labels[d];\n\t\tArrays.fill(sums,0.0);\n\t\tdouble total=ArrayMath.logSum(sums);\n\t\tdouble[] weightedSums=new double[numClasses];\n\t\tdouble weightedTotal=ArrayMath.logSum(weightedSums);\n\t\tfor (int c=0; c < numClasses; c++){\n\t\t\tprobs[c]=Math.exp(sums[c] - total);\n\t\t\tweightedProbs[c]=Math.exp(weightedSums[c] - weightedTotal);\n\t\t}\n\t\tdouble tmpValue=0.0;\n\t\tfor (int c=0; c < numClasses; c++){\n\t\t\ttmpValue+=confusionMatrix[observedLabel][c] * Math.exp(sums[c] - total);\n\t\t}\n\t\tvalue-=Math.log(tmpValue);\n\t}\n\tvalue+=prior.compute(x,derivative);\n}","Distance":0.2777777777777778,"Automatic":"@Override protected void calculate(double[] x){\n\tdouble[] sums=new double[numClasses];\n\tdouble[] probs=new double[numClasses];\n\tdouble[] weightedProbs=new double[numClasses];\n\tfor (int d=0; d < data.length; d++){\n\t\tint[] features=data[d];\n\t\tint observedLabel=labels[d];\n\t\tArrays.fill(sums,0.0);\n\t\tdouble total=ArrayMath.logSum(sums);\n\t\tdouble[] weightedSums=new double[numClasses];\n\t\tdouble weightedTotal=ArrayMath.logSum(weightedSums);\n\t\tfor (int c=0; c < numClasses; c++){\n\t\t\tprobs[c]=Math.exp(sums[c] - total);\n\t\t\tweightedProbs[c]=Math.exp(weightedSums[c] - weightedTotal);\n\t\t}\n\t\tdouble tmpValue=0.0;\n\t\tvalue-=Math.log(tmpValue);\n\t}\n\tvalue+=prior.compute(x,derivative);\n}"},{"Origin":"@Override public Pair<GeneralDataset<L,F>,GeneralDataset<L,F>> split(double percentDev){\n\tint devSize=(int)(percentDev * size());\n\tint trainSize=size() - devSize;\n\tint[][] devData=new int[devSize][];\n\tint[] devLabels=new int[devSize];\n\tint[][] trainData=new int[trainSize][];\n\tint[] trainLabels=new int[trainSize];\n\tSystem.arraycopy(data,0,devData,0,devSize);\n\tSystem.arraycopy(labels,0,devLabels,0,devSize);\n\tSystem.arraycopy(data,devSize,trainData,0,trainSize);\n\tSystem.arraycopy(labels,devSize,trainLabels,0,trainSize);\n\tif(this instanceof WeightedDataset<?,?>){\n\t\tfloat[] trainWeights=new float[trainSize];\n\t\tfloat[] devWeights=new float[devSize];\n\t\tWeightedDataset<L,F> w=(WeightedDataset<L,F>)this;\n\t\tSystem.arraycopy(w.weights,0,devWeights,0,devSize);\n\t\tSystem.arraycopy(w.weights,devSize,trainWeights,0,trainSize);\n\t\tWeightedDataset<L,F> dev=new WeightedDataset<L,F>(labelIndex,devLabels,featureIndex,devData,devSize,devWeights);\n\t\tWeightedDataset<L,F> train=new WeightedDataset<L,F>(labelIndex,trainLabels,featureIndex,trainData,trainSize,trainWeights);\n\t\treturn new Pair<GeneralDataset<L,F>,GeneralDataset<L,F>>(train,dev);\n\t}\n\tDataset<L,F> dev=new Dataset<L,F>(labelIndex,devLabels,featureIndex,devData,devSize);\n\tDataset<L,F> train=new Dataset<L,F>(labelIndex,trainLabels,featureIndex,trainData,trainSize);\n\treturn new Pair<GeneralDataset<L,F>,GeneralDataset<L,F>>(train,dev);\n}","Original_Lines":23,"Target_Lines":17,"Manual":"@Override public Pair<GeneralDataset<L,F>,GeneralDataset<L,F>> split(double percentDev){\n\tint devSize=(int)(percentDev * size());\n\tint trainSize=size() - devSize;\n\tint[][] devData=new int[devSize][];\n\tint[] devLabels=new int[devSize];\n\tint[][] trainData=new int[trainSize][];\n\tint[] trainLabels=new int[trainSize];\n\tif(this instanceof WeightedDataset<?,?>){\n\t\tfloat[] trainWeights=new float[trainSize];\n\t\tfloat[] devWeights=new float[devSize];\n\t\tWeightedDataset<L,F> w=(WeightedDataset<L,F>)this;\n\t\tWeightedDataset<L,F> dev=new WeightedDataset<L,F>(labelIndex,devLabels,featureIndex,devData,devSize,devWeights);\n\t\tWeightedDataset<L,F> train=new WeightedDataset<L,F>(labelIndex,trainLabels,featureIndex,trainData,trainSize,trainWeights);\n\t\treturn new Pair<GeneralDataset<L,F>,GeneralDataset<L,F>>(train,dev);\n\t}\n\tDataset<L,F> dev=new Dataset<L,F>(labelIndex,devLabels,featureIndex,devData,devSize);\n\tDataset<L,F> train=new Dataset<L,F>(labelIndex,trainLabels,featureIndex,trainData,trainSize);\n\treturn new Pair<GeneralDataset<L,F>,GeneralDataset<L,F>>(train,dev);\n}","Distance":0.3157894736842105,"Automatic":"@Override public Pair<GeneralDataset<L,F>,GeneralDataset<L,F>> split(double percentDev){\n\tint devSize=(int)(percentDev * size());\n\tint trainSize=size() - devSize;\n\tint[][] devData=new int[devSize][];\n\tint[] trainLabels=new int[trainSize];\n\tSystem.arraycopy(data,devSize,trainData,0,trainSize);\n\tSystem.arraycopy(labels,devSize,trainLabels,0,trainSize);\n\tif(this instanceof WeightedDataset<?,?>){\n\t\tfloat[] trainWeights=new float[trainSize];\n\t\tfloat[] devWeights=new float[devSize];\n\t\tSystem.arraycopy(w.weights,devSize,trainWeights,0,trainSize);\n\t\tWeightedDataset<L,F> dev=new WeightedDataset<L,F>(labelIndex,devLabels,featureIndex,devData,devSize,devWeights);\n\t\tWeightedDataset<L,F> train=new WeightedDataset<L,F>(labelIndex,trainLabels,featureIndex,trainData,trainSize,trainWeights);\n\t\treturn new Pair<GeneralDataset<L,F>,GeneralDataset<L,F>>(train,dev);\n\t}\n\tDataset<L,F> dev=new Dataset<L,F>(labelIndex,devLabels,featureIndex,devData,devSize);\n\tDataset<L,F> train=new Dataset<L,F>(labelIndex,trainLabels,featureIndex,trainData,trainSize);\n\treturn new Pair<GeneralDataset<L,F>,GeneralDataset<L,F>>(train,dev);\n}"},{"Origin":"@Override public Pair<GeneralDataset<L,F>,GeneralDataset<L,F>> split(int start,int end){\n\tint devSize=end - start;\n\tint trainSize=size() - devSize;\n\tint[][] devData=new int[devSize][];\n\tint[] devLabels=new int[devSize];\n\tint[][] trainData=new int[trainSize][];\n\tint[] trainLabels=new int[trainSize];\n\tSystem.arraycopy(data,start,devData,0,devSize);\n\tSystem.arraycopy(labels,start,devLabels,0,devSize);\n\tSystem.arraycopy(data,0,trainData,0,start);\n\tSystem.arraycopy(data,end,trainData,start,size() - end);\n\tSystem.arraycopy(labels,0,trainLabels,0,start);\n\tSystem.arraycopy(labels,end,trainLabels,start,size() - end);\n\tif(this instanceof WeightedDataset<?,?>){\n\t\tfloat[] trainWeights=new float[trainSize];\n\t\tfloat[] devWeights=new float[devSize];\n\t\tWeightedDataset<L,F> w=(WeightedDataset<L,F>)this;\n\t\tSystem.arraycopy(w.weights,start,devWeights,0,devSize);\n\t\tSystem.arraycopy(w.weights,0,trainWeights,0,start);\n\t\tSystem.arraycopy(w.weights,end,trainWeights,start,size() - end);\n\t\tWeightedDataset<L,F> dev=new WeightedDataset<L,F>(labelIndex,devLabels,featureIndex,devData,devSize,devWeights);\n\t\tWeightedDataset<L,F> train=new WeightedDataset<L,F>(labelIndex,trainLabels,featureIndex,trainData,trainSize,trainWeights);\n\t\treturn new Pair<GeneralDataset<L,F>,GeneralDataset<L,F>>(train,dev);\n\t}\n\tDataset<L,F> dev=new Dataset<L,F>(labelIndex,devLabels,featureIndex,devData,devSize);\n\tDataset<L,F> train=new Dataset<L,F>(labelIndex,trainLabels,featureIndex,trainData,trainSize);\n\treturn new Pair<GeneralDataset<L,F>,GeneralDataset<L,F>>(train,dev);\n}","Original_Lines":26,"Target_Lines":17,"Manual":"@Override public Pair<GeneralDataset<L,F>,GeneralDataset<L,F>> split(int start,int end){\n\tint devSize=end - start;\n\tint trainSize=size() - devSize;\n\tint[][] devData=new int[devSize][];\n\tint[] devLabels=new int[devSize];\n\tint[][] trainData=new int[trainSize][];\n\tint[] trainLabels=new int[trainSize];\n\tif(this instanceof WeightedDataset<?,?>){\n\t\tfloat[] trainWeights=new float[trainSize];\n\t\tfloat[] devWeights=new float[devSize];\n\t\tWeightedDataset<L,F> w=(WeightedDataset<L,F>)this;\n\t\tWeightedDataset<L,F> dev=new WeightedDataset<L,F>(labelIndex,devLabels,featureIndex,devData,devSize,devWeights);\n\t\tWeightedDataset<L,F> train=new WeightedDataset<L,F>(labelIndex,trainLabels,featureIndex,trainData,trainSize,trainWeights);\n\t\treturn new Pair<GeneralDataset<L,F>,GeneralDataset<L,F>>(train,dev);\n\t}\n\tDataset<L,F> dev=new Dataset<L,F>(labelIndex,devLabels,featureIndex,devData,devSize);\n\tDataset<L,F> train=new Dataset<L,F>(labelIndex,trainLabels,featureIndex,trainData,trainSize);\n\treturn new Pair<GeneralDataset<L,F>,GeneralDataset<L,F>>(train,dev);\n}","Distance":0,"Automatic":"@Override public Pair<GeneralDataset<L,F>,GeneralDataset<L,F>> split(int start,int end){\n\tint devSize=end - start;\n\tint trainSize=size() - devSize;\n\tint[][] devData=new int[devSize][];\n\tint[] devLabels=new int[devSize];\n\tint[][] trainData=new int[trainSize][];\n\tint[] trainLabels=new int[trainSize];\n\tif(this instanceof WeightedDataset<?,?>){\n\t\tfloat[] trainWeights=new float[trainSize];\n\t\tfloat[] devWeights=new float[devSize];\n\t\tWeightedDataset<L,F> w=(WeightedDataset<L,F>)this;\n\t\tWeightedDataset<L,F> dev=new WeightedDataset<L,F>(labelIndex,devLabels,featureIndex,devData,devSize,devWeights);\n\t\tWeightedDataset<L,F> train=new WeightedDataset<L,F>(labelIndex,trainLabels,featureIndex,trainData,trainSize,trainWeights);\n\t\treturn new Pair<GeneralDataset<L,F>,GeneralDataset<L,F>>(train,dev);\n\t}\n\tDataset<L,F> dev=new Dataset<L,F>(labelIndex,devLabels,featureIndex,devData,devSize);\n\tDataset<L,F> train=new Dataset<L,F>(labelIndex,trainLabels,featureIndex,trainData,trainSize);\n\treturn new Pair<GeneralDataset<L,F>,GeneralDataset<L,F>>(train,dev);\n}"},{"Origin":"public double[] getInformationGains(){\n\tdata=trimToSize(data);\n\tlabels=trimToSize(labels);\n\tClassicCounter<F> featureCounter=new ClassicCounter<F>();\n\tClassicCounter<L> labelCounter=new ClassicCounter<L>();\n\tTwoDimensionalCounter<F,L> condCounter=new TwoDimensionalCounter<F,L>();\n\tfor (int i=0; i < labels.length; i++){\n\t\tlabelCounter.incrementCount(labelIndex.get(labels[i]));\n\t\tboolean[] doc=new boolean[featureIndex.size()];\n\t\tfor (int j=0; j < data[i].length; j++){\n\t\t\tdoc[data[i][j]]=true;\n\t\t}\n\t\tfor (int j=0; j < doc.length; j++){\n\t\t\tif(doc[j]){\n\t\t\t\tfeatureCounter.incrementCount(featureIndex.get(j));\n\t\t\t\tcondCounter.incrementCount(featureIndex.get(j),labelIndex.get(labels[i]),1.0);\n\t\t\t}\n\t\t}\n\t}\n\tdouble entropy=0.0;\n\tfor (int i=0; i < labelIndex.size(); i++){\n\t\tdouble labelCount=labelCounter.getCount(labelIndex.get(i));\n\t\tdouble p=labelCount / size();\n\t\tentropy-=p * (Math.log(p) / Math.log(2));\n\t}\n\tdouble[] ig=new double[featureIndex.size()];\n\tArrays.fill(ig,entropy);\n\tfor (int i=0; i < featureIndex.size(); i++){\n\t\tF feature=featureIndex.get(i);\n\t\tdouble featureCount=featureCounter.getCount(feature);\n\t\tdouble notFeatureCount=size() - featureCount;\n\t\tdouble pFeature=featureCount / size();\n\t\tdouble pNotFeature=(1.0 - pFeature);\n\t\tif(featureCount == 0){\n\t\t\tig[i]=0;\n\t\t\tcontinue;\n\t\t}\n\t\tif(notFeatureCount == 0){\n\t\t\tig[i]=0;\n\t\t\tcontinue;\n\t\t}\n\t\tdouble sumFeature=0.0;\n\t\tdouble sumNotFeature=0.0;\n\t\tfor (int j=0; j < labelIndex.size(); j++){\n\t\t\tL label=labelIndex.get(j);\n\t\t\tdouble featureLabelCount=condCounter.getCount(feature,label);\n\t\t\tdouble notFeatureLabelCount=size() - featureLabelCount;\n\t\t\tdouble p=featureLabelCount / featureCount;\n\t\t\tdouble pNot=notFeatureLabelCount / notFeatureCount;\n\t\t\tif(featureLabelCount != 0){\n\t\t\t\tsumFeature+=p * (Math.log(p) / Math.log(2));\n\t\t\t}\n\t\t\tif(notFeatureLabelCount != 0){\n\t\t\t\tsumNotFeature+=pNot * (Math.log(pNot) / Math.log(2));\n\t\t\t}\n\t\t}\n\t\tig[i]+=pFeature * sumFeature + pNotFeature * sumNotFeature;\n\t}\n\treturn ig;\n}","Original_Lines":58,"Target_Lines":47,"Manual":"public double[] getInformationGains(){\n\tdata=trimToSize(data);\n\tlabels=trimToSize(labels);\n\tClassicCounter<F> featureCounter=new ClassicCounter<F>();\n\tClassicCounter<L> labelCounter=new ClassicCounter<L>();\n\tTwoDimensionalCounter<F,L> condCounter=new TwoDimensionalCounter<F,L>();\n\tfor (int i=0; i < labels.length; i++){\n\t\tlabelCounter.incrementCount(labelIndex.get(labels[i]));\n\t\tboolean[] doc=new boolean[featureIndex.size()];\n\t\tfor (int j=0; j < doc.length; j++){\n\t\t\tif(doc[j]){\n\t\t\t\tfeatureCounter.incrementCount(featureIndex.get(j));\n\t\t\t\tcondCounter.incrementCount(featureIndex.get(j),labelIndex.get(labels[i]),1.0);\n\t\t\t}\n\t\t}\n\t}\n\tdouble entropy=0.0;\n\tfor (int i=0; i < labelIndex.size(); i++){\n\t\tdouble labelCount=labelCounter.getCount(labelIndex.get(i));\n\t\tdouble p=labelCount / size();\n\t\tentropy-=p * (Math.log(p) / Math.log(2));\n\t}\n\tdouble[] ig=new double[featureIndex.size()];\n\tArrays.fill(ig,entropy);\n\tfor (int i=0; i < featureIndex.size(); i++){\n\t\tF feature=featureIndex.get(i);\n\t\tdouble featureCount=featureCounter.getCount(feature);\n\t\tdouble notFeatureCount=size() - featureCount;\n\t\tdouble pFeature=featureCount / size();\n\t\tdouble pNotFeature=(1.0 - pFeature);\n\t\tdouble sumFeature=0.0;\n\t\tdouble sumNotFeature=0.0;\n\t\tfor (int j=0; j < labelIndex.size(); j++){\n\t\t\tL label=labelIndex.get(j);\n\t\t\tdouble featureLabelCount=condCounter.getCount(feature,label);\n\t\t\tdouble notFeatureLabelCount=size() - featureLabelCount;\n\t\t\tdouble p=featureLabelCount / featureCount;\n\t\t\tdouble pNot=notFeatureLabelCount / notFeatureCount;\n\t\t\tif(featureLabelCount != 0){\n\t\t\t\tsumFeature+=p * (Math.log(p) / Math.log(2));\n\t\t\t}\n\t\t\tif(notFeatureLabelCount != 0){\n\t\t\t\tsumNotFeature+=pNot * (Math.log(pNot) / Math.log(2));\n\t\t\t}\n\t\t}\n\t\tig[i]+=pFeature * sumFeature + pNotFeature * sumNotFeature;\n\t}\n\treturn ig;\n}","Distance":0,"Automatic":"public double[] getInformationGains(){\n\tdata=trimToSize(data);\n\tlabels=trimToSize(labels);\n\tClassicCounter<F> featureCounter=new ClassicCounter<F>();\n\tClassicCounter<L> labelCounter=new ClassicCounter<L>();\n\tTwoDimensionalCounter<F,L> condCounter=new TwoDimensionalCounter<F,L>();\n\tfor (int i=0; i < labels.length; i++){\n\t\tlabelCounter.incrementCount(labelIndex.get(labels[i]));\n\t\tboolean[] doc=new boolean[featureIndex.size()];\n\t\tfor (int j=0; j < doc.length; j++){\n\t\t\tif(doc[j]){\n\t\t\t\tfeatureCounter.incrementCount(featureIndex.get(j));\n\t\t\t\tcondCounter.incrementCount(featureIndex.get(j),labelIndex.get(labels[i]),1.0);\n\t\t\t}\n\t\t}\n\t}\n\tdouble entropy=0.0;\n\tfor (int i=0; i < labelIndex.size(); i++){\n\t\tdouble labelCount=labelCounter.getCount(labelIndex.get(i));\n\t\tdouble p=labelCount / size();\n\t\tentropy-=p * (Math.log(p) / Math.log(2));\n\t}\n\tdouble[] ig=new double[featureIndex.size()];\n\tArrays.fill(ig,entropy);\n\tfor (int i=0; i < featureIndex.size(); i++){\n\t\tF feature=featureIndex.get(i);\n\t\tdouble featureCount=featureCounter.getCount(feature);\n\t\tdouble notFeatureCount=size() - featureCount;\n\t\tdouble pFeature=featureCount / size();\n\t\tdouble pNotFeature=(1.0 - pFeature);\n\t\tdouble sumFeature=0.0;\n\t\tdouble sumNotFeature=0.0;\n\t\tfor (int j=0; j < labelIndex.size(); j++){\n\t\t\tL label=labelIndex.get(j);\n\t\t\tdouble featureLabelCount=condCounter.getCount(feature,label);\n\t\t\tdouble notFeatureLabelCount=size() - featureLabelCount;\n\t\t\tdouble p=featureLabelCount / featureCount;\n\t\t\tdouble pNot=notFeatureLabelCount / notFeatureCount;\n\t\t\tif(featureLabelCount != 0){\n\t\t\t\tsumFeature+=p * (Math.log(p) / Math.log(2));\n\t\t\t}\n\t\t\tif(notFeatureLabelCount != 0){\n\t\t\t\tsumNotFeature+=pNot * (Math.log(pNot) / Math.log(2));\n\t\t\t}\n\t\t}\n\t\tig[i]+=pFeature * sumFeature + pNotFeature * sumNotFeature;\n\t}\n\treturn ig;\n}"},{"Origin":"public void applyFeatureCountThreshold(int k){\n\tfloat[] counts=getFeatureCounts();\n\tIndex<F> newFeatureIndex=new HashIndex<F>();\n\tint[] featMap=new int[featureIndex.size()];\n\tfor (int i=0; i < featMap.length; i++){\n\t\tF feat=featureIndex.get(i);\n\t\tif(counts[i] >= k){\n\t\t\tint newIndex=newFeatureIndex.size();\n\t\t\tnewFeatureIndex.add(feat);\n\t\t\tfeatMap[i]=newIndex;\n\t\t} else {\n\t\t\tfeatMap[i]=-1;\n\t\t}\n\t}\n\tfeatureIndex=newFeatureIndex;\n\tfor (int i=0; i < size; i++){\n\t\tList<Integer> featList=new ArrayList<Integer>(data[i].length);\n\t\tfor (int j=0; j < data[i].length; j++){\n\t\t\tif(featMap[data[i][j]] >= 0){\n\t\t\t\tfeatList.add(featMap[data[i][j]]);\n\t\t\t}\n\t\t}\n\t\tdata[i]=new int[featList.size()];\n\t\tfor (int j=0; j < data[i].length; j++){\n\t\t\tdata[i][j]=featList.get(j);\n\t\t}\n\t}\n}","Original_Lines":26,"Target_Lines":14,"Manual":"public void applyFeatureCountThreshold(int k){\n\tfloat[] counts=getFeatureCounts();\n\tIndex<F> newFeatureIndex=new HashIndex<F>();\n\tint[] featMap=new int[featureIndex.size()];\n\tfor (int i=0; i < featMap.length; i++){\n\t\tF feat=featureIndex.get(i);\n\t\tif(counts[i] >= k){\n\t\t\tint newIndex=newFeatureIndex.size();\n\t\t\tnewFeatureIndex.add(feat);\n\t\t\tfeatMap[i]=newIndex;\n\t\t} else {\n\t\t\tfeatMap[i]=-1;\n\t\t}\n\t}\n\tfeatureIndex=newFeatureIndex;\n}","Distance":0.38461538461538464,"Automatic":"public void applyFeatureCountThreshold(int k){\n\tIndex<F> newFeatureIndex=new HashIndex<F>();\n\tint[] featMap=new int[featureIndex.size()];\n\tfor (int i=0; i < featMap.length; i++){\n\t\tif(counts[i] >= k){\n\t\t\tint newIndex=newFeatureIndex.size();\n\t\t\tnewFeatureIndex.add(feat);\n\t\t\tfeatMap[i]=newIndex;\n\t\t} else {\n\t\t\tfeatMap[i]=-1;\n\t\t}\n\t}\n\tfor (int i=0; i < size; i++){\n\t\tList<Integer> featList=new ArrayList<Integer>(data[i].length);\n\t}\n}"},{"Origin":"public void applyFeatureMaxCountThreshold(int k){\n\tfloat[] counts=getFeatureCounts();\n\tHashIndex<F> newFeatureIndex=new HashIndex<F>();\n\tint[] featMap=new int[featureIndex.size()];\n\tfor (int i=0; i < featMap.length; i++){\n\t\tF feat=featureIndex.get(i);\n\t\tif(counts[i] <= k){\n\t\t\tint newIndex=newFeatureIndex.size();\n\t\t\tnewFeatureIndex.add(feat);\n\t\t\tfeatMap[i]=newIndex;\n\t\t} else {\n\t\t\tfeatMap[i]=-1;\n\t\t}\n\t}\n\tfeatureIndex=newFeatureIndex;\n\tfor (int i=0; i < size; i++){\n\t\tList<Integer> featList=new ArrayList<Integer>(data[i].length);\n\t\tfor (int j=0; j < data[i].length; j++){\n\t\t\tif(featMap[data[i][j]] >= 0){\n\t\t\t\tfeatList.add(featMap[data[i][j]]);\n\t\t\t}\n\t\t}\n\t\tdata[i]=new int[featList.size()];\n\t\tfor (int j=0; j < data[i].length; j++){\n\t\t\tdata[i][j]=featList.get(j);\n\t\t}\n\t}\n}","Original_Lines":26,"Target_Lines":14,"Manual":"public void applyFeatureMaxCountThreshold(int k){\n\tfloat[] counts=getFeatureCounts();\n\tHashIndex<F> newFeatureIndex=new HashIndex<F>();\n\tint[] featMap=new int[featureIndex.size()];\n\tfor (int i=0; i < featMap.length; i++){\n\t\tF feat=featureIndex.get(i);\n\t\tif(counts[i] <= k){\n\t\t\tint newIndex=newFeatureIndex.size();\n\t\t\tnewFeatureIndex.add(feat);\n\t\t\tfeatMap[i]=newIndex;\n\t\t} else {\n\t\t\tfeatMap[i]=-1;\n\t\t}\n\t}\n\tfeatureIndex=newFeatureIndex;\n}","Distance":0.38461538461538464,"Automatic":"public void applyFeatureMaxCountThreshold(int k){\n\tHashIndex<F> newFeatureIndex=new HashIndex<F>();\n\tint[] featMap=new int[featureIndex.size()];\n\tfor (int i=0; i < featMap.length; i++){\n\t\tif(counts[i] <= k){\n\t\t\tint newIndex=newFeatureIndex.size();\n\t\t\tnewFeatureIndex.add(feat);\n\t\t\tfeatMap[i]=newIndex;\n\t\t} else {\n\t\t\tfeatMap[i]=-1;\n\t\t}\n\t}\n\tfor (int i=0; i < size; i++){\n\t\tList<Integer> featList=new ArrayList<Integer>(data[i].length);\n\t}\n}"},{"Origin":"private void computeEmpiricalStatistics(List<F> geFeatures){\n\tgeFeature2EmpiricalDist=new double[geFeatures.size()][labeledDataset.labelIndex.size()];\n\tgeFeature2DatumList=new ArrayList<List<Integer>>(geFeatures.size());\n\tMap<F,Integer> geFeatureMap=new HashMap<F,Integer>();\n\tSet<Integer> activeUnlabeledExamples=new HashSet<Integer>();\n\tfor (int n=0; n < geFeatures.size(); n++){\n\t\tF geFeature=geFeatures.get(n);\n\t\tgeFeature2DatumList.add(new ArrayList<Integer>());\n\t\tArrays.fill(geFeature2EmpiricalDist[n],0);\n\t\tgeFeatureMap.put(geFeature,n);\n\t}\n\tfor (int i=0; i < labeledDataset.size(); i++){\n\t\tDatum<L,F> datum=labeledDataset.getDatum(i);\n\t\tint labelID=labeledDataset.labelIndex.indexOf(datum.label());\n\t\tfor (F feature : datum.asFeatures()){\n\t\t\tif(geFeatureMap.containsKey(feature)){\n\t\t\t\tint geFnum=geFeatureMap.get(feature);\n\t\t\t\tgeFeature2EmpiricalDist[geFnum][labelID]++;\n\t\t\t}\n\t\t}\n\t}\n\tfor (int n=0; n < geFeatures.size(); n++){\n\t\tArrayMath.normalize(geFeature2EmpiricalDist[n]);\n\t\tsmoothDistribution(geFeature2EmpiricalDist[n]);\n\t}\n\tfor (int i=0; i < unlabeledDataList.size(); i++){\n\t\tDatum<L,F> datum=unlabeledDataList.get(i);\n\t\tfor (F feature : datum.asFeatures()){\n\t\t\tif(geFeatureMap.containsKey(feature)){\n\t\t\t\tint geFnum=geFeatureMap.get(feature);\n\t\t\t\tgeFeature2DatumList.get(geFnum).add(i);\n\t\t\t\tactiveUnlabeledExamples.add(i);\n\t\t\t}\n\t\t}\n\t}\n\tSystem.out.println(\"Number of active unlabeled examples:\" + activeUnlabeledExamples.size());\n}","Original_Lines":35,"Target_Lines":28,"Manual":"private void computeEmpiricalStatistics(List<F> geFeatures){\n\tgeFeature2EmpiricalDist=new double[geFeatures.size()][labeledDataset.labelIndex.size()];\n\tgeFeature2DatumList=new ArrayList<List<Integer>>(geFeatures.size());\n\tMap<F,Integer> geFeatureMap=new HashMap<F,Integer>();\n\tSet<Integer> activeUnlabeledExamples=new HashSet<Integer>();\n\tfor (int i=0; i < labeledDataset.size(); i++){\n\t\tDatum<L,F> datum=labeledDataset.getDatum(i);\n\t\tint labelID=labeledDataset.labelIndex.indexOf(datum.label());\n\t\tfor (F feature : datum.asFeatures()){\n\t\t\tif(geFeatureMap.containsKey(feature)){\n\t\t\t\tint geFnum=geFeatureMap.get(feature);\n\t\t\t\tgeFeature2EmpiricalDist[geFnum][labelID]++;\n\t\t\t}\n\t\t}\n\t}\n\tfor (int n=0; n < geFeatures.size(); n++){\n\t\tArrayMath.normalize(geFeature2EmpiricalDist[n]);\n\t\tsmoothDistribution(geFeature2EmpiricalDist[n]);\n\t}\n\tfor (int i=0; i < unlabeledDataList.size(); i++){\n\t\tDatum<L,F> datum=unlabeledDataList.get(i);\n\t\tfor (F feature : datum.asFeatures()){\n\t\t\tif(geFeatureMap.containsKey(feature)){\n\t\t\t\tint geFnum=geFeatureMap.get(feature);\n\t\t\t\tgeFeature2DatumList.get(geFnum).add(i);\n\t\t\t\tactiveUnlabeledExamples.add(i);\n\t\t\t}\n\t\t}\n\t}\n}","Distance":0.32,"Automatic":"private void computeEmpiricalStatistics(List<F> geFeatures){\n\tgeFeature2EmpiricalDist=new double[geFeatures.size()][labeledDataset.labelIndex.size()];\n\tgeFeature2DatumList=new ArrayList<List<Integer>>(geFeatures.size());\n\tMap<F,Integer> geFeatureMap=new HashMap<F,Integer>();\n\tSet<Integer> activeUnlabeledExamples=new HashSet<Integer>();\n\tfor (int n=0; n < geFeatures.size(); n++){\n\t\tF geFeature=geFeatures.get(n);\n\t\tgeFeature2DatumList.add(new ArrayList<Integer>());\n\t\tArrays.fill(geFeature2EmpiricalDist[n],0);\n\t}\n\tfor (int i=0; i < labeledDataset.size(); i++){\n\t\tDatum<L,F> datum=labeledDataset.getDatum(i);\n\t\tint labelID=labeledDataset.labelIndex.indexOf(datum.label());\n\t\tfor (F feature : datum.asFeatures()){\n\t\t\tif(geFeatureMap.containsKey(feature)){\n\t\t\t\tint geFnum=geFeatureMap.get(feature);\n\t\t\t\tgeFeature2EmpiricalDist[geFnum][labelID]++;\n\t\t\t}\n\t\t}\n\t}\n\tfor (int i=0; i < unlabeledDataList.size(); i++){\n\t\tfor (F feature : datum.asFeatures()){\n\t\t\tif(geFeatureMap.containsKey(feature)){\n\t\t\t\tint geFnum=geFeatureMap.get(feature);\n\t\t\t\tgeFeature2DatumList.get(geFnum).add(i);\n\t\t\t\tactiveUnlabeledExamples.add(i);\n\t\t\t}\n\t\t}\n\t}\n}"},{"Origin":"public Classifier<String,String> loadFromFilename(String file){\n\ttry {\n\t\tFile tgtFile=new File(file);\n\t\tBufferedReader in=new BufferedReader(new FileReader(tgtFile));\n\t\tIndex<String> labelIndex=HashIndex.loadFromReader(in);\n\t\tIndex<String> featureIndex=HashIndex.loadFromReader(in);\n\t\tdouble[][] weights=new double[featureIndex.size()][labelIndex.size()];\n\t\tString line=in.readLine();\n\t\tint currLine=1;\n\t\twhile(line != null && line.length() > 0){\n\t\t\tString[] tuples=line.split(LinearClassifier.TEXT_SERIALIZATION_DELIMITER);\n\t\t\tif(tuples.length != 3){\n\t\t\t\tthrow new Exception(\"Error: incorrect number of tokens in weight specifier, line=\" + currLine + \" in file \"+ tgtFile.getAbsolutePath());\n\t\t\t}\n\t\t\tcurrLine++;\n\t\t\tint feature=Integer.valueOf(tuples[0]);\n\t\t\tint label=Integer.valueOf(tuples[1]);\n\t\t\tdouble value=Double.valueOf(tuples[2]);\n\t\t\tweights[feature][label]=value;\n\t\t\tline=in.readLine();\n\t\t}\n\t\tint numThresholds=Integer.valueOf(in.readLine());\n\t\tdouble[] thresholds=new double[numThresholds];\n\t\tint curr=0;\n\t\twhile((line=in.readLine()) != null){\n\t\t\tdouble tval=Double.valueOf(line.trim());\n\t\t\tthresholds[curr++]=tval;\n\t\t}\n\t\tin.close();\n\t\tLinearClassifier<String,String> classifier=new LinearClassifier<String,String>(weights,featureIndex,labelIndex);\n\t\treturn classifier;\n\t} catch (Exception e){\n\t\tSystem.err.println(\"Error in LinearClassifierFactory, loading from file=\" + file);\n\t\te.printStackTrace();\n\t\treturn null;\n\t} \n}","Original_Lines":35,"Target_Lines":29,"Manual":"public Classifier<String,String> loadFromFilename(String file){\n\ttry {\n\t\tFile tgtFile=new File(file);\n\t\tBufferedReader in=new BufferedReader(new FileReader(tgtFile));\n\t\tIndex<String> labelIndex=HashIndex.loadFromReader(in);\n\t\tIndex<String> featureIndex=HashIndex.loadFromReader(in);\n\t\tdouble[][] weights=new double[featureIndex.size()][labelIndex.size()];\n\t\tString line=in.readLine();\n\t\tint currLine=1;\n\t\twhile(line != null && line.length() > 0){\n\t\t\tString[] tuples=line.split(LinearClassifier.TEXT_SERIALIZATION_DELIMITER);\n\t\t\tcurrLine++;\n\t\t\tint feature=Integer.valueOf(tuples[0]);\n\t\t\tint label=Integer.valueOf(tuples[1]);\n\t\t\tdouble value=Double.valueOf(tuples[2]);\n\t\t\tweights[feature][label]=value;\n\t\t\tline=in.readLine();\n\t\t}\n\t\tint numThresholds=Integer.valueOf(in.readLine());\n\t\tdouble[] thresholds=new double[numThresholds];\n\t\tint curr=0;\n\t\twhile((line=in.readLine()) != null){\n\t\t\tdouble tval=Double.valueOf(line.trim());\n\t\t\tthresholds[curr++]=tval;\n\t\t}\n\t\tin.close();\n\t\tLinearClassifier<String,String> classifier=new LinearClassifier<String,String>(weights,featureIndex,labelIndex);\n\t\treturn classifier;\n\t} catch (Exception e){\n\t} \n}","Distance":0.1111111111111111,"Automatic":"public Classifier<String,String> loadFromFilename(String file){\n\ttry {\n\t\tFile tgtFile=new File(file);\n\t\tBufferedReader in=new BufferedReader(new FileReader(tgtFile));\n\t\tIndex<String> labelIndex=HashIndex.loadFromReader(in);\n\t\tIndex<String> featureIndex=HashIndex.loadFromReader(in);\n\t\tdouble[][] weights=new double[featureIndex.size()][labelIndex.size()];\n\t\tString line=in.readLine();\n\t\tint currLine=1;\n\t\twhile(line != null && line.length() > 0){\n\t\t\tString[] tuples=line.split(LinearClassifier.TEXT_SERIALIZATION_DELIMITER);\n\t\t\tcurrLine++;\n\t\t\tint feature=Integer.valueOf(tuples[0]);\n\t\t\tint label=Integer.valueOf(tuples[1]);\n\t\t\tdouble value=Double.valueOf(tuples[2]);\n\t\t\tweights[feature][label]=value;\n\t\t\tline=in.readLine();\n\t\t}\n\t\tint numThresholds=Integer.valueOf(in.readLine());\n\t\tdouble[] thresholds=new double[numThresholds];\n\t\tint curr=0;\n\t\twhile((line=in.readLine()) != null){\n\t\t\tdouble tval=Double.valueOf(line.trim());\n\t\t\tthresholds[curr++]=tval;\n\t\t}\n\t\tLinearClassifier<String,String> classifier=new LinearClassifier<String,String>(weights,featureIndex,labelIndex);\n\t\treturn classifier;\n\t} catch (Exception e){\n\t\tSystem.err.println(\"Error in LinearClassifierFactory, loading from file=\" + file);\n\t\treturn null;\n\t} \n}"},{"Origin":"protected void calculateStochasticAlgorithmicDifferentiation(double[] x,double[] v,int[] batch){\n\tSystem.err.print(\"*\");\n\tvalue=0.0;\n\tif(derivativeAD == null){\n\t\tderivativeAD=new DoubleAD[x.length];\n\t\tfor (int i=0; i < x.length; i++){\n\t\t\tderivativeAD[i]=new DoubleAD(0.0,0.0);\n\t\t}\n\t}\n\tif(xAD == null){\n\t\txAD=new DoubleAD[x.length];\n\t\tfor (int i=0; i < x.length; i++){\n\t\t\txAD[i]=new DoubleAD(x[i],v[i]);\n\t\t}\n\t}\n\tif(sums == null){\n\t\tsums=new DoubleAD[numClasses];\n\t\tfor (int c=0; c < numClasses; c++){\n\t\t\tsums[c]=new DoubleAD(0,0);\n\t\t}\n\t}\n\tif(probs == null){\n\t\tprobs=new DoubleAD[numClasses];\n\t\tfor (int c=0; c < numClasses; c++){\n\t\t\tprobs[c]=new DoubleAD(0,0);\n\t\t}\n\t}\n\tfor (int i=0; i < x.length; i++){\n\t\txAD[i].set(x[i],v[i]);\n\t\tderivativeAD[i].set(0.0,0.0);\n\t}\n\tfor (int d=0; d < batch.length; d++){\n\t\tint m=(curElement + d) % data.length;\n\t\tint[] features=data[m];\n\t\tfor (int c=0; c < numClasses; c++){\n\t\t\tsums[c].set(0.0,0.0);\n\t\t}\n\t\tfor (int c=0; c < numClasses; c++){\n\t\t\tfor (int f=0; f < features.length; f++){\n\t\t\t\tint i=indexOf(features[f],c);\n\t\t\t\tsums[c]=ADMath.plus(sums[c],xAD[i]);\n\t\t\t}\n\t\t}\n\t\tDoubleAD total=ADMath.logSum(sums);\n\t\tfor (int c=0; c < numClasses; c++){\n\t\t\tprobs[c]=ADMath.exp(ADMath.minus(sums[c],total));\n\t\t\tif(dataweights != null){\n\t\t\t\tprobs[c]=ADMath.multConst(probs[c],dataweights[d]);\n\t\t\t}\n\t\t\tfor (int f=0; f < features.length; f++){\n\t\t\t\tint i=indexOf(features[f],c);\n\t\t\t\tif(c == labels[m]){\n\t\t\t\t\tderivativeAD[i].plusEqualsConst(-1.0);\n\t\t\t\t}\n\t\t\t\tderivativeAD[i].plusEquals(probs[c]);\n\t\t\t}\n\t\t}\n\t\tdouble dV=sums[labels[m]].getval() - total.getval();\n\t\tif(dataweights != null){\n\t\t\tdV*=dataweights[d];\n\t\t}\n\t\tvalue-=dV;\n\t}\n\tdouble[] tmp=new double[x.length];\n\tfor (int i=0; i < x.length; i++){\n\t\ttmp[i]=derivativeAD[i].getval();\n\t\tderivativeAD[i].plusEquals(ADMath.multConst(xAD[i],batch.length / (data.length * prior.getSigma() * prior.getSigma())));\n\t\tderivative[i]=derivativeAD[i].getval();\n\t\tHdotV[i]=derivativeAD[i].getdot();\n\t}\n\tvalue+=((double)batch.length) / ((double)data.length) * prior.compute(x,tmp);\n}","Original_Lines":70,"Target_Lines":37,"Manual":"protected void calculateStochasticAlgorithmicDifferentiation(double[] x,double[] v,int[] batch){\n\tfor (int d=0; d < batch.length; d++){\n\t\tint m=(curElement + d) % data.length;\n\t\tint[] features=data[m];\n\t\tfor (int c=0; c < numClasses; c++){\n\t\t\tfor (int f=0; f < features.length; f++){\n\t\t\t\tint i=indexOf(features[f],c);\n\t\t\t\tsums[c]=ADMath.plus(sums[c],xAD[i]);\n\t\t\t}\n\t\t}\n\t\tDoubleAD total=ADMath.logSum(sums);\n\t\tfor (int c=0; c < numClasses; c++){\n\t\t\tprobs[c]=ADMath.exp(ADMath.minus(sums[c],total));\n\t\t\tif(dataweights != null){\n\t\t\t\tprobs[c]=ADMath.multConst(probs[c],dataweights[d]);\n\t\t\t}\n\t\t\tfor (int f=0; f < features.length; f++){\n\t\t\t\tint i=indexOf(features[f],c);\n\t\t\t\tif(c == labels[m]){\n\t\t\t\t\tderivativeAD[i].plusEqualsConst(-1.0);\n\t\t\t\t}\n\t\t\t\tderivativeAD[i].plusEquals(probs[c]);\n\t\t\t}\n\t\t}\n\t\tdouble dV=sums[labels[m]].getval() - total.getval();\n\t\tif(dataweights != null){\n\t\t\tdV*=dataweights[d];\n\t\t}\n\t\tvalue-=dV;\n\t}\n\tdouble[] tmp=new double[x.length];\n\tfor (int i=0; i < x.length; i++){\n\t\ttmp[i]=derivativeAD[i].getval();\n\t\tderivativeAD[i].plusEquals(ADMath.multConst(xAD[i],batch.length / (data.length * prior.getSigma() * prior.getSigma())));\n\t\tderivative[i]=derivativeAD[i].getval();\n\t\tHdotV[i]=derivativeAD[i].getdot();\n\t}\n\tvalue+=((double)batch.length) / ((double)data.length) * prior.compute(x,tmp);\n}","Distance":0.4722222222222222,"Automatic":"protected void calculateStochasticAlgorithmicDifferentiation(double[] x,double[] v,int[] batch){\n\tif(derivativeAD == null){\n\t\tderivativeAD=new DoubleAD[x.length];\n\t}\n\tif(xAD == null){\n\t\tfor (int i=0; i < x.length; i++){\n\t\t\txAD[i]=new DoubleAD(x[i],v[i]);\n\t\t}\n\t}\n\tif(sums == null){\n\t}\n\tfor (int i=0; i < x.length; i++){\n\t\txAD[i].set(x[i],v[i]);\n\t}\n\tfor (int d=0; d < batch.length; d++){\n\t\tint[] features=data[m];\n\t\tDoubleAD total=ADMath.logSum(sums);\n\t\tfor (int c=0; c < numClasses; c++){\n\t\t\tprobs[c]=ADMath.exp(ADMath.minus(sums[c],total));\n\t\t\tif(dataweights != null){\n\t\t\t\tprobs[c]=ADMath.multConst(probs[c],dataweights[d]);\n\t\t\t}\n\t\t\tfor (int f=0; f < features.length; f++){\n\t\t\t\tint i=indexOf(features[f],c);\n\t\t\t\tderivativeAD[i].plusEquals(probs[c]);\n\t\t\t}\n\t\t}\n\t\tdouble dV=sums[labels[m]].getval() - total.getval();\n\t\tvalue-=dV;\n\t}\n\tdouble[] tmp=new double[x.length];\n\tfor (int i=0; i < x.length; i++){\n\t\ttmp[i]=derivativeAD[i].getval();\n\t\tderivativeAD[i].plusEquals(ADMath.multConst(xAD[i],batch.length / (data.length * prior.getSigma() * prior.getSigma())));\n\t\tderivative[i]=derivativeAD[i].getval();\n\t\tHdotV[i]=derivativeAD[i].getdot();\n\t}\n\tvalue+=((double)batch.length) / ((double)data.length) * prior.compute(x,tmp);\n}"},{"Origin":"public double compute(double[] x,double[] grad){\n\tdouble val=0.0;\n\tswitch (type){\n\tcase NULL: \n\t\treturn val;\n\tcase QUADRATIC: \n\t\tfor (int i=0; i < x.length; i++){\n\t\t\tval+=x[i] * x[i] / 2.0 / sigmaSq;\n\t\t\tgrad[i]+=x[i] / sigmaSq;\n\t\t}\n\t\treturn val;\n\tcase HUBER: \n\t\tfor (int i=0; i < x.length; i++){\n\t\t\tif(x[i] < -epsilon){\n\t\t\t\tval+=(-x[i] - epsilon / 2.0) / sigmaSq;\n\t\t\t\tgrad[i]+=-1.0 / sigmaSq;\n\t\t\t} else if(x[i] < epsilon){\n\t\t\t\tval+=x[i] * x[i] / 2.0 / epsilon / sigmaSq;\n\t\t\t\tgrad[i]+=x[i] / epsilon / sigmaSq;\n\t\t\t} else {\n\t\t\t\tval+=(x[i] - epsilon / 2.0) / sigmaSq;\n\t\t\t\tgrad[i]+=1.0 / sigmaSq;\n\t\t\t}\n\t\t}\n\t\treturn val;\n\tcase QUARTIC: \n\t\tfor (int i=0; i < x.length; i++){\n\t\t\tval+=(x[i] * x[i]) * (x[i] * x[i]) / 2.0 / sigmaQu;\n\t\t\tgrad[i]+=x[i] / sigmaQu;\n\t\t}\n\t\treturn val;\n\tcase ADAPT: \n\t\tdouble[] newX=ArrayMath.pairwiseSubtract(x,means);\n\t\tval+=otherPrior.compute(newX,grad);\n\t\treturn val;\n\tcase COSH: \n\t\tdouble norm=ArrayMath.norm_1(x) / sigmaSq;\n\t\tdouble d;\n\t\tif(norm > 30.0){\n\t\t\tval=norm - Math.log(2);\n\t\t\td=1.0 / sigmaSq;\n\t\t} else {\n\t\t\tval=Math.log(Math.cosh(norm));\n\t\t\td=(2 * (1 / (Math.exp(-2.0 * norm) + 1)) - 1.0) / sigmaSq;\n\t\t}\n\t\tfor (int i=0; i < x.length; i++){\n\t\t\tgrad[i]+=Math.signum(x[i]) * d;\n\t\t}\n\t\treturn val;\n\tcase MULTIPLE_QUADRATIC: \n\t\tfor (int i=0; i < x.length; i++){\n\t\t\tval+=x[i] * x[i] / 2.0 / sigmaSqM[i];\n\t\t\tgrad[i]+=x[i] / sigmaSqM[i];\n\t\t}\n\t\treturn val;\n\tdefault:\n\t\tthrow new RuntimeException(\"LogPrior.valueAt is undefined for prior of type \" + this);\n\t}\n}","Original_Lines":57,"Target_Lines":18,"Manual":"public double compute(double[] x,double[] grad){\n\tswitch (type){\n\tcase NULL: \n\t\treturn val;\n\tcase QUADRATIC: \n\t\treturn val;\n\tcase HUBER: \n\t\treturn val;\n\tcase QUARTIC: \n\t\treturn val;\n\tcase ADAPT: \n\t\treturn val;\n\tcase COSH: \n\t\treturn val;\n\tcase MULTIPLE_QUADRATIC: \n\t\treturn val;\n\tdefault:\n\t\tthrow new RuntimeException(\"LogPrior.valueAt is undefined for prior of type \" + this);\n\t}\n}","Distance":0.7083333333333334,"Automatic":"public double compute(double[] x,double[] grad){\n\tdouble val=0.0;\n\tswitch (type){\n\tcase NULL: \n\tcase QUADRATIC: \n\tcase HUBER: \n\t\tfor (int i=0; i < x.length; i++){\n\t\t\tif(x[i] < -epsilon){\n\t\t\t} else if(x[i] < epsilon){\n\t\t\t\tval+=x[i] * x[i] / 2.0 / epsilon / sigmaSq;\n\t\t\t} else {\n\t\t\t\tval+=(x[i] - epsilon / 2.0) / sigmaSq;\n\t\t\t\tgrad[i]+=1.0 / sigmaSq;\n\t\t\t}\n\t\t}\n\tcase QUARTIC: \n\tcase ADAPT: \n\tcase MULTIPLE_QUADRATIC: \n\t}\n}"},{"Origin":"public void applyFeatureMaxCountThreshold(int k){\n\tfloat[] counts=getFeatureCounts();\n\tHashIndex<F> newFeatureIndex=new HashIndex<F>();\n\tint[] featMap=new int[featureIndex.size()];\n\tfor (int i=0; i < featMap.length; i++){\n\t\tF feat=featureIndex.get(i);\n\t\tif(counts[i] <= k){\n\t\t\tint newIndex=newFeatureIndex.size();\n\t\t\tnewFeatureIndex.add(feat);\n\t\t\tfeatMap[i]=newIndex;\n\t\t} else {\n\t\t\tfeatMap[i]=-1;\n\t\t}\n\t}\n\tfeatureIndex=newFeatureIndex;\n\tfor (int i=0; i < size; i++){\n\t\tList<Integer> featList=new ArrayList<Integer>(data[i].length);\n\t\tList<Double> valueList=new ArrayList<Double>(values[i].length);\n\t\tfor (int j=0; j < data[i].length; j++){\n\t\t\tif(featMap[data[i][j]] >= 0){\n\t\t\t\tfeatList.add(featMap[data[i][j]]);\n\t\t\t\tvalueList.add(values[i][j]);\n\t\t\t}\n\t\t}\n\t\tdata[i]=new int[featList.size()];\n\t\tvalues[i]=new double[valueList.size()];\n\t\tfor (int j=0; j < data[i].length; j++){\n\t\t\tdata[i][j]=featList.get(j);\n\t\t\tvalues[i][j]=valueList.get(j);\n\t\t}\n\t}\n}","Original_Lines":30,"Target_Lines":24,"Manual":"public void applyFeatureMaxCountThreshold(int k){\n\tfloat[] counts=getFeatureCounts();\n\tHashIndex<F> newFeatureIndex=new HashIndex<F>();\n\tint[] featMap=new int[featureIndex.size()];\n\tfor (int i=0; i < featMap.length; i++){\n\t\tF feat=featureIndex.get(i);\n\t\tif(counts[i] <= k){\n\t\t\tint newIndex=newFeatureIndex.size();\n\t\t\tnewFeatureIndex.add(feat);\n\t\t\tfeatMap[i]=newIndex;\n\t\t} else {\n\t\t\tfeatMap[i]=-1;\n\t\t}\n\t}\n\tfeatureIndex=newFeatureIndex;\n\tfor (int i=0; i < size; i++){\n\t\tList<Integer> featList=new ArrayList<Integer>(data[i].length);\n\t\tList<Double> valueList=new ArrayList<Double>(values[i].length);\n\t\tfor (int j=0; j < data[i].length; j++){\n\t\t\tif(featMap[data[i][j]] >= 0){\n\t\t\t\tfeatList.add(featMap[data[i][j]]);\n\t\t\t\tvalueList.add(values[i][j]);\n\t\t\t}\n\t\t}\n\t}\n}","Distance":0,"Automatic":"public void applyFeatureMaxCountThreshold(int k){\n\tfloat[] counts=getFeatureCounts();\n\tHashIndex<F> newFeatureIndex=new HashIndex<F>();\n\tint[] featMap=new int[featureIndex.size()];\n\tfor (int i=0; i < featMap.length; i++){\n\t\tF feat=featureIndex.get(i);\n\t\tif(counts[i] <= k){\n\t\t\tint newIndex=newFeatureIndex.size();\n\t\t\tnewFeatureIndex.add(feat);\n\t\t\tfeatMap[i]=newIndex;\n\t\t} else {\n\t\t\tfeatMap[i]=-1;\n\t\t}\n\t}\n\tfeatureIndex=newFeatureIndex;\n\tfor (int i=0; i < size; i++){\n\t\tList<Integer> featList=new ArrayList<Integer>(data[i].length);\n\t\tList<Double> valueList=new ArrayList<Double>(values[i].length);\n\t\tfor (int j=0; j < data[i].length; j++){\n\t\t\tif(featMap[data[i][j]] >= 0){\n\t\t\t\tfeatList.add(featMap[data[i][j]]);\n\t\t\t\tvalueList.add(values[i][j]);\n\t\t\t}\n\t\t}\n\t}\n}"},{"Origin":"@Override public void init(ServletConfig config) throws ServletException {\n\tsuper.init(config);\n\t_config=config;\n\t_appengine=isGAE(config);\n\t_name=System.getProperty(NAME,\"butterfly\");\n\t_context=config.getServletContext();\n\t_context.setAttribute(NAME,_name);\n\t_context.setAttribute(APPENGINE,_appengine);\n\t_contextDir=new File(_context.getRealPath(\"/\"));\n\t_webInfDir=new File(_contextDir,\"WEB-INF\");\n\t_properties=new ExtendedProperties();\n\t_mounter=new ButterflyMounter();\n\tString props=System.getProperty(\"butterfly.properties\");\n\tFile butterflyProperties=(props == null) ? new File(_webInfDir,\"butterfly.properties\") : new File(props);\n\tBufferedInputStream is=null;\n\ttry {\n\t\tis=new BufferedInputStream(new FileInputStream(butterflyProperties));\n\t\t_properties.load(is);\n\t} catch (FileNotFoundException e){\n\t\tthrow new ServletException(\"Could not find butterfly properties file\",e);\n\t} catch (IOException e){\n\t\tthrow new ServletException(\"Could not read butterfly properties file\",e);\n\t} finally {\n\t\ttry {\n\t\t\tis.close();\n\t\t} catch (Exception e){\n\t\t} \n\t} \n\tString includes=_properties.getString(\"butterfly.includes\");\n\tif(includes != null){\n\t\tfor (String prop : includes.split(\",\")){\n\t\t\tFile prop_file=(prop.startsWith(\"/\")) ? new File(prop) : new File(_webInfDir,prop);\n\t\t\ttry {\n\t\t\t\tis=new BufferedInputStream(new FileInputStream(prop_file));\n\t\t\t\tExtendedProperties p=new ExtendedProperties();\n\t\t\t\tp.load(is);\n\t\t\t\t_properties.combine(p);\n\t\t\t} catch (Exception e){\n\t\t\t} finally {\n\t\t\t\ttry {\n\t\t\t\t\tis.close();\n\t\t\t\t} catch (Exception e){\n\t\t\t\t} \n\t\t\t} \n\t\t}\n\t}\n\tProperties systemProperties=System.getProperties();\n\tfor (Iterator<Object> i=systemProperties.keySet().iterator(); i.hasNext(); ){\n\t\tString key=(String)i.next();\n\t\tString value=systemProperties.getProperty(key);\n\t\t_properties.setProperty(key,value);\n\t}\n\t_default_mountpoint=_properties.getString(DEFAULT_MOUNTPOINT,\"/modules\");\n\t_ignores=_properties.getString(MODULES_IGNORE,\"\").split(\",\");\n\t_autoreload=_properties.getBoolean(AUTORELOAD,false);\n\tif(!_appengine){\n\t\tString log4j=System.getProperty(\"butterfly.log4j\");\n\t\tFile logProperties=(log4j == null) ? new File(_webInfDir,\"log4j.properties\") : new File(log4j);\n\t\tif(logProperties.exists()){\n\t\t\tif(_autoreload){\n\t\t\t\tPropertyConfigurator.configureAndWatch(logProperties.getAbsolutePath(),watcherDelay);\n\t\t\t} else {\n\t\t\t\tPropertyConfigurator.configure(logProperties.getAbsolutePath());\n\t\t\t}\n\t\t}\n\t}\n\t_logger=LoggerFactory.getLogger(_name);\n\t_logger.info(\"Starting {} ...\",_name);\n\t_logger.info(\"Properties loaded from {}\",butterflyProperties);\n\tif(_autoreload)\n\t\t_logger.info(\"Autoreloading is enabled\");\n\tif(_appengine)\n\t\t_logger.info(\"Running in Google App Engine\");\n\t_logger.debug(\"> init\");\n\t_logger.debug(\"> initialize classloader\");\n\ttry {\n\t\t_classLoader=AccessController.doPrivileged(new PrivilegedAction<ButterflyClassLoader>(){\n  public ButterflyClassLoader run(){\n    return new ButterflyClassLoader(this.getClass().getClassLoader());\n  }\n}\n);\n\t\tThread.currentThread().setContextClassLoader(_classLoader);\n\t\t_classLoader.watch(butterflyProperties);\n\t\tcontextFactory=new ButterflyContextFactory();\n\t\tcontextFactory.initApplicationClassLoader(_classLoader);\n\t\tContextFactory.initGlobal(contextFactory);\n\t\tif(_autoreload && !_appengine){\n\t\t\t_timer=new Timer(true);\n\t\t\tTimerTask classloaderWatcher=_classLoader.getClassLoaderWatcher(new Trigger(_contextDir));\n\t\t\t_timer.schedule(classloaderWatcher,watcherDelay,watcherDelay);\n\t\t}\n\t} catch (Exception e){\n\t\tthrow new ServletException(\"Failed to load butterfly classloader\",e);\n\t} \n\t_logger.debug(\"< initialize classloader\");\n\tif(_autoreload && !_appengine){\n\t\t_logger.debug(\"> initialize script watcher\");\n\t\t_scriptWatcher=new ButterflyScriptWatcher();\n\t\t_timer.schedule(_scriptWatcher,watcherDelay,watcherDelay);\n\t\t_logger.debug(\"< initialize script watcher\");\n\t}\n\tthis.configure();\n\t_logger.debug(\"< init\");\n}","Original_Lines":103,"Target_Lines":80,"Manual":"@Override public void init(ServletConfig config) throws ServletException {\n\tsuper.init(config);\n\t_config=config;\n\t_appengine=isGAE(config);\n\t_name=System.getProperty(NAME,\"butterfly\");\n\t_context=config.getServletContext();\n\t_context.setAttribute(NAME,_name);\n\t_context.setAttribute(APPENGINE,_appengine);\n\t_contextDir=new File(_context.getRealPath(\"/\"));\n\t_webInfDir=new File(_contextDir,\"WEB-INF\");\n\t_properties=new ExtendedProperties();\n\t_mounter=new ButterflyMounter();\n\tString props=System.getProperty(\"butterfly.properties\");\n\tFile butterflyProperties=(props == null) ? new File(_webInfDir,\"butterfly.properties\") : new File(props);\n\tBufferedInputStream is=null;\n\ttry {\n\t\tis=new BufferedInputStream(new FileInputStream(butterflyProperties));\n\t\t_properties.load(is);\n\t} catch (FileNotFoundException e){\n\t} catch (IOException e){\n\t} finally {\n\t} \n\tString includes=_properties.getString(\"butterfly.includes\");\n\tif(includes != null){\n\t\tfor (String prop : includes.split(\",\")){\n\t\t\tFile prop_file=(prop.startsWith(\"/\")) ? new File(prop) : new File(_webInfDir,prop);\n\t\t\ttry {\n\t\t\t\tis=new BufferedInputStream(new FileInputStream(prop_file));\n\t\t\t\tExtendedProperties p=new ExtendedProperties();\n\t\t\t\tp.load(is);\n\t\t\t\t_properties.combine(p);\n\t\t\t} catch (Exception e){\n\t\t\t} finally {\n\t\t\t} \n\t\t}\n\t}\n\tProperties systemProperties=System.getProperties();\n\tfor (Iterator<Object> i=systemProperties.keySet().iterator(); i.hasNext(); ){\n\t\tString key=(String)i.next();\n\t\tString value=systemProperties.getProperty(key);\n\t\t_properties.setProperty(key,value);\n\t}\n\t_default_mountpoint=_properties.getString(DEFAULT_MOUNTPOINT,\"/modules\");\n\t_ignores=_properties.getString(MODULES_IGNORE,\"\").split(\",\");\n\t_autoreload=_properties.getBoolean(AUTORELOAD,false);\n\tif(!_appengine){\n\t\tString log4j=System.getProperty(\"butterfly.log4j\");\n\t\tFile logProperties=(log4j == null) ? new File(_webInfDir,\"log4j.properties\") : new File(log4j);\n\t\tif(logProperties.exists()){\n\t\t\tif(_autoreload){\n\t\t\t\tPropertyConfigurator.configureAndWatch(logProperties.getAbsolutePath(),watcherDelay);\n\t\t\t} else {\n\t\t\t\tPropertyConfigurator.configure(logProperties.getAbsolutePath());\n\t\t\t}\n\t\t}\n\t}\n\t_logger=LoggerFactory.getLogger(_name);\n\ttry {\n\t\t_classLoader=AccessController.doPrivileged(new PrivilegedAction<ButterflyClassLoader>(){\n  public ButterflyClassLoader run(){\n    return new ButterflyClassLoader(this.getClass().getClassLoader());\n  }\n}\n);\n\t\tThread.currentThread().setContextClassLoader(_classLoader);\n\t\t_classLoader.watch(butterflyProperties);\n\t\tcontextFactory=new ButterflyContextFactory();\n\t\tcontextFactory.initApplicationClassLoader(_classLoader);\n\t\tContextFactory.initGlobal(contextFactory);\n\t\tif(_autoreload && !_appengine){\n\t\t\t_timer=new Timer(true);\n\t\t\tTimerTask classloaderWatcher=_classLoader.getClassLoaderWatcher(new Trigger(_contextDir));\n\t\t\t_timer.schedule(classloaderWatcher,watcherDelay,watcherDelay);\n\t\t}\n\t} catch (Exception e){\n\t} \n\tif(_autoreload && !_appengine){\n\t\t_scriptWatcher=new ButterflyScriptWatcher();\n\t\t_timer.schedule(_scriptWatcher,watcherDelay,watcherDelay);\n\t}\n\tthis.configure();\n}","Distance":0.15384615384615385,"Automatic":"@Override public void init(ServletConfig config) throws ServletException {\n\tsuper.init(config);\n\t_config=config;\n\t_appengine=isGAE(config);\n\t_name=System.getProperty(NAME,\"butterfly\");\n\t_context=config.getServletContext();\n\t_context.setAttribute(NAME,_name);\n\t_context.setAttribute(APPENGINE,_appengine);\n\t_contextDir=new File(_context.getRealPath(\"/\"));\n\t_webInfDir=new File(_contextDir,\"WEB-INF\");\n\t_properties=new ExtendedProperties();\n\t_mounter=new ButterflyMounter();\n\tString props=System.getProperty(\"butterfly.properties\");\n\tFile butterflyProperties=(props == null) ? new File(_webInfDir,\"butterfly.properties\") : new File(props);\n\tBufferedInputStream is=null;\n\ttry {\n\t\tis=new BufferedInputStream(new FileInputStream(butterflyProperties));\n\t\t_properties.load(is);\n\t} catch (FileNotFoundException e){\n\t\tthrow new ServletException(\"Could not find butterfly properties file\",e);\n\t} catch (IOException e){\n\t\tthrow new ServletException(\"Could not read butterfly properties file\",e);\n\t} finally {\n\t\ttry {\n\t\t\tis.close();\n\t\t} catch (Exception e){\n\t\t} \n\t} \n\tString includes=_properties.getString(\"butterfly.includes\");\n\tif(includes != null){\n\t\tfor (String prop : includes.split(\",\")){\n\t\t\tFile prop_file=(prop.startsWith(\"/\")) ? new File(prop) : new File(_webInfDir,prop);\n\t\t\ttry {\n\t\t\t\tis=new BufferedInputStream(new FileInputStream(prop_file));\n\t\t\t\tExtendedProperties p=new ExtendedProperties();\n\t\t\t\tp.load(is);\n\t\t\t\t_properties.combine(p);\n\t\t\t} catch (Exception e){\n\t\t\t} finally {\n\t\t\t\ttry {\n\t\t\t\t\tis.close();\n\t\t\t\t} catch (Exception e){\n\t\t\t\t} \n\t\t\t} \n\t\t}\n\t}\n\tProperties systemProperties=System.getProperties();\n\tfor (Iterator<Object> i=systemProperties.keySet().iterator(); i.hasNext(); ){\n\t\tString key=(String)i.next();\n\t\tString value=systemProperties.getProperty(key);\n\t\t_properties.setProperty(key,value);\n\t}\n\t_default_mountpoint=_properties.getString(DEFAULT_MOUNTPOINT,\"/modules\");\n\t_ignores=_properties.getString(MODULES_IGNORE,\"\").split(\",\");\n\t_autoreload=_properties.getBoolean(AUTORELOAD,false);\n\tif(!_appengine){\n\t\tString log4j=System.getProperty(\"butterfly.log4j\");\n\t\tFile logProperties=(log4j == null) ? new File(_webInfDir,\"log4j.properties\") : new File(log4j);\n\t\tif(logProperties.exists()){\n\t\t\tif(_autoreload){\n\t\t\t\tPropertyConfigurator.configureAndWatch(logProperties.getAbsolutePath(),watcherDelay);\n\t\t\t} else {\n\t\t\t\tPropertyConfigurator.configure(logProperties.getAbsolutePath());\n\t\t\t}\n\t\t}\n\t}\n\t_logger=LoggerFactory.getLogger(_name);\n\tif(_autoreload)\n\tif(_appengine)\n\ttry {\n\t\tThread.currentThread().setContextClassLoader(_classLoader);\n\t\t_classLoader.watch(butterflyProperties);\n\t\tcontextFactory=new ButterflyContextFactory();\n\t\tcontextFactory.initApplicationClassLoader(_classLoader);\n\t\tContextFactory.initGlobal(contextFactory);\n\t\tif(_autoreload && !_appengine){\n\t\t\t_timer=new Timer(true);\n\t\t\tTimerTask classloaderWatcher=_classLoader.getClassLoaderWatcher(new Trigger(_contextDir));\n\t\t\t_timer.schedule(classloaderWatcher,watcherDelay,watcherDelay);\n\t\t}\n\t} catch (Exception e){\n\t} \n\tif(_autoreload && !_appengine){\n\t\t_scriptWatcher=new ButterflyScriptWatcher();\n\t\t_timer.schedule(_scriptWatcher,watcherDelay,watcherDelay);\n\t}\n}"},{"Origin":"@SuppressWarnings(\"unchecked\") public void configure(){\n\t_logger.debug(\"> configure\");\n\t_logger.info(\"> process properties\");\n\ttry {\n\t\tString homePath=_properties.getString(HOME);\n\t\tif(homePath == null){\n\t\t\t_homeDir=_contextDir;\n\t\t} else {\n\t\t\t_homeDir=new File(homePath);\n\t\t}\n\t\t_logger.info(\"Butterfly home: {}\",_homeDir);\n\t\tIterator<String> i=_properties.getKeys(ZONE);\n\t\twhile(i.hasNext()){\n\t\t\tString zone=i.next();\n\t\t\tString path=_properties.getString(zone);\n\t\t\tzone=zone.substring(ZONE.length() + 1);\n\t\t\t_logger.info(\"Zone path: [{}] -> {}\",zone,path);\n\t\t\t_mounter.registerZone(zone,path);\n\t\t}\n\t\tString defaultZone=_properties.getString(DEFAULT_ZONE);\n\t\tif(defaultZone != null){\n\t\t\t_logger.info(\"Default zone is: '{}'\",defaultZone);\n\t\t\t_mounter.setDefaultZone(defaultZone);\n\t\t} else {\n\t\t\tString baseURL=_properties.getString(BASE_URL,\"/\");\n\t\t\t_mounter.registerZone(MAIN_ZONE,baseURL);\n\t\t\t_mounter.setDefaultZone(MAIN_ZONE);\n\t\t}\n\t\tString language=_properties.getString(\"butterfly.locale.language\");\n\t\tString country=_properties.getString(\"butterfly.locale.country\");\n\t\tString variant=_properties.getString(\"butterfly.locale.variant\");\n\t\tif(language != null){\n\t\t\tif(country != null){\n\t\t\t\tif(variant != null){\n\t\t\t\t\tLocale.setDefault(new Locale(language,country,variant));\n\t\t\t\t} else {\n\t\t\t\t\tLocale.setDefault(new Locale(language,country));\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tLocale.setDefault(new Locale(language));\n\t\t\t}\n\t\t}\n\t\tString timeZone=_properties.getString(\"butterfly.timeZone\");\n\t\tif(timeZone != null){\n\t\t\tTimeZone.setDefault(TimeZone.getTimeZone(timeZone));\n\t\t}\n\t\t_routingCookieMaxAge=_properties.getInt(\"butterfly.routing.cookie.maxage\",-1);\n\t} catch (Exception e){\n\t\t_configurationException=new Exception(\"Failed to load butterfly properties\",e);\n\t} \n\t_logger.info(\"< process properties\");\n\t_logger.info(\"> load modules\");\n\tList<String> paths=_properties.getList(MODULES_PATH);\n\tfor (String path : paths){\n\t\tfindModulesIn(absolutize(_homeDir,path.trim()));\n\t}\n\tString servlet_paths=this._config.getInitParameter(MODULES_PATH);\n\tif(servlet_paths != null){\n\t\tfor (String path : servlet_paths.split(\",\")){\n\t\t\tfindModulesIn(absolutize(_homeDir,path.trim()));\n\t\t}\n\t}\n\t_logger.info(\"< load modules\");\n\t_logger.info(\"> create modules\");\n\tfor (String name : _moduleProperties.keySet()){\n\t\tcreateModule(name);\n\t}\n\t_logger.info(\"< create modules\");\n\t_logger.info(\"> load module wirings\");\n\tExtendedProperties wirings=new ExtendedProperties();\n\ttry {\n\t\tFile moduleWirings=absolutize(_homeDir,_properties.getString(\"butterfly.modules.wirings\",\"WEB-INF/modules.properties\"));\n\t\t_logger.info(\"Loaded module wirings from: {}\",moduleWirings);\n\t\t_classLoader.watch(moduleWirings);\n\t\tFileInputStream fis=new FileInputStream(moduleWirings);\n\t\twirings.load(fis);\n\t\tfis.close();\n\t} catch (Exception e){\n\t\t_configurationException=new Exception(\"Failed to load module wirings\",e);\n\t} \n\t_logger.info(\"< load module wirings\");\n\t_logger.info(\"> wire modules\");\n\ttry {\n\t\twireModules(wirings);\n\t} catch (Exception e){\n\t\t_configurationException=new Exception(\"Failed to wire modules\",e);\n\t} \n\t_logger.info(\"< wire modules\");\n\t_logger.info(\"> configure modules\");\n\ttry {\n\t\tconfigureModules();\n\t} catch (Exception e){\n\t\t_configurationException=new Exception(\"Failed to configure modules\",e);\n\t} \n\t_logger.info(\"< configure modules\");\n\t_logger.info(\"> initialize modules\");\n\tSet<String> initialized=new HashSet<String>();\n\tSet<String> initializing=new HashSet<String>();\n\tfor (String name : _modulesByName.keySet()){\n\t\tinitializeModule(name,initialized,initializing);\n\t}\n\t_logger.info(\"< initialize modules\");\n\t_configured=true;\n\t_logger.debug(\"< configure\");\n}","Original_Lines":103,"Target_Lines":69,"Manual":"@SuppressWarnings(\"unchecked\") public void configure(){\n\ttry {\n\t\tIterator<String> i=_properties.getKeys(ZONE);\n\t\twhile(i.hasNext()){\n\t\t\t_mounter.registerZone(zone,path);\n\t\t}\n\t\tString defaultZone=_properties.getString(DEFAULT_ZONE);\n\t\tif(defaultZone != null){\n\t\t\t_mounter.setDefaultZone(defaultZone);\n\t\t} else {\n\t\t\tString baseURL=_properties.getString(BASE_URL,\"/\");\n\t\t\t_mounter.registerZone(MAIN_ZONE,baseURL);\n\t\t\t_mounter.setDefaultZone(MAIN_ZONE);\n\t\t}\n\t\tString language=_properties.getString(\"butterfly.locale.language\");\n\t\tString country=_properties.getString(\"butterfly.locale.country\");\n\t\tString variant=_properties.getString(\"butterfly.locale.variant\");\n\t\tif(language != null){\n\t\t\tif(country != null){\n\t\t\t\tif(variant != null){\n\t\t\t\t\tLocale.setDefault(new Locale(language,country,variant));\n\t\t\t\t} else {\n\t\t\t\t\tLocale.setDefault(new Locale(language,country));\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tLocale.setDefault(new Locale(language));\n\t\t\t}\n\t\t}\n\t\tString timeZone=_properties.getString(\"butterfly.timeZone\");\n\t\tif(timeZone != null){\n\t\t\tTimeZone.setDefault(TimeZone.getTimeZone(timeZone));\n\t\t}\n\t} catch (Exception e){\n\t} \n\tList<String> paths=_properties.getList(MODULES_PATH);\n\tfor (String path : paths){\n\t\tfindModulesIn(absolutize(_homeDir,path.trim()));\n\t}\n\tString servlet_paths=this._config.getInitParameter(MODULES_PATH);\n\tif(servlet_paths != null){\n\t\tfor (String path : servlet_paths.split(\",\")){\n\t\t\tfindModulesIn(absolutize(_homeDir,path.trim()));\n\t\t}\n\t}\n\tfor (String name : _moduleProperties.keySet()){\n\t\tcreateModule(name);\n\t}\n\tExtendedProperties wirings=new ExtendedProperties();\n\ttry {\n\t\tFile moduleWirings=absolutize(_homeDir,_properties.getString(\"butterfly.modules.wirings\",\"WEB-INF/modules.properties\"));\n\t\t_classLoader.watch(moduleWirings);\n\t\tFileInputStream fis=new FileInputStream(moduleWirings);\n\t\twirings.load(fis);\n\t\tfis.close();\n\t} catch (Exception e){\n\t} \n\ttry {\n\t\twireModules(wirings);\n\t} catch (Exception e){\n\t} \n\ttry {\n\t\tconfigureModules();\n\t} catch (Exception e){\n\t} \n\tSet<String> initialized=new HashSet<String>();\n\tSet<String> initializing=new HashSet<String>();\n\tfor (String name : _modulesByName.keySet()){\n\t\tinitializeModule(name,initialized,initializing);\n\t}\n\t_configured=true;\n}","Distance":0.32786885245901637,"Automatic":"@SuppressWarnings(\"unchecked\") public void configure(){\n\ttry {\n\t\tString homePath=_properties.getString(HOME);\n\t\tif(homePath == null){\n\t\t\t_homeDir=_contextDir;\n\t\t} else {\n\t\t\t_homeDir=new File(homePath);\n\t\t}\n\t\t_logger.info(\"Butterfly home: {}\",_homeDir);\n\t\tIterator<String> i=_properties.getKeys(ZONE);\n\t\twhile(i.hasNext()){\n\t\t\tString zone=i.next();\n\t\t\tString path=_properties.getString(zone);\n\t\t\tzone=zone.substring(ZONE.length() + 1);\n\t\t\t_logger.info(\"Zone path: [{}] -> {}\",zone,path);\n\t\t\t_mounter.registerZone(zone,path);\n\t\t}\n\t\tString defaultZone=_properties.getString(DEFAULT_ZONE);\n\t\tif(defaultZone != null){\n\t\t\t_logger.info(\"Default zone is: '{}'\",defaultZone);\n\t\t\t_mounter.setDefaultZone(defaultZone);\n\t\t} else {\n\t\t\tString baseURL=_properties.getString(BASE_URL,\"/\");\n\t\t\t_mounter.registerZone(MAIN_ZONE,baseURL);\n\t\t\t_mounter.setDefaultZone(MAIN_ZONE);\n\t\t}\n\t\tString language=_properties.getString(\"butterfly.locale.language\");\n\t\tString country=_properties.getString(\"butterfly.locale.country\");\n\t\tString variant=_properties.getString(\"butterfly.locale.variant\");\n\t\tif(language != null){\n\t\t\tif(country != null){\n\t\t\t\tif(variant != null){\n\t\t\t\t\tLocale.setDefault(new Locale(language,country,variant));\n\t\t\t\t} else {\n\t\t\t\t\tLocale.setDefault(new Locale(language,country));\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tLocale.setDefault(new Locale(language));\n\t\t\t}\n\t\t}\n\t\tString timeZone=_properties.getString(\"butterfly.timeZone\");\n\t\tif(timeZone != null){\n\t\t\tTimeZone.setDefault(TimeZone.getTimeZone(timeZone));\n\t\t}\n\t\t_routingCookieMaxAge=_properties.getInt(\"butterfly.routing.cookie.maxage\",-1);\n\t} catch (Exception e){\n\t\t_configurationException=new Exception(\"Failed to load butterfly properties\",e);\n\t} \n\tList<String> paths=_properties.getList(MODULES_PATH);\n\tString servlet_paths=this._config.getInitParameter(MODULES_PATH);\n\tif(servlet_paths != null){\n\t\tfor (String path : servlet_paths.split(\",\")){\n\t\t\tfindModulesIn(absolutize(_homeDir,path.trim()));\n\t\t}\n\t}\n\tExtendedProperties wirings=new ExtendedProperties();\n\ttry {\n\t\tFile moduleWirings=absolutize(_homeDir,_properties.getString(\"butterfly.modules.wirings\",\"WEB-INF/modules.properties\"));\n\t\t_logger.info(\"Loaded module wirings from: {}\",moduleWirings);\n\t\t_classLoader.watch(moduleWirings);\n\t\tFileInputStream fis=new FileInputStream(moduleWirings);\n\t\twirings.load(fis);\n\t\tfis.close();\n\t} catch (Exception e){\n\t\t_configurationException=new Exception(\"Failed to load module wirings\",e);\n\t} \n\tSet<String> initialized=new HashSet<String>();\n\tSet<String> initializing=new HashSet<String>();\n\tfor (String name : _modulesByName.keySet()){\n\t\tinitializeModule(name,initialized,initializing);\n\t}\n\t_configured=true;\n}"},{"Origin":"@Override @SuppressWarnings(\"unchecked\") public void service(HttpServletRequest request,HttpServletResponse response) throws ServletException, IOException {\n\tString method=request.getMethod();\n\tString path=request.getPathInfo();\n\tString urlQuery=request.getQueryString();\n\tif(_mounter != null){\n\t\tZone zone=_mounter.getZone(request);\n\t\tif(_logger.isDebugEnabled()){\n\t\t\t_logger.debug(\"> \" + method + \" [\"+ zone.getName()+ \"] \"+ path+ ((urlQuery != null) ? \"?\" + urlQuery : \"\"));\n\t\t\tEnumeration<String> en=request.getHeaderNames();\n\t\t\twhile(en.hasMoreElements()){\n\t\t\t\tString header=en.nextElement();\n\t\t\t\t_logger.trace(\"{}: {}\",header,request.getHeader(header));\n\t\t\t}\n\t\t} else if(_logger.isInfoEnabled()){\n\t\t\tString zoneName=(zone != null) ? zone.getName() : \"\";\n\t\t\t_logger.info(\"{} {} [{}]\",new String[]{method,path,zoneName});\n\t\t}\n\t\tsetRoutingCookie(request,response);\n\t\ttry {\n\t\t\tif(_configured){\n\t\t\t\tif(_configurationException == null){\n\t\t\t\t\tButterflyModule module=_mounter.getModule(path,zone);\n\t\t\t\t\t_logger.debug(\"Module '{}' will handle the request\",module.getName());\n\t\t\t\t\tString localPath=module.getRelativePath(request);\n\t\t\t\t\tif(!module.process(localPath,request,response)){\n\t\t\t\t\t\tresponse.sendError(HttpServletResponse.SC_NOT_FOUND);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\terror(response,\"Butterfly Error\",\"Butterfly incurred in the following errors while initializing:\",_configurationException);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tdelay(response,\"Butterfly is still initializing...\");\n\t\t\t}\n\t\t} catch (FileNotFoundException e){\n\t\t\tresponse.sendError(HttpServletResponse.SC_NOT_FOUND);\n\t\t} catch (Exception e){\n\t\t\terror(response,\"Butterfly Error\",\"Butterfly caught the following error while processing the request:\",e);\n\t\t} \n\t\tresponse.flushBuffer();\n\t\tif(_logger.isDebugEnabled())\n\t\t\t_logger.debug(\"< \" + method + \" [\"+ zone.getName()+ \"] \"+ path+ ((urlQuery != null) ? \"?\" + urlQuery : \"\"));\n\t} else {\n\t\tresponse.sendError(HttpServletResponse.SC_SERVICE_UNAVAILABLE);\n\t}\n}","Original_Lines":43,"Target_Lines":27,"Manual":"@Override @SuppressWarnings(\"unchecked\") public void service(HttpServletRequest request,HttpServletResponse response) throws ServletException, IOException {\n\tString method=request.getMethod();\n\tString path=request.getPathInfo();\n\tString urlQuery=request.getQueryString();\n\tif(_mounter != null){\n\t\tZone zone=_mounter.getZone(request);\n\t\tsetRoutingCookie(request,response);\n\t\ttry {\n\t\t\tif(_configured){\n\t\t\t\tif(_configurationException == null){\n\t\t\t\t\tButterflyModule module=_mounter.getModule(path,zone);\n\t\t\t\t\tString localPath=module.getRelativePath(request);\n\t\t\t\t\tif(!module.process(localPath,request,response)){\n\t\t\t\t\t\tresponse.sendError(HttpServletResponse.SC_NOT_FOUND);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\terror(response,\"Butterfly Error\",\"Butterfly incurred in the following errors while initializing:\",_configurationException);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tdelay(response,\"Butterfly is still initializing...\");\n\t\t\t}\n\t\t} catch (FileNotFoundException e){\n\t\t} catch (Exception e){\n\t\t} \n\t\tresponse.flushBuffer();\n\t} else {\n\t\tresponse.sendError(HttpServletResponse.SC_SERVICE_UNAVAILABLE);\n\t}\n}","Distance":0.4090909090909091,"Automatic":"@Override @SuppressWarnings(\"unchecked\") public void service(HttpServletRequest request,HttpServletResponse response) throws ServletException, IOException {\n\tString method=request.getMethod();\n\tString urlQuery=request.getQueryString();\n\tif(_mounter != null){\n\t\tZone zone=_mounter.getZone(request);\n\t\tif(_logger.isDebugEnabled()){\n\t\t} else if(_logger.isInfoEnabled()){\n\t\t\tString zoneName=(zone != null) ? zone.getName() : \"\";\n\t\t}\n\t\tsetRoutingCookie(request,response);\n\t\ttry {\n\t\t\tif(_configured){\n\t\t\t\tif(_configurationException == null){\n\t\t\t\t\tButterflyModule module=_mounter.getModule(path,zone);\n\t\t\t\t\tString localPath=module.getRelativePath(request);\n\t\t\t\t} else {\n\t\t\t\t\terror(response,\"Butterfly Error\",\"Butterfly incurred in the following errors while initializing:\",_configurationException);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tdelay(response,\"Butterfly is still initializing...\");\n\t\t\t}\n\t\t} catch (FileNotFoundException e){\n\t\t\tresponse.sendError(HttpServletResponse.SC_NOT_FOUND);\n\t\t} catch (Exception e){\n\t\t} \n\t\tif(_logger.isDebugEnabled())\n\t} else {\n\t\tresponse.sendError(HttpServletResponse.SC_SERVICE_UNAVAILABLE);\n\t}\n}"},{"Origin":"protected ButterflyModule createModule(String name){\n\t_logger.trace(\"> Creating module: {}\",name);\n\tif(_modulesByName.containsKey(name)){\n\t\t_logger.trace(\"< Module '{}' already exists\",name);\n\t\treturn _modulesByName.get(name);\n\t}\n\tExtendedProperties p=_moduleProperties.get(name);\n\tFile path=new File(p.getString(PATH_PROP));\n\t_logger.debug(\"Module path: {}\",path);\n\tFile classes=new File(path,\"MOD-INF/classes\");\n\tif(classes.exists()){\n\t\t_classLoader.addRepository(classes);\n\t}\n\tFile libs=new File(path,\"MOD-INF/lib\");\n\tif(libs.exists()){\n\t\t_classLoader.addRepository(libs);\n\t}\n\tButterflyModule m=new ButterflyModuleImpl();\n\tString manager=p.getString(\"module-impl\");\n\tif(manager != null && !manager.equals(m.getClass().getName())){\n\t\ttry {\n\t\t\tClass<?> c=_classLoader.loadClass(manager);\n\t\t\tm=(ButterflyModule)c.newInstance();\n\t\t} catch (Exception e){\n\t\t\t_logger.error(\"Error loading special module manager\",e);\n\t\t} \n\t}\n\tm.setName(name);\n\tm.setPath(path);\n\tm.setModules(_modulesByName);\n\tm.setMounter(_mounter);\n\tm.setClassLoader(_classLoader);\n\tm.setTimer(_timer);\n\t_modulesByName.put(name,m);\n\tButterflyModule parentModule=null;\n\tString parentName=p.getString(extendsProperty);\n\tif(parentName != null){\n\t\tif(_moduleProperties.containsKey(parentName)){\n\t\t\tif(_modulesByName.containsKey(parentName)){\n\t\t\t\tparentModule=_modulesByName.get(parentName);\n\t\t\t} else {\n\t\t\t\tparentModule=createModule(parentName);\n\t\t\t}\n\t\t} else {\n\t\t\tthrow new RuntimeException(\"Cannot wire module '\" + name + \"' because the extended module '\"+ parentName+ \"' is not defined.\");\n\t\t}\n\t}\n\tif(parentModule != null){\n\t\tm.setExtended(parentModule);\n\t\tparentModule.addExtendedBy(m);\n\t}\n\t_logger.trace(\"< Creating module: {}\",name);\n\treturn m;\n}","Original_Lines":52,"Target_Lines":43,"Manual":"protected ButterflyModule createModule(String name){\n\tExtendedProperties p=_moduleProperties.get(name);\n\tFile path=new File(p.getString(PATH_PROP));\n\tFile classes=new File(path,\"MOD-INF/classes\");\n\tif(classes.exists()){\n\t\t_classLoader.addRepository(classes);\n\t}\n\tFile libs=new File(path,\"MOD-INF/lib\");\n\tif(libs.exists()){\n\t\t_classLoader.addRepository(libs);\n\t}\n\tButterflyModule m=new ButterflyModuleImpl();\n\tString manager=p.getString(\"module-impl\");\n\tif(manager != null && !manager.equals(m.getClass().getName())){\n\t\ttry {\n\t\t\tClass<?> c=_classLoader.loadClass(manager);\n\t\t\tm=(ButterflyModule)c.newInstance();\n\t\t} catch (Exception e){\n\t\t} \n\t}\n\tm.setName(name);\n\tm.setPath(path);\n\tm.setModules(_modulesByName);\n\tm.setMounter(_mounter);\n\tm.setClassLoader(_classLoader);\n\tm.setTimer(_timer);\n\t_modulesByName.put(name,m);\n\tButterflyModule parentModule=null;\n\tString parentName=p.getString(extendsProperty);\n\tif(parentName != null){\n\t\tif(_moduleProperties.containsKey(parentName)){\n\t\t\tif(_modulesByName.containsKey(parentName)){\n\t\t\t\tparentModule=_modulesByName.get(parentName);\n\t\t\t} else {\n\t\t\t\tparentModule=createModule(parentName);\n\t\t\t}\n\t\t} else {\n\t\t}\n\t}\n\tif(parentModule != null){\n\t\tm.setExtended(parentModule);\n\t\tparentModule.addExtendedBy(m);\n\t}\n\treturn m;\n}","Distance":0.14285714285714285,"Automatic":"protected ButterflyModule createModule(String name){\n\tif(_modulesByName.containsKey(name)){\n\t\treturn _modulesByName.get(name);\n\t}\n\tExtendedProperties p=_moduleProperties.get(name);\n\tFile path=new File(p.getString(PATH_PROP));\n\tFile classes=new File(path,\"MOD-INF/classes\");\n\tFile libs=new File(path,\"MOD-INF/lib\");\n\tif(libs.exists()){\n\t\t_classLoader.addRepository(libs);\n\t}\n\tButterflyModule m=new ButterflyModuleImpl();\n\tString manager=p.getString(\"module-impl\");\n\tif(manager != null && !manager.equals(m.getClass().getName())){\n\t\ttry {\n\t\t\tClass<?> c=_classLoader.loadClass(manager);\n\t\t\tm=(ButterflyModule)c.newInstance();\n\t\t} catch (Exception e){\n\t\t\t_logger.error(\"Error loading special module manager\",e);\n\t\t} \n\t}\n\tm.setName(name);\n\tm.setPath(path);\n\tm.setModules(_modulesByName);\n\tm.setMounter(_mounter);\n\tm.setClassLoader(_classLoader);\n\tm.setTimer(_timer);\n\t_modulesByName.put(name,m);\n\tButterflyModule parentModule=null;\n\tString parentName=p.getString(extendsProperty);\n\tif(parentName != null){\n\t\tif(_moduleProperties.containsKey(parentName)){\n\t\t\tif(_modulesByName.containsKey(parentName)){\n\t\t\t\tparentModule=_modulesByName.get(parentName);\n\t\t\t} else {\n\t\t\t\tparentModule=createModule(parentName);\n\t\t\t}\n\t\t} else {\n\t\t}\n\t}\n\tif(parentModule != null){\n\t\tm.setExtended(parentModule);\n\t\tparentModule.addExtendedBy(m);\n\t}\n\treturn m;\n}"},{"Origin":"@Override public void write(char[] buf,int off,int len){\n\t_logger.trace(\"write char[] {} {}\",off,len);\n\tif(off >= buf.length)\n\t\treturn;\n\tlen=Math.min(off + len,buf.length) - off;\n\tfor (int i=off; i < off + len; i++){\n\t\tchar c=buf[i];\n\t\t_logger.trace(\"'{}'\",c);\n\t\tif(_state == State.START){\n\t\t\tif(c == '['){\n\t\t\t\t_logger.trace(\"start -> opening\");\n\t\t\t\t_state=State.OPENING;\n\t\t\t\t_start=i;\n\t\t\t}\n\t\t} else if(_state == State.OPENING){\n\t\t\tif(c == '#'){\n\t\t\t\t_logger.trace(\"opening -> opened\");\n\t\t\t\t_state=State.OPENED;\n\t\t\t} else {\n\t\t\t\t_logger.trace(\"opening -> start\");\n\t\t\t\t_state=State.START;\n\t\t\t}\n\t\t} else if(_state == State.OPENED){\n\t\t\tif(c == '#'){\n\t\t\t\t_logger.trace(\"opened -> closing\");\n\t\t\t\t_state=State.CLOSING;\n\t\t\t} else if(!Character.isJavaIdentifierPart(c)){\n\t\t\t\t_logger.trace(\"opened -> start\");\n\t\t\t\t_state=State.START;\n\t\t\t}\n\t\t} else if(_state == State.CLOSING){\n\t\t\tif(c == ']'){\n\t\t\t\t_logger.trace(\"closing -> closed\");\n\t\t\t\t_state=State.CLOSED;\n\t\t\t} else {\n\t\t\t\t_logger.trace(\"closing -> start\");\n\t\t\t\t_state=State.START;\n\t\t\t}\n\t\t} else if(_state == State.CLOSED){\n\t\t\t_end=i - 1;\n\t\t\tif(c == '/'){\n\t\t\t\t_logger.trace(\"closed -> slashed\");\n\t\t\t\t_state=State.SLASHED;\n\t\t\t} else {\n\t\t\t\t_logger.trace(\"closed -> unslashed\");\n\t\t\t\t_state=State.UNSLASHED;\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t}\n\tif(_state == State.START){\n\t\t_logger.trace(\"pass along\");\n\t\tint l=_buffer.length();\n\t\tif(l > 0){\n\t\t\tchar[] b=new char[l];\n\t\t\t_buffer.getChars(0,l,b,0);\n\t\t\t_writer.write(b,0,l);\n\t\t\t_buffer.setLength(0);\n\t\t}\n\t\t_writer.write(buf,off,len);\n\t} else if(_state == State.SLASHED || _state == State.UNSLASHED){\n\t\tboolean slashed=(_state == State.SLASHED);\n\t\t_state=State.START;\n\t\t_logger.trace(\"closed\");\n\t\tif(_buffer.length() > 0){\n\t\t\tint l=_buffer.length();\n\t\t\t_logger.trace(\"with leftovers: {}\",l);\n\t\t\t_buffer.append(buf,off,len);\n\t\t\tlen=_buffer.length();\n\t\t\tbuf=new char[len];\n\t\t\toff=0;\n\t\t\t_end+=l;\n\t\t\t_buffer.getChars(0,len,buf,0);\n\t\t\t_buffer.setLength(0);\n\t\t}\n\t\t_logger.trace(\"{} {}\",_start,_end);\n\t\tString name=new String(buf,_start + 2,_end - _start - 3);\n\t\t_logger.trace(\"name: {}\",name);\n\t\tButterflyModule module=_module.getModule(name);\n\t\tMountPoint mountPoint=(module == null) ? null : module.getMountPoint();\n\t\tif(mountPoint != null){\n\t\t\t_logger.trace(\"module found\");\n\t\t\t_writer.write(buf,off,_start - off);\n\t\t\tif(this._baseURL != null)\n\t\t\t\t_writer.write(_baseURL,0,_baseURL.length);\n\t\t\tchar[] mountPointChars=mountPoint.getMountPoint().toCharArray();\n\t\t\t_writer.write(mountPointChars,0,slashed ? mountPointChars.length - 1 : mountPointChars.length);\n\t\t\twrite(buf,_end + 1,off + len - _end - 1);\n\t\t} else {\n\t\t\t_logger.info(\"module NOT found\");\n\t\t\t_writer.write(buf,off,_end - off);\n\t\t\twrite(buf,_end,len - (_end - off));\n\t\t}\n\t} else {\n\t\tif(_buffer.length() == 0){\n\t\t\t_start-=off;\n\t\t}\n\t\t_buffer.append(buf,off,len);\n\t\t_logger.trace(\"saved leftovers: {} {}\",_buffer.length(),_start);\n\t}\n}","Original_Lines":99,"Target_Lines":35,"Manual":"@Override public void write(char[] buf,int off,int len){\n\tfor (int i=off; i < off + len; i++){\n\t\tchar c=buf[i];\n\t\tif(_state == State.START){\n\t\t} else if(_state == State.OPENING){\n\t\t} else if(_state == State.OPENED){\n\t\t} else if(_state == State.CLOSING){\n\t\t} else if(_state == State.CLOSED){\n\t\t}\n\t}\n\tif(_state == State.START){\n\t\tint l=_buffer.length();\n\t\t_writer.write(buf,off,len);\n\t} else if(_state == State.SLASHED || _state == State.UNSLASHED){\n\t\tboolean slashed=(_state == State.SLASHED);\n\t\t_state=State.START;\n\t\tString name=new String(buf,_start + 2,_end - _start - 3);\n\t\tButterflyModule module=_module.getModule(name);\n\t\tMountPoint mountPoint=(module == null) ? null : module.getMountPoint();\n\t\tif(mountPoint != null){\n\t\t\t_writer.write(buf,off,_start - off);\n\t\t\tif(this._baseURL != null)\n\t\t\t\t_writer.write(_baseURL,0,_baseURL.length);\n\t\t\tchar[] mountPointChars=mountPoint.getMountPoint().toCharArray();\n\t\t\t_writer.write(mountPointChars,0,slashed ? mountPointChars.length - 1 : mountPointChars.length);\n\t\t\twrite(buf,_end + 1,off + len - _end - 1);\n\t\t} else {\n\t\t\t_writer.write(buf,off,_end - off);\n\t\t\twrite(buf,_end,len - (_end - off));\n\t\t}\n\t} else {\n\t\tif(_buffer.length() == 0){\n\t\t\t_start-=off;\n\t\t}\n\t\t_buffer.append(buf,off,len);\n\t}\n}","Distance":0.42857142857142855,"Automatic":"@Override public void write(char[] buf,int off,int len){\n\tlen=Math.min(off + len,buf.length) - off;\n\tfor (int i=off; i < off + len; i++){\n\t\tchar c=buf[i];\n\t\tif(_state == State.START){\n\t\t} else if(_state == State.OPENING){\n\t\t} else if(_state == State.OPENED){\n\t\t\tif(c == '#'){\n\t\t\t} else if(!Character.isJavaIdentifierPart(c)){\n\t\t\t}\n\t\t} else if(_state == State.CLOSING){\n\t\t} else if(_state == State.CLOSED){\n\t\t}\n\t}\n\tif(_state == State.START){\n\t\tint l=_buffer.length();\n\t\t_writer.write(buf,off,len);\n\t} else if(_state == State.SLASHED || _state == State.UNSLASHED){\n\t\tboolean slashed=(_state == State.SLASHED);\n\t\tif(_buffer.length() > 0){\n\t\t\tint l=_buffer.length();\n\t\t\t_buffer.append(buf,off,len);\n\t\t\t_buffer.getChars(0,len,buf,0);\n\t\t}\n\t\tif(mountPoint != null){\n\t\t\t_writer.write(buf,off,_start - off);\n\t\t\tif(this._baseURL != null)\n\t\t\t\t_writer.write(_baseURL,0,_baseURL.length);\n\t\t\t_writer.write(mountPointChars,0,slashed ? mountPointChars.length - 1 : mountPointChars.length);\n\t\t} else {\n\t\t\t_writer.write(buf,off,_end - off);\n\t\t\twrite(buf,_end,len - (_end - off));\n\t\t}\n\t} else {\n\t\t_buffer.append(buf,off,len);\n\t}\n}"},{"Origin":"public CrawlController(CrawlConfig config,PageFetcher pageFetcher,RobotstxtServer robotstxtServer) throws Exception {\n\tsuper(config);\n\tconfig.validate();\n\tFile folder=new File(config.getCrawlStorageFolder());\n\tif(!folder.exists()){\n\t\tif(!folder.mkdirs()){\n\t\t\tthrow new Exception(\"Couldn't create this folder: \" + folder.getAbsolutePath());\n\t\t}\n\t}\n\tboolean resumable=config.isResumableCrawling();\n\tEnvironmentConfig envConfig=new EnvironmentConfig();\n\tenvConfig.setAllowCreate(true);\n\tenvConfig.setTransactional(resumable);\n\tenvConfig.setLocking(resumable);\n\tFile envHome=new File(config.getCrawlStorageFolder() + \"/frontier\");\n\tif(!envHome.exists()){\n\t\tif(!envHome.mkdir()){\n\t\t\tthrow new Exception(\"Couldn't create this folder: \" + envHome.getAbsolutePath());\n\t\t}\n\t}\n\tif(!resumable){\n\t\tIO.deleteFolderContents(envHome);\n\t}\n\tEnvironment env=new Environment(envHome,envConfig);\n\tdocIdServer=new DocIDServer(env,config);\n\tfrontier=new Frontier(env,config,docIdServer);\n\tthis.pageFetcher=pageFetcher;\n\tthis.robotstxtServer=robotstxtServer;\n\tfinished=false;\n\tshuttingDown=false;\n}","Original_Lines":29,"Target_Lines":17,"Manual":"public CrawlController(CrawlConfig config,PageFetcher pageFetcher,RobotstxtServer robotstxtServer) throws Exception {\n\tFile folder=new File(config.getCrawlStorageFolder());\n\tboolean resumable=config.isResumableCrawling();\n\tEnvironmentConfig envConfig=new EnvironmentConfig();\n\tenvConfig.setAllowCreate(true);\n\tenvConfig.setTransactional(resumable);\n\tenvConfig.setLocking(resumable);\n\tFile envHome=new File(config.getCrawlStorageFolder() + \"/frontier\");\n\tif(!resumable){\n\t\tIO.deleteFolderContents(envHome);\n\t}\n\tEnvironment env=new Environment(envHome,envConfig);\n\tdocIdServer=new DocIDServer(env,config);\n\tfrontier=new Frontier(env,config,docIdServer);\n\tthis.pageFetcher=pageFetcher;\n\tthis.robotstxtServer=robotstxtServer;\n\tfinished=false;\n\tshuttingDown=false;\n}","Distance":0.11764705882352941,"Automatic":"public CrawlController(CrawlConfig config,PageFetcher pageFetcher,RobotstxtServer robotstxtServer) throws Exception {\n\tconfig.validate();\n\tFile folder=new File(config.getCrawlStorageFolder());\n\tboolean resumable=config.isResumableCrawling();\n\tEnvironmentConfig envConfig=new EnvironmentConfig();\n\tenvConfig.setAllowCreate(true);\n\tenvConfig.setTransactional(resumable);\n\tenvConfig.setLocking(resumable);\n\tFile envHome=new File(config.getCrawlStorageFolder() + \"/frontier\");\n\tif(!resumable){\n\t\tIO.deleteFolderContents(envHome);\n\t}\n\tEnvironment env=new Environment(envHome,envConfig);\n\tdocIdServer=new DocIDServer(env,config);\n\tfrontier=new Frontier(env,config,docIdServer);\n\tthis.pageFetcher=pageFetcher;\n\tthis.robotstxtServer=robotstxtServer;\n\tshuttingDown=false;\n}"},{"Origin":"private void processPage(WebURL curURL){\n\tif(curURL == null){\n\t\treturn;\n\t}\n\tPageFetchResult fetchResult=null;\n\ttry {\n\t\tfetchResult=pageFetcher.fetchHeader(curURL);\n\t\tint statusCode=fetchResult.getStatusCode();\n\t\thandlePageStatusCode(curURL,statusCode,CustomFetchStatus.getStatusDescription(statusCode));\n\t\tif(statusCode != HttpStatus.SC_OK){\n\t\t\tif(statusCode == HttpStatus.SC_MOVED_PERMANENTLY || statusCode == HttpStatus.SC_MOVED_TEMPORARILY){\n\t\t\t\tif(myController.getConfig().isFollowRedirects()){\n\t\t\t\t\tString movedToUrl=fetchResult.getMovedToUrl();\n\t\t\t\t\tif(movedToUrl == null){\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tint newDocId=docIdServer.getDocId(movedToUrl);\n\t\t\t\t\tif(newDocId > 0){\n\t\t\t\t\t\treturn;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tWebURL webURL=new WebURL();\n\t\t\t\t\t\twebURL.setURL(movedToUrl);\n\t\t\t\t\t\twebURL.setParentDocid(curURL.getParentDocid());\n\t\t\t\t\t\twebURL.setParentUrl(curURL.getParentUrl());\n\t\t\t\t\t\twebURL.setDepth(curURL.getDepth());\n\t\t\t\t\t\twebURL.setDocid(-1);\n\t\t\t\t\t\tif(shouldVisit(webURL) && robotstxtServer.allows(webURL)){\n\t\t\t\t\t\t\twebURL.setDocid(docIdServer.getNewDocID(movedToUrl));\n\t\t\t\t\t\t\tfrontier.schedule(webURL);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else if(fetchResult.getStatusCode() == CustomFetchStatus.PageTooBig){\n\t\t\t\tlogger.info(\"Skipping a page which was bigger than max allowed size: \" + curURL.getURL());\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\t\tif(!curURL.getURL().equals(fetchResult.getFetchedUrl())){\n\t\t\tif(docIdServer.isSeenBefore(fetchResult.getFetchedUrl())){\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tcurURL.setURL(fetchResult.getFetchedUrl());\n\t\t\tcurURL.setDocid(docIdServer.getNewDocID(fetchResult.getFetchedUrl()));\n\t\t}\n\t\tPage page=new Page(curURL);\n\t\tint docid=curURL.getDocid();\n\t\tif(fetchResult.fetchContent(page) && parser.parse(page,curURL.getURL())){\n\t\t\tParseData parseData=page.getParseData();\n\t\t\tif(parseData instanceof HtmlParseData){\n\t\t\t\tHtmlParseData htmlParseData=(HtmlParseData)parseData;\n\t\t\t\tList<WebURL> toSchedule=new ArrayList<WebURL>();\n\t\t\t\tint maxCrawlDepth=myController.getConfig().getMaxDepthOfCrawling();\n\t\t\t\tfor (WebURL webURL : htmlParseData.getOutgoingUrls()){\n\t\t\t\t\twebURL.setParentDocid(docid);\n\t\t\t\t\twebURL.setParentUrl(curURL.getURL());\n\t\t\t\t\tint newdocid=docIdServer.getDocId(webURL.getURL());\n\t\t\t\t\tif(newdocid > 0){\n\t\t\t\t\t\twebURL.setDepth((short)-1);\n\t\t\t\t\t\twebURL.setDocid(newdocid);\n\t\t\t\t\t} else {\n\t\t\t\t\t\twebURL.setDocid(-1);\n\t\t\t\t\t\twebURL.setDepth((short)(curURL.getDepth() + 1));\n\t\t\t\t\t\tif(maxCrawlDepth == -1 || curURL.getDepth() < maxCrawlDepth){\n\t\t\t\t\t\t\tif(shouldVisit(webURL) && robotstxtServer.allows(webURL)){\n\t\t\t\t\t\t\t\twebURL.setDocid(docIdServer.getNewDocID(webURL.getURL()));\n\t\t\t\t\t\t\t\ttoSchedule.add(webURL);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tfrontier.scheduleAll(toSchedule);\n\t\t\t}\n\t\t\tvisit(page);\n\t\t}\n\t} catch (Exception e){\n\t\te.printStackTrace();\n\t\tlogger.error(e.getMessage() + \", while processing: \" + curURL.getURL());\n\t} finally {\n\t\tif(fetchResult != null){\n\t\t\tfetchResult.discardContentIfNotConsumed();\n\t\t}\n\t} \n}","Original_Lines":81,"Target_Lines":43,"Manual":"private void processPage(WebURL curURL){\n\tPageFetchResult fetchResult=null;\n\ttry {\n\t\tfetchResult=pageFetcher.fetchHeader(curURL);\n\t\tint statusCode=fetchResult.getStatusCode();\n\t\thandlePageStatusCode(curURL,statusCode,CustomFetchStatus.getStatusDescription(statusCode));\n\t\tif(statusCode != HttpStatus.SC_OK){\n\t\t\tif(statusCode == HttpStatus.SC_MOVED_PERMANENTLY || statusCode == HttpStatus.SC_MOVED_TEMPORARILY){\n\t\t\t\tif(myController.getConfig().isFollowRedirects()){\n\t\t\t\t\tString movedToUrl=fetchResult.getMovedToUrl();\n\t\t\t\t\tint newDocId=docIdServer.getDocId(movedToUrl);\n\t\t\t\t}\n\t\t\t} else if(fetchResult.getStatusCode() == CustomFetchStatus.PageTooBig){\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\t\tif(!curURL.getURL().equals(fetchResult.getFetchedUrl())){\n\t\t\tif(docIdServer.isSeenBefore(fetchResult.getFetchedUrl())){\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tcurURL.setURL(fetchResult.getFetchedUrl());\n\t\t\tcurURL.setDocid(docIdServer.getNewDocID(fetchResult.getFetchedUrl()));\n\t\t}\n\t\tPage page=new Page(curURL);\n\t\tint docid=curURL.getDocid();\n\t\tif(fetchResult.fetchContent(page) && parser.parse(page,curURL.getURL())){\n\t\t\tParseData parseData=page.getParseData();\n\t\t\tif(parseData instanceof HtmlParseData){\n\t\t\t\tHtmlParseData htmlParseData=(HtmlParseData)parseData;\n\t\t\t\tList<WebURL> toSchedule=new ArrayList<WebURL>();\n\t\t\t\tint maxCrawlDepth=myController.getConfig().getMaxDepthOfCrawling();\n\t\t\t\tfor (WebURL webURL : htmlParseData.getOutgoingUrls()){\n\t\t\t\t\tint newdocid=docIdServer.getDocId(webURL.getURL());\n\t\t\t\t}\n\t\t\t\tfrontier.scheduleAll(toSchedule);\n\t\t\t}\n\t\t\tvisit(page);\n\t\t}\n\t} catch (Exception e){\n\t} finally {\n\t\tif(fetchResult != null){\n\t\t\tfetchResult.discardContentIfNotConsumed();\n\t\t}\n\t} \n}","Distance":0.5681818181818182,"Automatic":"private void processPage(WebURL curURL){\n\tPageFetchResult fetchResult=null;\n\ttry {\n\t\tfetchResult=pageFetcher.fetchHeader(curURL);\n\t\tint statusCode=fetchResult.getStatusCode();\n\t\thandlePageStatusCode(curURL,statusCode,CustomFetchStatus.getStatusDescription(statusCode));\n\t\tif(statusCode != HttpStatus.SC_OK){\n\t\t\tif(statusCode == HttpStatus.SC_MOVED_PERMANENTLY || statusCode == HttpStatus.SC_MOVED_TEMPORARILY){\n\t\t\t\tif(myController.getConfig().isFollowRedirects()){\n\t\t\t\t\tString movedToUrl=fetchResult.getMovedToUrl();\n\t\t\t\t\tint newDocId=docIdServer.getDocId(movedToUrl);\n\t\t\t\t\tif(newDocId > 0){\n\t\t\t\t\t\treturn;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tWebURL webURL=new WebURL();\n\t\t\t\t\t\twebURL.setURL(movedToUrl);\n\t\t\t\t\t\twebURL.setParentDocid(curURL.getParentDocid());\n\t\t\t\t\t\twebURL.setParentUrl(curURL.getParentUrl());\n\t\t\t\t\t\twebURL.setDepth(curURL.getDepth());\n\t\t\t\t\t\twebURL.setDocid(-1);\n\t\t\t\t\t\tif(shouldVisit(webURL) && robotstxtServer.allows(webURL)){\n\t\t\t\t\t\t\twebURL.setDocid(docIdServer.getNewDocID(movedToUrl));\n\t\t\t\t\t\t\tfrontier.schedule(webURL);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else if(fetchResult.getStatusCode() == CustomFetchStatus.PageTooBig){\n\t\t\t}\n\t\t}\n\t\tif(!curURL.getURL().equals(fetchResult.getFetchedUrl())){\n\t\t\tcurURL.setDocid(docIdServer.getNewDocID(fetchResult.getFetchedUrl()));\n\t\t}\n\t\tPage page=new Page(curURL);\n\t\tif(fetchResult.fetchContent(page) && parser.parse(page,curURL.getURL())){\n\t\t\tif(parseData instanceof HtmlParseData){\n\t\t\t\tList<WebURL> toSchedule=new ArrayList<WebURL>();\n\t\t\t\tint maxCrawlDepth=myController.getConfig().getMaxDepthOfCrawling();\n\t\t\t\tfor (WebURL webURL : htmlParseData.getOutgoingUrls()){\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t} catch (Exception e){\n\t\tlogger.error(e.getMessage() + \", while processing: \" + curURL.getURL());\n\t} finally {\n\t} \n}"},{"Origin":"public PageFetchResult fetchHeader(WebURL webUrl){\n\tPageFetchResult fetchResult=new PageFetchResult();\n\tString toFetchURL=webUrl.getURL();\n\tHttpGet get=null;\n\ttry {\n\t\tget=new HttpGet(toFetchURL);\n\t\tsynchronized (mutex){\n\t\t\tlong now=(new Date()).getTime();\n\t\t\tif(now - lastFetchTime < config.getPolitenessDelay()){\n\t\t\t\tThread.sleep(config.getPolitenessDelay() - (now - lastFetchTime));\n\t\t\t}\n\t\t\tlastFetchTime=(new Date()).getTime();\n\t\t}\n\t\tget.addHeader(\"Accept-Encoding\",\"gzip\");\n\t\tHttpResponse response=httpClient.execute(get);\n\t\tfetchResult.setEntity(response.getEntity());\n\t\tint statusCode=response.getStatusLine().getStatusCode();\n\t\tif(statusCode != HttpStatus.SC_OK){\n\t\t\tif(statusCode != HttpStatus.SC_NOT_FOUND){\n\t\t\t\tif(statusCode == HttpStatus.SC_MOVED_PERMANENTLY || statusCode == HttpStatus.SC_MOVED_TEMPORARILY){\n\t\t\t\t\tHeader header=response.getFirstHeader(\"Location\");\n\t\t\t\t\tif(header != null){\n\t\t\t\t\t\tString movedToUrl=header.getValue();\n\t\t\t\t\t\tmovedToUrl=URLCanonicalizer.getCanonicalURL(movedToUrl,toFetchURL);\n\t\t\t\t\t\tfetchResult.setMovedToUrl(movedToUrl);\n\t\t\t\t\t}\n\t\t\t\t\tfetchResult.setStatusCode(statusCode);\n\t\t\t\t\treturn fetchResult;\n\t\t\t\t}\n\t\t\t\tlogger.info(\"Failed: \" + response.getStatusLine().toString() + \", while fetching \"+ toFetchURL);\n\t\t\t}\n\t\t\tfetchResult.setStatusCode(response.getStatusLine().getStatusCode());\n\t\t\treturn fetchResult;\n\t\t}\n\t\tfetchResult.setFetchedUrl(toFetchURL);\n\t\tString uri=get.getURI().toString();\n\t\tif(!uri.equals(toFetchURL)){\n\t\t\tif(!URLCanonicalizer.getCanonicalURL(uri).equals(toFetchURL)){\n\t\t\t\tfetchResult.setFetchedUrl(uri);\n\t\t\t}\n\t\t}\n\t\tif(fetchResult.getEntity() != null){\n\t\t\tlong size=fetchResult.getEntity().getContentLength();\n\t\t\tif(size == -1){\n\t\t\t\tHeader length=response.getLastHeader(\"Content-Length\");\n\t\t\t\tif(length == null){\n\t\t\t\t\tlength=response.getLastHeader(\"Content-length\");\n\t\t\t\t}\n\t\t\t\tif(length != null){\n\t\t\t\t\tsize=Integer.parseInt(length.getValue());\n\t\t\t\t} else {\n\t\t\t\t\tsize=-1;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(size > config.getMaxDownloadSize()){\n\t\t\t\tfetchResult.setStatusCode(CustomFetchStatus.PageTooBig);\n\t\t\t\treturn fetchResult;\n\t\t\t}\n\t\t\tfetchResult.setStatusCode(HttpStatus.SC_OK);\n\t\t\treturn fetchResult;\n\t\t} else {\n\t\t\tget.abort();\n\t\t}\n\t} catch (IOException e){\n\t\tlogger.error(\"Fatal transport error: \" + e.getMessage() + \" while fetching \"+ toFetchURL+ \" (link found in doc #\"+ webUrl.getParentDocid()+ \")\");\n\t\tfetchResult.setStatusCode(CustomFetchStatus.FatalTransportError);\n\t\treturn fetchResult;\n\t} catch (IllegalStateException e){\n\t} catch (Exception e){\n\t\tif(e.getMessage() == null){\n\t\t\tlogger.error(\"Error while fetching \" + webUrl.getURL());\n\t\t} else {\n\t\t\tlogger.error(e.getMessage() + \" while fetching \" + webUrl.getURL());\n\t\t}\n\t} finally {\n\t\ttry {\n\t\t\tif(fetchResult.getEntity() == null && get != null){\n\t\t\t\tget.abort();\n\t\t\t}\n\t\t} catch (Exception e){\n\t\t\te.printStackTrace();\n\t\t} \n\t} \n\tfetchResult.setStatusCode(CustomFetchStatus.UnknownError);\n\treturn fetchResult;\n}","Original_Lines":84,"Target_Lines":52,"Manual":"public PageFetchResult fetchHeader(WebURL webUrl){\n\tPageFetchResult fetchResult=new PageFetchResult();\n\tString toFetchURL=webUrl.getURL();\n\ttry {\n\t\tget=new HttpGet(toFetchURL);\n\t\tget.addHeader(\"Accept-Encoding\",\"gzip\");\n\t\tHttpResponse response=httpClient.execute(get);\n\t\tfetchResult.setEntity(response.getEntity());\n\t\tint statusCode=response.getStatusLine().getStatusCode();\n\t\tif(statusCode != HttpStatus.SC_OK){\n\t\t\tif(statusCode != HttpStatus.SC_NOT_FOUND){\n\t\t\t\tif(statusCode == HttpStatus.SC_MOVED_PERMANENTLY || statusCode == HttpStatus.SC_MOVED_TEMPORARILY){\n\t\t\t\t\tHeader header=response.getFirstHeader(\"Location\");\n\t\t\t\t\tfetchResult.setStatusCode(statusCode);\n\t\t\t\t\treturn fetchResult;\n\t\t\t\t}\n\t\t\t}\n\t\t\tfetchResult.setStatusCode(response.getStatusLine().getStatusCode());\n\t\t\treturn fetchResult;\n\t\t}\n\t\tfetchResult.setFetchedUrl(toFetchURL);\n\t\tString uri=get.getURI().toString();\n\t\tif(!uri.equals(toFetchURL)){\n\t\t\tif(!URLCanonicalizer.getCanonicalURL(uri).equals(toFetchURL)){\n\t\t\t\tfetchResult.setFetchedUrl(uri);\n\t\t\t}\n\t\t}\n\t\tif(fetchResult.getEntity() != null){\n\t\t\tlong size=fetchResult.getEntity().getContentLength();\n\t\t\tif(size == -1){\n\t\t\t}\n\t\t\tif(size > config.getMaxDownloadSize()){\n\t\t\t\tfetchResult.setStatusCode(CustomFetchStatus.PageTooBig);\n\t\t\t\treturn fetchResult;\n\t\t\t}\n\t\t\tfetchResult.setStatusCode(HttpStatus.SC_OK);\n\t\t\treturn fetchResult;\n\t\t} else {\n\t\t\tget.abort();\n\t\t}\n\t} catch (IOException e){\n\t} catch (IllegalStateException e){\n\t} catch (Exception e){\n\t} finally {\n\t\ttry {\n\t\t\tif(fetchResult.getEntity() == null && get != null){\n\t\t\t\tget.abort();\n\t\t\t}\n\t\t} catch (Exception e){\n\t\t} \n\t} \n\tfetchResult.setStatusCode(CustomFetchStatus.UnknownError);\n\treturn fetchResult;\n}","Distance":0.391304347826087,"Automatic":"public PageFetchResult fetchHeader(WebURL webUrl){\n\tPageFetchResult fetchResult=new PageFetchResult();\n\tString toFetchURL=webUrl.getURL();\n\tHttpGet get=null;\n\ttry {\n\t\tget=new HttpGet(toFetchURL);\n\t\tsynchronized (mutex){\n\t\t}\n\t\tHttpResponse response=httpClient.execute(get);\n\t\tfetchResult.setEntity(response.getEntity());\n\t\tint statusCode=response.getStatusLine().getStatusCode();\n\t\tif(statusCode != HttpStatus.SC_OK){\n\t\t\tif(statusCode != HttpStatus.SC_NOT_FOUND){\n\t\t\t\tif(statusCode == HttpStatus.SC_MOVED_PERMANENTLY || statusCode == HttpStatus.SC_MOVED_TEMPORARILY){\n\t\t\t\t\tif(header != null){\n\t\t\t\t\t\tString movedToUrl=header.getValue();\n\t\t\t\t\t\tmovedToUrl=URLCanonicalizer.getCanonicalURL(movedToUrl,toFetchURL);\n\t\t\t\t\t\tfetchResult.setMovedToUrl(movedToUrl);\n\t\t\t\t\t}\n\t\t\t\t\tfetchResult.setStatusCode(statusCode);\n\t\t\t\t\treturn fetchResult;\n\t\t\t\t}\n\t\t\t}\n\t\t\tfetchResult.setStatusCode(response.getStatusLine().getStatusCode());\n\t\t\treturn fetchResult;\n\t\t}\n\t\tfetchResult.setFetchedUrl(toFetchURL);\n\t\tString uri=get.getURI().toString();\n\t\tif(!uri.equals(toFetchURL)){\n\t\t}\n\t\tif(fetchResult.getEntity() != null){\n\t\t\tlong size=fetchResult.getEntity().getContentLength();\n\t\t\tif(size == -1){\n\t\t\t\tHeader length=response.getLastHeader(\"Content-Length\");\n\t\t\t}\n\t\t\tif(size > config.getMaxDownloadSize()){\n\t\t\t\tfetchResult.setStatusCode(CustomFetchStatus.PageTooBig);\n\t\t\t\treturn fetchResult;\n\t\t\t}\n\t\t\tfetchResult.setStatusCode(HttpStatus.SC_OK);\n\t\t\treturn fetchResult;\n\t\t} else {\n\t\t\tget.abort();\n\t\t}\n\t} catch (IOException e){\n\t\tlogger.error(\"Fatal transport error: \" + e.getMessage() + \" while fetching \"+ toFetchURL+ \" (link found in doc #\"+ webUrl.getParentDocid()+ \")\");\n\t\tfetchResult.setStatusCode(CustomFetchStatus.FatalTransportError);\n\t\treturn fetchResult;\n\t} catch (IllegalStateException e){\n\t} catch (Exception e){\n\t} finally {\n\t} \n\tfetchResult.setStatusCode(CustomFetchStatus.UnknownError);\n\treturn fetchResult;\n}"},{"Origin":"public boolean removeURL(WebURL webUrl){\n\tsynchronized (mutex){\n\t\ttry {\n\t\t\tDatabaseEntry key=new DatabaseEntry(Util.int2ByteArray(webUrl.getDocid()));\n\t\t\tCursor cursor=null;\n\t\t\tOperationStatus result;\n\t\t\tDatabaseEntry value=new DatabaseEntry();\n\t\t\tTransaction txn=env.beginTransaction(null,null);\n\t\t\ttry {\n\t\t\t\tcursor=urlsDB.openCursor(txn,null);\n\t\t\t\tresult=cursor.getSearchKey(key,value,null);\n\t\t\t\tif(result == OperationStatus.SUCCESS){\n\t\t\t\t\tresult=cursor.delete();\n\t\t\t\t\tif(result == OperationStatus.SUCCESS){\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} catch (DatabaseException e){\n\t\t\t\tif(txn != null){\n\t\t\t\t\ttxn.abort();\n\t\t\t\t\ttxn=null;\n\t\t\t\t}\n\t\t\t\tthrow e;\n\t\t\t} finally {\n\t\t\t\tif(cursor != null){\n\t\t\t\t\tcursor.close();\n\t\t\t\t}\n\t\t\t\tif(txn != null){\n\t\t\t\t\ttxn.commit();\n\t\t\t\t}\n\t\t\t} \n\t\t} catch (Exception e){\n\t\t\te.printStackTrace();\n\t\t} \n\t}\n\treturn false;\n}","Original_Lines":35,"Target_Lines":29,"Manual":"public boolean removeURL(WebURL webUrl){\n\tsynchronized (mutex){\n\t\ttry {\n\t\t\tDatabaseEntry key=new DatabaseEntry(Util.int2ByteArray(webUrl.getDocid()));\n\t\t\tCursor cursor=null;\n\t\t\tOperationStatus result;\n\t\t\tDatabaseEntry value=new DatabaseEntry();\n\t\t\tTransaction txn=env.beginTransaction(null,null);\n\t\t\ttry {\n\t\t\t\tcursor=urlsDB.openCursor(txn,null);\n\t\t\t\tresult=cursor.getSearchKey(key,value,null);\n\t\t\t\tif(result == OperationStatus.SUCCESS){\n\t\t\t\t\tresult=cursor.delete();\n\t\t\t\t\tif(result == OperationStatus.SUCCESS){\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} catch (DatabaseException e){\n\t\t\t} finally {\n\t\t\t\tif(cursor != null){\n\t\t\t\t\tcursor.close();\n\t\t\t\t}\n\t\t\t\tif(txn != null){\n\t\t\t\t\ttxn.commit();\n\t\t\t\t}\n\t\t\t} \n\t\t} catch (Exception e){\n\t\t} \n\t}\n\treturn false;\n}","Distance":0.2608695652173913,"Automatic":"public boolean removeURL(WebURL webUrl){\n\tsynchronized (mutex){\n\t\ttry {\n\t\t\tDatabaseEntry key=new DatabaseEntry(Util.int2ByteArray(webUrl.getDocid()));\n\t\t\tCursor cursor=null;\n\t\t\tOperationStatus result;\n\t\t\tDatabaseEntry value=new DatabaseEntry();\n\t\t\tTransaction txn=env.beginTransaction(null,null);\n\t\t\ttry {\n\t\t\t\tcursor=urlsDB.openCursor(txn,null);\n\t\t\t\tresult=cursor.getSearchKey(key,value,null);\n\t\t\t\tif(result == OperationStatus.SUCCESS){\n\t\t\t\t\tresult=cursor.delete();\n\t\t\t\t}\n\t\t\t} catch (DatabaseException e){\n\t\t\t\tif(txn != null){\n\t\t\t\t\ttxn.abort();\n\t\t\t\t\ttxn=null;\n\t\t\t\t}\n\t\t\t\tthrow e;\n\t\t\t} finally {\n\t\t\t\tif(cursor != null){\n\t\t\t\t\tcursor.close();\n\t\t\t\t}\n\t\t\t\tif(txn != null){\n\t\t\t\t\ttxn.commit();\n\t\t\t\t}\n\t\t\t} \n\t\t} catch (Exception e){\n\t\t} \n\t}\n\treturn false;\n}"},{"Origin":"public List<WebURL> get(int max) throws DatabaseException {\n\tsynchronized (mutex){\n\t\tint matches=0;\n\t\tList<WebURL> results=new ArrayList<WebURL>(max);\n\t\tCursor cursor=null;\n\t\tOperationStatus result;\n\t\tDatabaseEntry key=new DatabaseEntry();\n\t\tDatabaseEntry value=new DatabaseEntry();\n\t\tTransaction txn;\n\t\tif(resumable){\n\t\t\ttxn=env.beginTransaction(null,null);\n\t\t} else {\n\t\t\ttxn=null;\n\t\t}\n\t\ttry {\n\t\t\tcursor=urlsDB.openCursor(txn,null);\n\t\t\tresult=cursor.getFirst(key,value,null);\n\t\t\twhile(matches < max && result == OperationStatus.SUCCESS){\n\t\t\t\tif(value.getData().length > 0){\n\t\t\t\t\tresults.add(webURLBinding.entryToObject(value));\n\t\t\t\t\tmatches++;\n\t\t\t\t}\n\t\t\t\tresult=cursor.getNext(key,value,null);\n\t\t\t}\n\t\t} catch (DatabaseException e){\n\t\t\tif(txn != null){\n\t\t\t\ttxn.abort();\n\t\t\t\ttxn=null;\n\t\t\t}\n\t\t\tthrow e;\n\t\t} finally {\n\t\t\tif(cursor != null){\n\t\t\t\tcursor.close();\n\t\t\t}\n\t\t\tif(txn != null){\n\t\t\t\ttxn.commit();\n\t\t\t}\n\t\t} \n\t\treturn results;\n\t}\n}","Original_Lines":39,"Target_Lines":34,"Manual":"public List<WebURL> get(int max) throws DatabaseException {\n\tsynchronized (mutex){\n\t\tint matches=0;\n\t\tList<WebURL> results=new ArrayList<WebURL>(max);\n\t\tCursor cursor=null;\n\t\tOperationStatus result;\n\t\tDatabaseEntry key=new DatabaseEntry();\n\t\tDatabaseEntry value=new DatabaseEntry();\n\t\tTransaction txn;\n\t\tif(resumable){\n\t\t\ttxn=env.beginTransaction(null,null);\n\t\t} else {\n\t\t\ttxn=null;\n\t\t}\n\t\ttry {\n\t\t\tcursor=urlsDB.openCursor(txn,null);\n\t\t\tresult=cursor.getFirst(key,value,null);\n\t\t\twhile(matches < max && result == OperationStatus.SUCCESS){\n\t\t\t\tif(value.getData().length > 0){\n\t\t\t\t\tresults.add(webURLBinding.entryToObject(value));\n\t\t\t\t\tmatches++;\n\t\t\t\t}\n\t\t\t\tresult=cursor.getNext(key,value,null);\n\t\t\t}\n\t\t} catch (DatabaseException e){\n\t\t} finally {\n\t\t\tif(cursor != null){\n\t\t\t\tcursor.close();\n\t\t\t}\n\t\t\tif(txn != null){\n\t\t\t\ttxn.commit();\n\t\t\t}\n\t\t} \n\t\treturn results;\n\t}\n}","Distance":0.2222222222222222,"Automatic":"public List<WebURL> get(int max) throws DatabaseException {\n\tsynchronized (mutex){\n\t\tList<WebURL> results=new ArrayList<WebURL>(max);\n\t\tCursor cursor=null;\n\t\tOperationStatus result;\n\t\tDatabaseEntry value=new DatabaseEntry();\n\t\tTransaction txn;\n\t\tif(resumable){\n\t\t\ttxn=env.beginTransaction(null,null);\n\t\t} else {\n\t\t\ttxn=null;\n\t\t}\n\t\ttry {\n\t\t\tcursor=urlsDB.openCursor(txn,null);\n\t\t\tresult=cursor.getFirst(key,value,null);\n\t\t\twhile(matches < max && result == OperationStatus.SUCCESS){\n\t\t\t\tif(value.getData().length > 0){\n\t\t\t\t\tresults.add(webURLBinding.entryToObject(value));\n\t\t\t\t\tmatches++;\n\t\t\t\t}\n\t\t\t\tresult=cursor.getNext(key,value,null);\n\t\t\t}\n\t\t} catch (DatabaseException e){\n\t\t\tif(txn != null){\n\t\t\t\ttxn.abort();\n\t\t\t\ttxn=null;\n\t\t\t}\n\t\t} finally {\n\t\t\tif(cursor != null){\n\t\t\t\tcursor.close();\n\t\t\t}\n\t\t\tif(txn != null){\n\t\t\t\ttxn.commit();\n\t\t\t}\n\t\t} \n\t}\n}"},{"Origin":"@Override public void startElement(String uri,String localName,String qName,Attributes attributes) throws SAXException {\n\tElement element=HtmlFactory.getElement(localName);\n\tif(element == Element.A || element == Element.AREA || element == Element.LINK){\n\t\tString href=attributes.getValue(\"href\");\n\t\tif(href != null){\n\t\t\tanchorFlag=true;\n\t\t\tcurUrl=new ExtractedUrlAnchorPair();\n\t\t\tcurUrl.setHref(href);\n\t\t\toutgoingUrls.add(curUrl);\n\t\t}\n\t\treturn;\n\t}\n\tif(element == Element.IMG){\n\t\tString imgSrc=attributes.getValue(\"src\");\n\t\tif(imgSrc != null){\n\t\t\tcurUrl=new ExtractedUrlAnchorPair();\n\t\t\tcurUrl.setHref(imgSrc);\n\t\t\toutgoingUrls.add(curUrl);\n\t\t}\n\t\treturn;\n\t}\n\tif(element == Element.IFRAME || element == Element.FRAME || element == Element.EMBED){\n\t\tString src=attributes.getValue(\"src\");\n\t\tif(src != null){\n\t\t\tcurUrl=new ExtractedUrlAnchorPair();\n\t\t\tcurUrl.setHref(src);\n\t\t\toutgoingUrls.add(curUrl);\n\t\t}\n\t\treturn;\n\t}\n\tif(element == Element.BASE){\n\t\tif(base != null){\n\t\t\tString href=attributes.getValue(\"href\");\n\t\t\tif(href != null){\n\t\t\t\tbase=href;\n\t\t\t}\n\t\t}\n\t\treturn;\n\t}\n\tif(element == Element.META){\n\t\tString equiv=attributes.getValue(\"http-equiv\");\n\t\tString content=attributes.getValue(\"content\");\n\t\tif(equiv != null && content != null){\n\t\t\tequiv=equiv.toLowerCase();\n\t\t\tif(equiv.equals(\"refresh\") && (metaRefresh == null)){\n\t\t\t\tint pos=content.toLowerCase().indexOf(\"url=\");\n\t\t\t\tif(pos != -1){\n\t\t\t\t\tmetaRefresh=content.substring(pos + 4);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(equiv.equals(\"location\") && (metaLocation == null)){\n\t\t\t\tmetaLocation=content;\n\t\t\t}\n\t\t}\n\t\treturn;\n\t}\n\tif(element == Element.BODY){\n\t\tisWithinBodyElement=true;\n\t}\n}","Original_Lines":58,"Target_Lines":15,"Manual":"@Override public void startElement(String uri,String localName,String qName,Attributes attributes) throws SAXException {\n\tElement element=HtmlFactory.getElement(localName);\n\tif(element == Element.A || element == Element.AREA || element == Element.LINK){\n\t\treturn;\n\t}\n\tif(element == Element.IMG){\n\t\treturn;\n\t}\n\tif(element == Element.BASE){\n\t}\n\tif(element == Element.META){\n\t\treturn;\n\t}\n\tif(element == Element.BODY){\n\t\tisWithinBodyElement=true;\n\t}\n}","Distance":0.4666666666666667,"Automatic":"@Override public void startElement(String uri,String localName,String qName,Attributes attributes) throws SAXException {\n\tElement element=HtmlFactory.getElement(localName);\n\tif(element == Element.A || element == Element.AREA || element == Element.LINK){\n\t\treturn;\n\t}\n\tif(element == Element.IMG){\n\t\treturn;\n\t}\n\tif(element == Element.IFRAME || element == Element.FRAME || element == Element.EMBED){\n\t\treturn;\n\t}\n\tif(element == Element.META){\n\t\tString equiv=attributes.getValue(\"http-equiv\");\n\t\tString content=attributes.getValue(\"content\");\n\t\treturn;\n\t}\n}"},{"Origin":"public boolean parse(Page page,String contextURL){\n\tif(Util.hasBinaryContent(page.getContentType())){\n\t\tif(!config.isIncludeBinaryContentInCrawling()){\n\t\t\treturn false;\n\t\t} else {\n\t\t\tpage.setParseData(BinaryParseData.getInstance());\n\t\t\treturn true;\n\t\t}\n\t} else if(Util.hasPlainTextContent(page.getContentType())){\n\t\ttry {\n\t\t\tTextParseData parseData=new TextParseData();\n\t\t\tparseData.setTextContent(new String(page.getContentData(),page.getContentCharset()));\n\t\t\tpage.setParseData(parseData);\n\t\t\treturn true;\n\t\t} catch (Exception e){\n\t\t\te.printStackTrace();\n\t\t} \n\t\treturn false;\n\t}\n\tMetadata metadata=new Metadata();\n\tHtmlContentHandler contentHandler=new HtmlContentHandler();\n\tInputStream inputStream=null;\n\ttry {\n\t\tinputStream=new ByteArrayInputStream(page.getContentData());\n\t\thtmlParser.parse(inputStream,contentHandler,metadata,parseContext);\n\t} catch (Exception e){\n\t\te.printStackTrace();\n\t} finally {\n\t\ttry {\n\t\t\tif(inputStream != null){\n\t\t\t\tinputStream.close();\n\t\t\t}\n\t\t} catch (IOException e){\n\t\t\te.printStackTrace();\n\t\t} \n\t} \n\tif(page.getContentCharset() == null){\n\t\tpage.setContentCharset(metadata.get(\"Content-Encoding\"));\n\t}\n\tHtmlParseData parseData=new HtmlParseData();\n\tparseData.setText(contentHandler.getBodyText().trim());\n\tparseData.setTitle(metadata.get(Metadata.TITLE));\n\tList<WebURL> outgoingUrls=new ArrayList<WebURL>();\n\tString baseURL=contentHandler.getBaseUrl();\n\tif(baseURL != null){\n\t\tcontextURL=baseURL;\n\t}\n\tint urlCount=0;\n\tfor (ExtractedUrlAnchorPair urlAnchorPair : contentHandler.getOutgoingUrls()){\n\t\tString href=urlAnchorPair.getHref();\n\t\thref=href.trim();\n\t\tif(href.length() == 0){\n\t\t\tcontinue;\n\t\t}\n\t\tString hrefWithoutProtocol=href.toLowerCase();\n\t\tif(href.startsWith(\"http://\")){\n\t\t\threfWithoutProtocol=href.substring(7);\n\t\t}\n\t\tif(!hrefWithoutProtocol.contains(\"javascript:\") && !hrefWithoutProtocol.contains(\"@\")){\n\t\t\tString url=URLCanonicalizer.getCanonicalURL(href,contextURL);\n\t\t\tif(url != null){\n\t\t\t\tWebURL webURL=new WebURL();\n\t\t\t\twebURL.setURL(url);\n\t\t\t\twebURL.setAnchor(urlAnchorPair.getAnchor());\n\t\t\t\toutgoingUrls.add(webURL);\n\t\t\t\turlCount++;\n\t\t\t\tif(urlCount > config.getMaxOutgoingLinksToFollow()){\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tparseData.setOutgoingUrls(outgoingUrls);\n\ttry {\n\t\tif(page.getContentCharset() == null){\n\t\t\tparseData.setHtml(new String(page.getContentData()));\n\t\t} else {\n\t\t\tparseData.setHtml(new String(page.getContentData(),page.getContentCharset()));\n\t\t}\n\t} catch (UnsupportedEncodingException e){\n\t\te.printStackTrace();\n\t\treturn false;\n\t} \n\tpage.setParseData(parseData);\n\treturn true;\n}","Original_Lines":84,"Target_Lines":56,"Manual":"public boolean parse(Page page,String contextURL){\n\tMetadata metadata=new Metadata();\n\tHtmlContentHandler contentHandler=new HtmlContentHandler();\n\tInputStream inputStream=null;\n\ttry {\n\t\tinputStream=new ByteArrayInputStream(page.getContentData());\n\t\thtmlParser.parse(inputStream,contentHandler,metadata,parseContext);\n\t} catch (Exception e){\n\t} finally {\n\t\ttry {\n\t\t\tif(inputStream != null){\n\t\t\t\tinputStream.close();\n\t\t\t}\n\t\t} catch (IOException e){\n\t\t} \n\t} \n\tif(page.getContentCharset() == null){\n\t\tpage.setContentCharset(metadata.get(\"Content-Encoding\"));\n\t}\n\tHtmlParseData parseData=new HtmlParseData();\n\tparseData.setText(contentHandler.getBodyText().trim());\n\tparseData.setTitle(metadata.get(Metadata.TITLE));\n\tList<WebURL> outgoingUrls=new ArrayList<WebURL>();\n\tString baseURL=contentHandler.getBaseUrl();\n\tif(baseURL != null){\n\t\tcontextURL=baseURL;\n\t}\n\tint urlCount=0;\n\tfor (ExtractedUrlAnchorPair urlAnchorPair : contentHandler.getOutgoingUrls()){\n\t\tString href=urlAnchorPair.getHref();\n\t\thref=href.trim();\n\t\tString hrefWithoutProtocol=href.toLowerCase();\n\t\tif(href.startsWith(\"http://\")){\n\t\t\threfWithoutProtocol=href.substring(7);\n\t\t}\n\t\tif(!hrefWithoutProtocol.contains(\"javascript:\") && !hrefWithoutProtocol.contains(\"@\")){\n\t\t\tString url=URLCanonicalizer.getCanonicalURL(href,contextURL);\n\t\t\tif(url != null){\n\t\t\t\tWebURL webURL=new WebURL();\n\t\t\t\twebURL.setURL(url);\n\t\t\t\twebURL.setAnchor(urlAnchorPair.getAnchor());\n\t\t\t\toutgoingUrls.add(webURL);\n\t\t\t\turlCount++;\n\t\t\t}\n\t\t}\n\t}\n\tparseData.setOutgoingUrls(outgoingUrls);\n\ttry {\n\t\tif(page.getContentCharset() == null){\n\t\t\tparseData.setHtml(new String(page.getContentData()));\n\t\t} else {\n\t\t\tparseData.setHtml(new String(page.getContentData(),page.getContentCharset()));\n\t\t}\n\t} catch (UnsupportedEncodingException e){\n\t} \n\tpage.setParseData(parseData);\n\treturn true;\n}","Distance":0.2553191489361702,"Automatic":"public boolean parse(Page page,String contextURL){\n\tif(Util.hasBinaryContent(page.getContentType())){\n\t} else if(Util.hasPlainTextContent(page.getContentType())){\n\t\ttry {\n\t\t\tTextParseData parseData=new TextParseData();\n\t\t\tparseData.setTextContent(new String(page.getContentData(),page.getContentCharset()));\n\t\t\tpage.setParseData(parseData);\n\t\t} catch (Exception e){\n\t\t} \n\t\treturn false;\n\t}\n\tMetadata metadata=new Metadata();\n\tHtmlContentHandler contentHandler=new HtmlContentHandler();\n\tInputStream inputStream=null;\n\ttry {\n\t\tinputStream=new ByteArrayInputStream(page.getContentData());\n\t\thtmlParser.parse(inputStream,contentHandler,metadata,parseContext);\n\t} catch (Exception e){\n\t} finally {\n\t\ttry {\n\t\t\tif(inputStream != null){\n\t\t\t\tinputStream.close();\n\t\t\t}\n\t\t} catch (IOException e){\n\t\t} \n\t} \n\tif(page.getContentCharset() == null){\n\t\tpage.setContentCharset(metadata.get(\"Content-Encoding\"));\n\t}\n\tHtmlParseData parseData=new HtmlParseData();\n\tparseData.setText(contentHandler.getBodyText().trim());\n\tparseData.setTitle(metadata.get(Metadata.TITLE));\n\tList<WebURL> outgoingUrls=new ArrayList<WebURL>();\n\tString baseURL=contentHandler.getBaseUrl();\n\tif(baseURL != null){\n\t\tcontextURL=baseURL;\n\t}\n\tfor (ExtractedUrlAnchorPair urlAnchorPair : contentHandler.getOutgoingUrls()){\n\t\tString href=urlAnchorPair.getHref();\n\t\thref=href.trim();\n\t\tString hrefWithoutProtocol=href.toLowerCase();\n\t\tif(!hrefWithoutProtocol.contains(\"javascript:\") && !hrefWithoutProtocol.contains(\"@\")){\n\t\t\tString url=URLCanonicalizer.getCanonicalURL(href,contextURL);\n\t\t\tif(url != null){\n\t\t\t\tWebURL webURL=new WebURL();\n\t\t\t\twebURL.setURL(url);\n\t\t\t\twebURL.setAnchor(urlAnchorPair.getAnchor());\n\t\t\t\toutgoingUrls.add(webURL);\n\t\t\t}\n\t\t}\n\t}\n\tparseData.setOutgoingUrls(outgoingUrls);\n\ttry {\n\t\tif(page.getContentCharset() == null){\n\t\t\tparseData.setHtml(new String(page.getContentData()));\n\t\t} else {\n\t\t\tparseData.setHtml(new String(page.getContentData(),page.getContentCharset()));\n\t\t}\n\t} catch (UnsupportedEncodingException e){\n\t} \n\tpage.setParseData(parseData);\n}"},{"Origin":"public static HostDirectives parse(String content,String myUserAgent){\n\tHostDirectives directives=null;\n\tboolean inMatchingUserAgent=false;\n\tStringTokenizer st=new StringTokenizer(content,\"\\n\");\n\twhile(st.hasMoreTokens()){\n\t\tString line=st.nextToken();\n\t\tint commentIndex=line.indexOf(\"#\");\n\t\tif(commentIndex > -1){\n\t\t\tline=line.substring(0,commentIndex);\n\t\t}\n\t\tline=line.replaceAll(\"<[^>]+>\",\"\");\n\t\tline=line.trim();\n\t\tif(line.length() == 0){\n\t\t\tcontinue;\n\t\t}\n\t\tif(line.matches(PATTERNS_USERAGENT)){\n\t\t\tString ua=line.substring(PATTERNS_USERAGENT_LENGTH).trim().toLowerCase();\n\t\t\tif(ua.equals(\"*\") || ua.contains(myUserAgent)){\n\t\t\t\tinMatchingUserAgent=true;\n\t\t\t\tif(directives == null){\n\t\t\t\t\tdirectives=new HostDirectives();\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tinMatchingUserAgent=false;\n\t\t\t}\n\t\t} else if(line.matches(PATTERNS_DISALLOW)){\n\t\t\tif(!inMatchingUserAgent){\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tString path=line.substring(PATTERNS_DISALLOW_LENGTH).trim();\n\t\t\tif(path.endsWith(\"*\")){\n\t\t\t\tpath=path.substring(0,path.length() - 1);\n\t\t\t}\n\t\t\tpath=path.trim();\n\t\t\tif(path.length() > 0){\n\t\t\t\tdirectives.addDisallow(path);\n\t\t\t}\n\t\t} else if(line.matches(PATTERNS_ALLOW)){\n\t\t\tif(!inMatchingUserAgent){\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tString path=line.substring(PATTERNS_ALLOW_LENGTH).trim();\n\t\t\tif(path.endsWith(\"*\")){\n\t\t\t\tpath=path.substring(0,path.length() - 1);\n\t\t\t}\n\t\t\tpath=path.trim();\n\t\t\tdirectives.addAllow(path);\n\t\t}\n\t}\n\treturn directives;\n}","Original_Lines":49,"Target_Lines":23,"Manual":"public static HostDirectives parse(String content,String myUserAgent){\n\tHostDirectives directives=null;\n\tboolean inMatchingUserAgent=false;\n\tStringTokenizer st=new StringTokenizer(content,\"\\n\");\n\twhile(st.hasMoreTokens()){\n\t\tString line=st.nextToken();\n\t\tint commentIndex=line.indexOf(\"#\");\n\t\tif(commentIndex > -1){\n\t\t\tline=line.substring(0,commentIndex);\n\t\t}\n\t\tline=line.replaceAll(\"<[^>]+>\",\"\");\n\t\tline=line.trim();\n\t\tif(line.matches(PATTERNS_USERAGENT)){\n\t\t\tString ua=line.substring(PATTERNS_USERAGENT_LENGTH).trim().toLowerCase();\n\t\t} else if(line.matches(PATTERNS_DISALLOW)){\n\t\t\tString path=line.substring(PATTERNS_DISALLOW_LENGTH).trim();\n\t\t\tpath=path.trim();\n\t\t} else if(line.matches(PATTERNS_ALLOW)){\n\t\t\tString path=line.substring(PATTERNS_ALLOW_LENGTH).trim();\n\t\t\tpath=path.trim();\n\t\t\tdirectives.addAllow(path);\n\t\t}\n\t}\n\treturn directives;\n}","Distance":0,"Automatic":"public static HostDirectives parse(String content,String myUserAgent){\n\tHostDirectives directives=null;\n\tboolean inMatchingUserAgent=false;\n\tStringTokenizer st=new StringTokenizer(content,\"\\n\");\n\twhile(st.hasMoreTokens()){\n\t\tString line=st.nextToken();\n\t\tint commentIndex=line.indexOf(\"#\");\n\t\tif(commentIndex > -1){\n\t\t\tline=line.substring(0,commentIndex);\n\t\t}\n\t\tline=line.replaceAll(\"<[^>]+>\",\"\");\n\t\tline=line.trim();\n\t\tif(line.matches(PATTERNS_USERAGENT)){\n\t\t\tString ua=line.substring(PATTERNS_USERAGENT_LENGTH).trim().toLowerCase();\n\t\t} else if(line.matches(PATTERNS_DISALLOW)){\n\t\t\tString path=line.substring(PATTERNS_DISALLOW_LENGTH).trim();\n\t\t\tpath=path.trim();\n\t\t} else if(line.matches(PATTERNS_ALLOW)){\n\t\t\tString path=line.substring(PATTERNS_ALLOW_LENGTH).trim();\n\t\t\tpath=path.trim();\n\t\t\tdirectives.addAllow(path);\n\t\t}\n\t}\n\treturn directives;\n}"},{"Origin":"private static Url parseUrl(final String spec){\n\tfinal Url url=new Url();\n\tint startIndex=0;\n\tint endIndex=spec.length();\n\tfinal int crosshatchIndex=indexOf(spec,'#',startIndex,endIndex);\n\tif(crosshatchIndex >= 0){\n\t\turl.fragment_=spec.substring(crosshatchIndex + 1,endIndex);\n\t\tendIndex=crosshatchIndex;\n\t}\n\tfinal int colonIndex=indexOf(spec,':',startIndex,endIndex);\n\tif(colonIndex > 0){\n\t\tfinal String scheme=spec.substring(startIndex,colonIndex);\n\t\tif(isValidScheme(scheme)){\n\t\t\turl.scheme_=scheme;\n\t\t\tstartIndex=colonIndex + 1;\n\t\t}\n\t}\n\tfinal int locationStartIndex;\n\tint locationEndIndex;\n\tif(spec.startsWith(\"//\",startIndex)){\n\t\tlocationStartIndex=startIndex + 2;\n\t\tlocationEndIndex=indexOf(spec,'/',locationStartIndex,endIndex);\n\t\tif(locationEndIndex >= 0){\n\t\t\tstartIndex=locationEndIndex;\n\t\t}\n\t} else {\n\t\tlocationStartIndex=-1;\n\t\tlocationEndIndex=-1;\n\t}\n\tfinal int questionMarkIndex=indexOf(spec,'?',startIndex,endIndex);\n\tif(questionMarkIndex >= 0){\n\t\tif((locationStartIndex >= 0) && (locationEndIndex < 0)){\n\t\t\tlocationEndIndex=questionMarkIndex;\n\t\t\tstartIndex=questionMarkIndex;\n\t\t}\n\t\turl.query_=spec.substring(questionMarkIndex + 1,endIndex);\n\t\tendIndex=questionMarkIndex;\n\t}\n\tfinal int semicolonIndex=indexOf(spec,';',startIndex,endIndex);\n\tif(semicolonIndex >= 0){\n\t\tif((locationStartIndex >= 0) && (locationEndIndex < 0)){\n\t\t\tlocationEndIndex=semicolonIndex;\n\t\t\tstartIndex=semicolonIndex;\n\t\t}\n\t\turl.parameters_=spec.substring(semicolonIndex + 1,endIndex);\n\t\tendIndex=semicolonIndex;\n\t}\n\tif((locationStartIndex >= 0) && (locationEndIndex < 0)){\n\t\tlocationEndIndex=endIndex;\n\t} else if(startIndex < endIndex){\n\t\turl.path_=spec.substring(startIndex,endIndex);\n\t}\n\tif((locationStartIndex >= 0) && (locationEndIndex >= 0)){\n\t\turl.location_=spec.substring(locationStartIndex,locationEndIndex);\n\t}\n\treturn url;\n}","Original_Lines":55,"Target_Lines":29,"Manual":"private static Url parseUrl(final String spec){\n\tfinal Url url=new Url();\n\tint startIndex=0;\n\tint endIndex=spec.length();\n\tfinal int crosshatchIndex=indexOf(spec,'#',startIndex,endIndex);\n\tif(crosshatchIndex >= 0){\n\t}\n\tfinal int colonIndex=indexOf(spec,':',startIndex,endIndex);\n\tif(colonIndex > 0){\n\t}\n\tfinal int locationStartIndex;\n\tint locationEndIndex;\n\tif(spec.startsWith(\"//\",startIndex)){\n\t} else {\n\t}\n\tfinal int questionMarkIndex=indexOf(spec,'?',startIndex,endIndex);\n\tif(questionMarkIndex >= 0){\n\t}\n\tfinal int semicolonIndex=indexOf(spec,';',startIndex,endIndex);\n\tif(semicolonIndex >= 0){\n\t}\n\tif((locationStartIndex >= 0) && (locationEndIndex < 0)){\n\t\tlocationEndIndex=endIndex;\n\t} else if(startIndex < endIndex){\n\t\turl.path_=spec.substring(startIndex,endIndex);\n\t}\n\tif((locationStartIndex >= 0) && (locationEndIndex >= 0)){\n\t\turl.location_=spec.substring(locationStartIndex,locationEndIndex);\n\t}\n\treturn url;\n}","Distance":0.3333333333333333,"Automatic":"private static Url parseUrl(final String spec){\n\tfinal Url url=new Url();\n\tint startIndex=0;\n\tint endIndex=spec.length();\n\tfinal int crosshatchIndex=indexOf(spec,'#',startIndex,endIndex);\n\tif(crosshatchIndex >= 0){\n\t\turl.fragment_=spec.substring(crosshatchIndex + 1,endIndex);\n\t\tendIndex=crosshatchIndex;\n\t}\n\tfinal int colonIndex=indexOf(spec,':',startIndex,endIndex);\n\tif(colonIndex > 0){\n\t\tfinal String scheme=spec.substring(startIndex,colonIndex);\n\t}\n\tfinal int locationStartIndex;\n\tint locationEndIndex;\n\tfinal int questionMarkIndex=indexOf(spec,'?',startIndex,endIndex);\n\tif(questionMarkIndex >= 0){\n\t\turl.query_=spec.substring(questionMarkIndex + 1,endIndex);\n\t}\n\tfinal int semicolonIndex=indexOf(spec,';',startIndex,endIndex);\n\tif(semicolonIndex >= 0){\n\t\turl.parameters_=spec.substring(semicolonIndex + 1,endIndex);\n\t\tendIndex=semicolonIndex;\n\t}\n\tif((locationStartIndex >= 0) && (locationEndIndex < 0)){\n\t\tlocationEndIndex=endIndex;\n\t} else if(startIndex < endIndex){\n\t\turl.path_=spec.substring(startIndex,endIndex);\n\t}\n\treturn url;\n}"},{"Origin":"public static void sort(final String[] array,final Comparator<String> c,final int lo,final int hi){\n\tfinal int m=(lo + hi) / 2;\n\tfinal String x=array[m];\n\tint i=lo;\n\tint j=hi;\n\tdo{\n\t\twhile(c.compare(x,array[i]) > 0){\n\t\t\ti++;\n\t\t}\n\t\twhile(c.compare(x,array[j]) < 0){\n\t\t\tj--;\n\t\t}\n\t\tif(i <= j){\n\t\t\tfinal String s=array[i];\n\t\t\tarray[i]=array[j];\n\t\t\tarray[j]=s;\n\t\t\ti++;\n\t\t\tj--;\n\t\t}\n\t}while(i <= j)\n\tif(lo < j){\n\t\tsort(array,c,lo,j);\n\t}\n\tif(i < hi){\n\t\tsort(array,c,i,hi);\n\t}\n}","Original_Lines":25,"Target_Lines":20,"Manual":"public static void sort(final String[] array,final Comparator<String> c,final int lo,final int hi){\n\tfinal int m=(lo + hi) / 2;\n\tfinal String x=array[m];\n\tint i=lo;\n\tint j=hi;\n\tdo{\n\t\twhile(c.compare(x,array[i]) > 0){\n\t\t\ti++;\n\t\t}\n\t\twhile(c.compare(x,array[j]) < 0){\n\t\t\tj--;\n\t\t}\n\t\tif(i <= j){\n\t\t}\n\t}while(i <= j)\n\tif(lo < j){\n\t\tsort(array,c,lo,j);\n\t}\n\tif(i < hi){\n\t\tsort(array,c,i,hi);\n\t}\n}","Distance":0.29411764705882354,"Automatic":"public static void sort(final String[] array,final Comparator<String> c,final int lo,final int hi){\n\tfinal int m=(lo + hi) / 2;\n\tfinal String x=array[m];\n\tint i=lo;\n\tint j=hi;\n\tdo{\n\t\twhile(c.compare(x,array[i]) > 0){\n\t\t\ti++;\n\t\t}\n\t\twhile(c.compare(x,array[j]) < 0){\n\t\t\tj--;\n\t\t}\n\t\tif(i <= j){\n\t\t\tfinal String s=array[i];\n\t\t\tarray[i]=array[j];\n\t\t\tarray[j]=s;\n\t\t}\n\t}while(i <= j)\n\tif(lo < j){\n\t\tsort(array,c,lo,j);\n\t}\n}"},{"Origin":"public void processDocument(BufferedReader document) throws IOException {\n\tQueue<String> prevWords=new ArrayDeque<String>();\n\tQueue<String> nextWords=new ArrayDeque<String>();\n\tIterator<String> it=IteratorFactory.tokenizeOrdered(document);\n\tMap<String,DoubleVector> documentVectors=new HashMap<String,DoubleVector>();\n\tfor (int i=0; i < nextSize && it.hasNext(); ++i)\n\t\tnextWords.offer(it.next().intern());\n\tprevWords.offer(IteratorFactory.EMPTY_TOKEN);\n\tString focusWord=null;\n\twhile(!nextWords.isEmpty()){\n\t\tfocusWord=nextWords.remove();\n\t\tif(it.hasNext())\n\t\t\tnextWords.offer(it.next().intern());\n\t\tif(!focusWord.equals(IteratorFactory.EMPTY_TOKEN)){\n\t\t\tDoubleVector meaning=termHolographs.get(focusWord);\n\t\t\tif(meaning == null){\n\t\t\t\tmeaning=new DenseVector(indexVectorSize);\n\t\t\t\tdocumentVectors.put(focusWord,meaning);\n\t\t\t}\n\t\t\tupdateMeaning(meaning,prevWords,nextWords);\n\t\t}\n\t\tprevWords.offer(focusWord);\n\t\tif(prevWords.size() > 1)\n\t\t\tprevWords.remove();\n\t}\n\tfor (Map.Entry<String,DoubleVector> entry : documentVectors.entrySet()){\n\t\tsynchronized (entry.getKey()){\n\t\t\tDoubleVector existingVector=termHolographs.get(entry.getKey());\n\t\t\tif(existingVector == null)\n\t\t\t\ttermHolographs.put(entry.getKey(),entry.getValue());\n\t\t\telse \n\t\t\t\tVectorMath.add(existingVector,entry.getValue());\n\t\t}\n\t}\n}","Original_Lines":33,"Target_Lines":31,"Manual":"public void processDocument(BufferedReader document) throws IOException {\n\tQueue<String> prevWords=new ArrayDeque<String>();\n\tQueue<String> nextWords=new ArrayDeque<String>();\n\tIterator<String> it=IteratorFactory.tokenizeOrdered(document);\n\tMap<String,DoubleVector> documentVectors=new HashMap<String,DoubleVector>();\n\tprevWords.offer(IteratorFactory.EMPTY_TOKEN);\n\tString focusWord=null;\n\twhile(!nextWords.isEmpty()){\n\t\tfocusWord=nextWords.remove();\n\t\tif(it.hasNext())\n\t\t\tnextWords.offer(it.next().intern());\n\t\tif(!focusWord.equals(IteratorFactory.EMPTY_TOKEN)){\n\t\t\tDoubleVector meaning=termHolographs.get(focusWord);\n\t\t\tif(meaning == null){\n\t\t\t\tmeaning=new DenseVector(indexVectorSize);\n\t\t\t\tdocumentVectors.put(focusWord,meaning);\n\t\t\t}\n\t\t\tupdateMeaning(meaning,prevWords,nextWords);\n\t\t}\n\t\tprevWords.offer(focusWord);\n\t\tif(prevWords.size() > 1)\n\t\t\tprevWords.remove();\n\t}\n\tfor (Map.Entry<String,DoubleVector> entry : documentVectors.entrySet()){\n\t\tsynchronized (entry.getKey()){\n\t\t\tDoubleVector existingVector=termHolographs.get(entry.getKey());\n\t\t\tif(existingVector == null)\n\t\t\t\ttermHolographs.put(entry.getKey(),entry.getValue());\n\t\t\telse \n\t\t\t\tVectorMath.add(existingVector,entry.getValue());\n\t\t}\n\t}\n}","Distance":0.07692307692307693,"Automatic":"public void processDocument(BufferedReader document) throws IOException {\n\tQueue<String> prevWords=new ArrayDeque<String>();\n\tQueue<String> nextWords=new ArrayDeque<String>();\n\tIterator<String> it=IteratorFactory.tokenizeOrdered(document);\n\tfor (int i=0; i < nextSize && it.hasNext(); ++i)\n\tprevWords.offer(IteratorFactory.EMPTY_TOKEN);\n\tString focusWord=null;\n\twhile(!nextWords.isEmpty()){\n\t\tfocusWord=nextWords.remove();\n\t\tif(it.hasNext())\n\t\t\tnextWords.offer(it.next().intern());\n\t\tif(!focusWord.equals(IteratorFactory.EMPTY_TOKEN)){\n\t\t\tDoubleVector meaning=termHolographs.get(focusWord);\n\t\t\tif(meaning == null){\n\t\t\t\tmeaning=new DenseVector(indexVectorSize);\n\t\t\t\tdocumentVectors.put(focusWord,meaning);\n\t\t\t}\n\t\t\tupdateMeaning(meaning,prevWords,nextWords);\n\t\t}\n\t\tprevWords.offer(focusWord);\n\t\tif(prevWords.size() > 1)\n\t\t\tprevWords.remove();\n\t}\n\tfor (Map.Entry<String,DoubleVector> entry : documentVectors.entrySet()){\n\t\tsynchronized (entry.getKey()){\n\t\t\tDoubleVector existingVector=termHolographs.get(entry.getKey());\n\t\t\tif(existingVector == null)\n\t\t\t\ttermHolographs.put(entry.getKey(),entry.getValue());\n\t\t\telse \n\t\t\t\tVectorMath.add(existingVector,entry.getValue());\n\t\t}\n\t}\n}"},{"Origin":"public Assignment[] cluster(Matrix m,int numClusters,Properties props){\n\tint startSize=Integer.parseInt(props.getProperty(NUM_CLUSTERS_START,DEFAULT_NUM_CLUSTERS_START));\n\tint numIterations=numClusters - startSize;\n\tMeasure measure=Measure.valueOf(props.getProperty(CLUSTERING_METHOD,DEFAULT_CLUSTERING_METHOD));\n\tdouble pk1Threshold=Double.parseDouble(props.getProperty(PK1_THRESHOLD,DEFAULT_PK1_THRESHOLD));\n\tFile matrixFile=null;\n\ttry {\n\t\tmatrixFile=File.createTempFile(\"cluto-input\",\".matrix\");\n\t\tMatrixIO.writeMatrix(m,matrixFile,Format.CLUTO_DENSE);\n\t} catch (IOException ioe){\n\t\tthrow new IOError(ioe);\n\t} \n\tdouble[] objectiveWeights=new double[numIterations];\n\tFile[] outFiles=new File[numIterations];\n\tString result=null;\n\tfor (int i=0; i < numIterations; ++i){\n\t\tLOGGER.fine(\"Clustering with \" + (startSize + i) + \" clusters\");\n\t\ttry {\n\t\t\toutFiles[i]=File.createTempFile(\"autostop-clustering-out\",\".matrix\");\n\t\t\tresult=ClutoWrapper.cluster(null,matrixFile,METHOD.getClutoName(),CRITERION.getClutoName(),outFiles[i],i + startSize);\n\t\t\tobjectiveWeights[i]=extractScore(result);\n\t\t} catch (IOException ioe){\n\t\t\tthrow new IOError(ioe);\n\t\t} \n\t}\n\tint bestK=-1;\n\tswitch (measure){\n\tcase PK1: \n\t\tbestK=computePk1Measure(objectiveWeights,pk1Threshold);\n\t\tbreak;\n\tcase PK2: \n\t\tbestK=computePk2Measure(objectiveWeights);\n\t\tbreak;\n\tcase PK3: \n\t\tbestK=computePk3Measure(objectiveWeights);\n\t\tbreak;\n\t}\n\tAssignment[] assignments=new HardAssignment[m.rows()];\n\ttry {\n\t\tClutoWrapper.extractAssignments(outFiles[bestK],assignments);\n\t} catch (IOException ioe){\n\t\tthrow new IOError(ioe);\n\t} \n\tmatrixFile.delete();\n\tfor (File outFile : outFiles)\n\t\toutFile.delete();\n\n\treturn assignments;\n}","Original_Lines":47,"Target_Lines":20,"Manual":"public Assignment[] cluster(Matrix m,int numClusters,Properties props){\n\tdouble pk1Threshold=Double.parseDouble(props.getProperty(PK1_THRESHOLD,DEFAULT_PK1_THRESHOLD));\n\tdouble[] objectiveWeights=new double[numIterations];\n\tint bestK=-1;\n\tswitch (measure){\n\tcase PK1: \n\t\tbestK=computePk1Measure(objectiveWeights,pk1Threshold);\n\t\tbreak;\n\tcase PK2: \n\t\tbestK=computePk2Measure(objectiveWeights);\n\t\tbreak;\n\tcase PK3: \n\t\tbestK=computePk3Measure(objectiveWeights);\n\t\tbreak;\n\t}\n\tAssignment[] assignments=new HardAssignment[m.rows()];\n\ttry {\n\t\tClutoWrapper.extractAssignments(outFiles[bestK],assignments);\n\t} catch (IOException ioe){\n\t} \n\treturn assignments;\n}","Distance":0.625,"Automatic":"public Assignment[] cluster(Matrix m,int numClusters,Properties props){\n\tdouble pk1Threshold=Double.parseDouble(props.getProperty(PK1_THRESHOLD,DEFAULT_PK1_THRESHOLD));\n\ttry {\n\t\tMatrixIO.writeMatrix(m,matrixFile,Format.CLUTO_DENSE);\n\t} catch (IOException ioe){\n\t} \n\tfor (int i=0; i < numIterations; ++i){\n\t\ttry {\n\t\t\toutFiles[i]=File.createTempFile(\"autostop-clustering-out\",\".matrix\");\n\t\t\tresult=ClutoWrapper.cluster(null,matrixFile,METHOD.getClutoName(),CRITERION.getClutoName(),outFiles[i],i + startSize);\n\t\t\tobjectiveWeights[i]=extractScore(result);\n\t\t} catch (IOException ioe){\n\t\t} \n\t}\n\tint bestK=-1;\n\tswitch (measure){\n\tcase PK1: \n\t\tbestK=computePk1Measure(objectiveWeights,pk1Threshold);\n\tcase PK2: \n\tcase PK3: \n\t}\n\tAssignment[] assignments=new HardAssignment[m.rows()];\n\treturn assignments;\n}"},{"Origin":"public static String cluster(Assignment[] clusterAssignment,File matrixFile,String clmethod,String crtFun,File outputFile,int numClusters) throws IOException {\n\tString commandLine=\"vcluster \" + \"-clmethod=\" + clmethod + \" \"+ \"-clustfile=\"+ outputFile+ \" \"+ \"-crfun=\"+ crtFun+ \" \"+ matrixFile+ \" \"+ numClusters;\n\tLOGGER.fine(\"executing: \" + commandLine);\n\tProcess cluto=Runtime.getRuntime().exec(commandLine);\n\tBufferedReader stdout=new BufferedReader(new InputStreamReader(cluto.getInputStream()));\n\tBufferedReader stderr=new BufferedReader(new InputStreamReader(cluto.getErrorStream()));\n\tString clutoOutput=null;\n\tStringBuilder output=new StringBuilder(\"Cluto output:\\n\");\n\tfor (String line=null; (line=stdout.readLine()) != null; )\n\t\toutput.append(line).append(\"\\n\");\n\tclutoOutput=output.toString();\n\tif(LOGGER.isLoggable(Level.FINE))\n\t\tLOGGER.fine(clutoOutput);\n\tint exitStatus=0;\n\ttry {\n\t\texitStatus=cluto.waitFor();\n\t} catch (InterruptedException ie){\n\t\tLOGGER.log(Level.SEVERE,\"Cluto\",ie);\n\t} \n\tLOGGER.finer(\"Cluto exit status: \" + exitStatus);\n\tif(exitStatus == 0 && clusterAssignment != null)\n\t\textractAssignments(outputFile,clusterAssignment);\n\telse if(exitStatus != 0){\n\t\tStringBuilder sb=new StringBuilder();\n\t\tfor (String line=null; (line=stderr.readLine()) != null; )\n\t\t\tsb.append(line).append(\"\\n\");\n\t\tLOGGER.warning(\"Cluto exited with error status.  \" + exitStatus + \" stderr:\\n\"+ sb.toString());\n\t\tthrow new Error(\"Clustering failed\");\n\t}\n\tstdout.close();\n\tstderr.close();\n\treturn clutoOutput;\n}","Original_Lines":31,"Target_Lines":10,"Manual":"public static String cluster(Assignment[] clusterAssignment,File matrixFile,String clmethod,String crtFun,File outputFile,int numClusters) throws IOException {\n\tint exitStatus=0;\n\ttry {\n\t\texitStatus=cluto.waitFor();\n\t} catch (InterruptedException ie){\n\t} \n\tif(exitStatus == 0 && clusterAssignment != null)\n\t\textractAssignments(outputFile,clusterAssignment);\n\telse if(exitStatus != 0){\n\t}\n\treturn clutoOutput;\n}","Distance":0.3333333333333333,"Automatic":"public static String cluster(Assignment[] clusterAssignment,File matrixFile,String clmethod,String crtFun,File outputFile,int numClusters) throws IOException {\n\tint exitStatus=0;\n\ttry {\n\t\texitStatus=cluto.waitFor();\n\t} catch (InterruptedException ie){\n\t\tLOGGER.log(Level.SEVERE,\"Cluto\",ie);\n\t} \n\tif(exitStatus == 0 && clusterAssignment != null)\n\t\textractAssignments(outputFile,clusterAssignment);\n\telse if(exitStatus != 0){\n\t\tStringBuilder sb=new StringBuilder();\n\t}\n}"},{"Origin":"public Assignment[] cluster(Matrix matrix,Properties props){\n\tString minSimProp=props.getProperty(MIN_CLUSTER_SIMILARITY_PROPERTY);\n\tString numClustProp=props.getProperty(NUM_CLUSTERS_PROPERTY);\n\tString simFuncProp=props.getProperty(SIMILARITY_FUNCTION_PROPERTY);\n\tString linkageProp=props.getProperty(CLUSTER_LINKAGE_PROPERTY);\n\tSimType simFunc=SimType.valueOf((simFuncProp == null) ? DEFAULT_SIMILARITY_FUNCTION_PROPERTY : simFuncProp);\n\tClusterLinkage linkage=ClusterLinkage.valueOf((linkageProp == null) ? DEFAULT_CLUSTER_LINKAGE_PROPERTY : linkageProp);\n\tif(minSimProp == null && numClustProp == null)\n\t\tthrow new IllegalArgumentException(\"This class requires either a specified number of clusters or \" + \"a minimum cluster similarity threshold in order to partition \" + \"throw rows of the input.  Either needs to be provided as a \"+ \"property\");\n\telse if(minSimProp != null && numClustProp != null)\n\t\tthrow new IllegalArgumentException(\"Cannot specify both a fixed number of clusters AND a minimum \" + \"cluster similarity as input properties\");\n\telse if(minSimProp != null){\n\t\ttry {\n\t\t\tdouble clusterSimThresh=Double.parseDouble(minSimProp);\n\t\t\treturn toAssignments(cluster(matrix,clusterSimThresh,linkage,simFunc,-1));\n\t\t} catch (NumberFormatException nfe){\n\t\t\tthrow new IllegalArgumentException(\"Cluster similarity threshold was not a valid double: \" + minSimProp);\n\t\t} \n\t} else {\n\t\treturn cluster(matrix,-1,props);\n\t}\n}","Original_Lines":20,"Target_Lines":17,"Manual":"public Assignment[] cluster(Matrix matrix,Properties props){\n\tString minSimProp=props.getProperty(MIN_CLUSTER_SIMILARITY_PROPERTY);\n\tString numClustProp=props.getProperty(NUM_CLUSTERS_PROPERTY);\n\tString simFuncProp=props.getProperty(SIMILARITY_FUNCTION_PROPERTY);\n\tString linkageProp=props.getProperty(CLUSTER_LINKAGE_PROPERTY);\n\tSimType simFunc=SimType.valueOf((simFuncProp == null) ? DEFAULT_SIMILARITY_FUNCTION_PROPERTY : simFuncProp);\n\tClusterLinkage linkage=ClusterLinkage.valueOf((linkageProp == null) ? DEFAULT_CLUSTER_LINKAGE_PROPERTY : linkageProp);\n\tif(minSimProp == null && numClustProp == null)\n\telse if(minSimProp != null && numClustProp != null)\n\telse if(minSimProp != null){\n\t\ttry {\n\t\t\tdouble clusterSimThresh=Double.parseDouble(minSimProp);\n\t\t\treturn toAssignments(cluster(matrix,clusterSimThresh,linkage,simFunc,-1));\n\t\t} catch (NumberFormatException nfe){\n\t\t} \n\t} else {\n\t\treturn cluster(matrix,-1,props);\n\t}\n}","Distance":0.07142857142857142,"Automatic":"public Assignment[] cluster(Matrix matrix,Properties props){\n\tString minSimProp=props.getProperty(MIN_CLUSTER_SIMILARITY_PROPERTY);\n\tString numClustProp=props.getProperty(NUM_CLUSTERS_PROPERTY);\n\tString simFuncProp=props.getProperty(SIMILARITY_FUNCTION_PROPERTY);\n\tString linkageProp=props.getProperty(CLUSTER_LINKAGE_PROPERTY);\n\tSimType simFunc=SimType.valueOf((simFuncProp == null) ? DEFAULT_SIMILARITY_FUNCTION_PROPERTY : simFuncProp);\n\tClusterLinkage linkage=ClusterLinkage.valueOf((linkageProp == null) ? DEFAULT_CLUSTER_LINKAGE_PROPERTY : linkageProp);\n\tif(minSimProp == null && numClustProp == null)\n\telse if(minSimProp != null && numClustProp != null)\n\telse if(minSimProp != null){\n\t\ttry {\n\t\t\tdouble clusterSimThresh=Double.parseDouble(minSimProp);\n\t\t\treturn toAssignments(cluster(matrix,clusterSimThresh,linkage,simFunc,-1));\n\t\t} catch (NumberFormatException nfe){\n\t\t\tthrow new IllegalArgumentException(\"Cluster similarity threshold was not a valid double: \" + minSimProp);\n\t\t} \n\t} else {\n\t\treturn cluster(matrix,-1,props);\n\t}\n}"},{"Origin":"private static int[] cluster(Matrix m,double clusterSimilarityThreshold,ClusterLinkage linkage,SimType similarityFunction,int maxNumberOfClusters){\n\tint rows=m.rows();\n\tLOGGER.info(\"Generating similarity matrix for \" + rows + \" data points\");\n\tMatrix similarityMatrix=computeSimilarityMatrix(m,similarityFunction);\n\tMap<Integer,Set<Integer>> clusterAssignment=generateInitialAssignment(rows);\n\tLOGGER.info(\"Calculating initial inter-cluster similarity using \" + linkage);\n\tMap<Integer,Pairing> clusterSimilarities=new HashMap<Integer,Pairing>();\n\tfor (Integer clusterId : clusterAssignment.keySet()){\n\t\tclusterSimilarities.put(clusterId,findMostSimilar(clusterAssignment,clusterId,linkage,similarityMatrix));\n\t}\n\tLOGGER.info(\"Assigning clusters\");\n\tint nextClusterId=rows;\n\twhile(clusterAssignment.size() > maxNumberOfClusters){\n\t\tint cluster1index=0;\n\t\tint cluster2index=0;\n\t\tdouble highestSimilarity=-1;\n\t\tfor (Map.Entry<Integer,Pairing> e : clusterSimilarities.entrySet()){\n\t\t\tPairing p=e.getValue();\n\t\t\tInteger i=e.getKey();\n\t\t\tInteger j=p.pairedIndex;\n\t\t\tif(p.similarity > highestSimilarity){\n\t\t\t\tcluster1index=i;\n\t\t\t\tcluster2index=j;\n\t\t\t\thighestSimilarity=p.similarity;\n\t\t\t}\n\t\t}\n\t\tif(maxNumberOfClusters < 1 && highestSimilarity < clusterSimilarityThreshold)\n\t\t\tbreak;\n\t\tint newClusterId=nextClusterId++;\n\t\tSet<Integer> cluster1=clusterAssignment.get(cluster1index);\n\t\tSet<Integer> cluster2=clusterAssignment.get(cluster2index);\n\t\tLOGGER.log(Level.FINE,\"Merged cluster {0} with {1}\",new Object[]{cluster1,cluster2});\n\t\tcluster1.addAll(cluster2);\n\t\tclusterAssignment.put(newClusterId,cluster1);\n\t\tclusterAssignment.remove(cluster1index);\n\t\tclusterAssignment.remove(cluster2index);\n\t\tclusterSimilarities.remove(cluster1index);\n\t\tclusterSimilarities.remove(cluster2index);\n\t\tdouble mostSimilarToMerged=-1;\n\t\tInteger mostSimilarToMergedId=null;\n\t\tif(clusterSimilarities.isEmpty())\n\t\t\tbreak;\n\t\tfor (Map.Entry<Integer,Pairing> e : clusterSimilarities.entrySet()){\n\t\t\tInteger clusterId=e.getKey();\n\t\t\tdouble simToNewCluster=getSimilarity(similarityMatrix,cluster1,clusterAssignment.get(clusterId),linkage);\n\t\t\tif(simToNewCluster > mostSimilarToMerged){\n\t\t\t\tmostSimilarToMerged=simToNewCluster;\n\t\t\t\tmostSimilarToMergedId=clusterId;\n\t\t\t}\n\t\t\tPairing p=e.getValue();\n\t\t\tif(p.pairedIndex == cluster1index || p.pairedIndex == cluster2index){\n\t\t\t\te.setValue(findMostSimilar(clusterAssignment,clusterId,linkage,similarityMatrix));\n\t\t\t}\n\t\t}\n\t\tclusterSimilarities.put(newClusterId,new Pairing(mostSimilarToMerged,mostSimilarToMergedId));\n\t}\n\treturn toAssignArray(clusterAssignment,rows);\n}","Original_Lines":56,"Target_Lines":28,"Manual":"private static int[] cluster(Matrix m,double clusterSimilarityThreshold,ClusterLinkage linkage,SimType similarityFunction,int maxNumberOfClusters){\n\tint rows=m.rows();\n\tMatrix similarityMatrix=computeSimilarityMatrix(m,similarityFunction);\n\tMap<Integer,Set<Integer>> clusterAssignment=generateInitialAssignment(rows);\n\tMap<Integer,Pairing> clusterSimilarities=new HashMap<Integer,Pairing>();\n\tint nextClusterId=rows;\n\twhile(clusterAssignment.size() > maxNumberOfClusters){\n\t\tint cluster1index=0;\n\t\tint cluster2index=0;\n\t\tfor (Map.Entry<Integer,Pairing> e : clusterSimilarities.entrySet()){\n\t\t\tPairing p=e.getValue();\n\t\t\tInteger i=e.getKey();\n\t\t\tInteger j=p.pairedIndex;\n\t\t\tif(p.similarity > highestSimilarity){\n\t\t\t\tcluster1index=i;\n\t\t\t\tcluster2index=j;\n\t\t\t\thighestSimilarity=p.similarity;\n\t\t\t}\n\t\t}\n\t\tint newClusterId=nextClusterId++;\n\t\tSet<Integer> cluster1=clusterAssignment.get(cluster1index);\n\t\tSet<Integer> cluster2=clusterAssignment.get(cluster2index);\n\t\tcluster1.addAll(cluster2);\n\t\tfor (Map.Entry<Integer,Pairing> e : clusterSimilarities.entrySet()){\n\t\t\tInteger clusterId=e.getKey();\n\t\t\tdouble simToNewCluster=getSimilarity(similarityMatrix,cluster1,clusterAssignment.get(clusterId),linkage);\n\t\t}\n\t}\n\treturn toAssignArray(clusterAssignment,rows);\n}","Distance":0.45161290322580644,"Automatic":"private static int[] cluster(Matrix m,double clusterSimilarityThreshold,ClusterLinkage linkage,SimType similarityFunction,int maxNumberOfClusters){\n\tint rows=m.rows();\n\tMap<Integer,Set<Integer>> clusterAssignment=generateInitialAssignment(rows);\n\tMap<Integer,Pairing> clusterSimilarities=new HashMap<Integer,Pairing>();\n\twhile(clusterAssignment.size() > maxNumberOfClusters){\n\t\tint cluster1index=0;\n\t\tint cluster2index=0;\n\t\tfor (Map.Entry<Integer,Pairing> e : clusterSimilarities.entrySet()){\n\t\t\tPairing p=e.getValue();\n\t\t\tInteger j=p.pairedIndex;\n\t\t}\n\t\tif(maxNumberOfClusters < 1 && highestSimilarity < clusterSimilarityThreshold)\n\t\tint newClusterId=nextClusterId++;\n\t\tSet<Integer> cluster1=clusterAssignment.get(cluster1index);\n\t\tSet<Integer> cluster2=clusterAssignment.get(cluster2index);\n\t\tLOGGER.log(Level.FINE,\"Merged cluster {0} with {1}\",new Object[]{cluster1,cluster2});\n\t\tcluster1.addAll(cluster2);\n\t\tclusterAssignment.put(newClusterId,cluster1);\n\t\tclusterAssignment.remove(cluster1index);\n\t\tclusterAssignment.remove(cluster2index);\n\t\tif(clusterSimilarities.isEmpty())\n\t\tfor (Map.Entry<Integer,Pairing> e : clusterSimilarities.entrySet()){\n\t\t\tInteger clusterId=e.getKey();\n\t\t\tdouble simToNewCluster=getSimilarity(similarityMatrix,cluster1,clusterAssignment.get(clusterId),linkage);\n\t\t\tif(p.pairedIndex == cluster1index || p.pairedIndex == cluster2index){\n\t\t\t}\n\t\t}\n\t}\n\treturn toAssignArray(clusterAssignment,rows);\n}"},{"Origin":"private String describeImpl(Session session) throws Exception {\n\tStringBuffer sb;\n\tsb=new StringBuffer();\n\tswitch (type){\n\tcase SELECT:  {\n\t\tsb.append(select.describe(session));\n\t\tappendParms(sb).append('\\n');\n\t\tappendSubqueries(sb);\n\t\treturn sb.toString();\n\t}\n\tcase INSERT_VALUES:  {\n\t\tsb.append(\"INSERT VALUES\");\n\t\tsb.append('[').append('\\n');\n\t\tappendColumns(sb).append('\\n');\n\t\tappendTable(sb).append('\\n');\n\t\tappendParms(sb).append('\\n');\n\t\tappendSubqueries(sb).append(']');\n\t\treturn sb.toString();\n\t}\n\tcase INSERT_SELECT:  {\n\t\tsb.append(\"INSERT SELECT\");\n\t\tsb.append('[').append('\\n');\n\t\tappendColumns(sb).append('\\n');\n\t\tappendTable(sb).append('\\n');\n\t\tsb.append(select.describe(session)).append('\\n');\n\t\tappendParms(sb).append('\\n');\n\t\tappendSubqueries(sb).append(']');\n\t\treturn sb.toString();\n\t}\n\tcase UPDATE:  {\n\t\tsb.append(\"UPDATE\");\n\t\tsb.append('[').append('\\n');\n\t\tappendColumns(sb).append('\\n');\n\t\tappendTable(sb).append('\\n');\n\t\tappendCondition(session,sb);\n\t\tsb.append(targetFilter.describe(session)).append('\\n');\n\t\tappendParms(sb).append('\\n');\n\t\tappendSubqueries(sb).append(']');\n\t\treturn sb.toString();\n\t}\n\tcase DELETE:  {\n\t\tsb.append(\"DELETE\");\n\t\tsb.append('[').append('\\n');\n\t\tappendTable(sb).append('\\n');\n\t\tappendCondition(session,sb);\n\t\tsb.append(targetFilter.describe(session)).append('\\n');\n\t\tappendParms(sb).append('\\n');\n\t\tappendSubqueries(sb).append(']');\n\t\treturn sb.toString();\n\t}\n\tcase CALL:  {\n\t\tsb.append(\"CALL\");\n\t\tsb.append('[');\n\t\tsb.append(expression.describe(session)).append('\\n');\n\t\tappendParms(sb).append('\\n');\n\t\tappendSubqueries(sb).append(']');\n\t\treturn sb.toString();\n\t}\n\tdefault: {\n\t\treturn \"UNKNOWN\";\n\t}\n\t}\n}","Original_Lines":61,"Target_Lines":23,"Manual":"private String describeImpl(Session session) throws Exception {\n\tStringBuffer sb;\n\tsb=new StringBuffer();\n\tswitch (type){\n\tcase SELECT:  {\n\t\tsb.append(select.describe(session));\n\t\tappendParms(sb).append('\\n');\n\t\tappendSubqueries(sb);\n\t\treturn sb.toString();\n\t}\n\tcase INSERT_VALUES:  {\n\t}\n\tcase INSERT_SELECT:  {\n\t}\n\tcase UPDATE:  {\n\t}\n\tcase DELETE:  {\n\t}\n\tcase CALL:  {\n\t}\n\tdefault: {\n\t\treturn \"UNKNOWN\";\n\t}\n\t}\n}","Distance":0.35,"Automatic":"private String describeImpl(Session session) throws Exception {\n\tStringBuffer sb;\n\tsb=new StringBuffer();\n\tswitch (type){\n\tcase SELECT:  {\n\t\tsb.append(select.describe(session));\n\t\tappendParms(sb).append('\\n');\n\t\tappendSubqueries(sb);\n\t\treturn sb.toString();\n\t}\n\tcase INSERT_VALUES:  {\n\t\treturn sb.toString();\n\t}\n\tcase INSERT_SELECT:  {\n\t\treturn sb.toString();\n\t}\n\tcase UPDATE:  {\n\t\treturn sb.toString();\n\t}\n\tdefault: {\n\t\treturn \"UNKNOWN\";\n\t}\n\t}\n}"},{"Origin":"private Result executeCallStatement(CompiledStatement cs) throws HsqlException {\n\tExpression e=cs.expression;\n\tObject o=e.getValue(session);\n\tResult r;\n\tif(o instanceof Result){\n\t\treturn (Result)o;\n\t} else if(o instanceof jdbcResultSet){\n\t\treturn ((jdbcResultSet)o).rResult;\n\t}\n\tr=Result.newSingleColumnResult(CompiledStatement.RETURN_COLUMN_NAME,e.getDataType());\n\tObject[] row=new Object[1];\n\trow[0]=o;\n\tr.metaData.classNames[0]=e.getValueClassName();\n\tr.add(row);\n\treturn r;\n}","Original_Lines":14,"Target_Lines":4,"Manual":"private Result executeCallStatement(CompiledStatement cs) throws HsqlException {\n\tExpression e=cs.expression;\n\tResult r;\n\tr=Result.newSingleColumnResult(CompiledStatement.RETURN_COLUMN_NAME,e.getDataType());\n\treturn r;\n}","Distance":0.4,"Automatic":"private Result executeCallStatement(CompiledStatement cs) throws HsqlException {\n\tExpression e=cs.expression;\n\tObject o=e.getValue(session);\n\tResult r;\n\treturn r;\n}"},{"Origin":"private Result executeDeleteStatement(CompiledStatement cs) throws HsqlException {\n\tTable table=cs.targetTable;\n\tTableFilter filter=cs.targetFilter;\n\tint count=0;\n\tif(filter.findFirst(session)){\n\t\tExpression c=cs.condition;\n\t\tHsqlArrayList del;\n\t\tdel=new HsqlArrayList();\n\t\tdo{\n\t\t\tif(c == null || c.testCondition(session)){\n\t\t\t\tdel.add(filter.currentRow);\n\t\t\t}\n\t\t}while(filter.next(session))\n\t\tcount=table.delete(session,del);\n\t}\n\tupdateResult.updateCount=count;\n\treturn updateResult;\n}","Original_Lines":16,"Target_Lines":9,"Manual":"private Result executeDeleteStatement(CompiledStatement cs) throws HsqlException {\n\tif(filter.findFirst(session)){\n\t\tExpression c=cs.condition;\n\t\tdo{\n\t\t\tif(c == null || c.testCondition(session)){\n\t\t\t\tdel.add(filter.currentRow);\n\t\t\t}\n\t\t}while(filter.next(session))\n\t}\n\treturn updateResult;\n}","Distance":0.2857142857142857,"Automatic":"private Result executeDeleteStatement(CompiledStatement cs) throws HsqlException {\n\tTableFilter filter=cs.targetFilter;\n\tif(filter.findFirst(session)){\n\t\tExpression c=cs.condition;\n\t\tdo{\n\t\t\tif(c == null || c.testCondition(session)){\n\t\t\t\tdel.add(filter.currentRow);\n\t\t\t}\n\t\t}while(filter.next(session))\n\t}\n}"},{"Origin":"private Result executeInsertSelectStatement(CompiledStatement cs) throws HsqlException {\n\tTable t=cs.targetTable;\n\tSelect s=cs.select;\n\tint[] ct=t.getColumnTypes();\n\tResult r=s.getResult(session,Integer.MAX_VALUE);\n\tRecord rc=r.rRoot;\n\tint[] cm=cs.columnMap;\n\tboolean[] ccl=cs.checkColumns;\n\tint len=cm.length;\n\tObject[] row;\n\tint count;\n\tboolean success=false;\n\tsession.beginNestedTransaction();\n\ttry {\n\t\twhile(rc != null){\n\t\t\trow=t.getNewRowData(session,ccl);\n\t\t\tfor (int i=0; i < len; i++){\n\t\t\t\tint j=cm[i];\n\t\t\t\tif(ct[j] != r.metaData.colTypes[i]){\n\t\t\t\t\trow[j]=Column.convertObject(rc.data[i],ct[j]);\n\t\t\t\t} else {\n\t\t\t\t\trow[j]=rc.data[i];\n\t\t\t\t}\n\t\t\t}\n\t\t\trc.data=row;\n\t\t\trc=rc.next;\n\t\t}\n\t\tcount=t.insert(session,r);\n\t\tsuccess=true;\n\t} finally {\n\t\tsession.endNestedTransaction(!success);\n\t} \n\tupdateResult.updateCount=count;\n\treturn updateResult;\n}","Original_Lines":33,"Target_Lines":18,"Manual":"private Result executeInsertSelectStatement(CompiledStatement cs) throws HsqlException {\n\ttry {\n\t\twhile(rc != null){\n\t\t\trow=t.getNewRowData(session,ccl);\n\t\t\tfor (int i=0; i < len; i++){\n\t\t\t\tint j=cm[i];\n\t\t\t\tif(ct[j] != r.metaData.colTypes[i]){\n\t\t\t\t\trow[j]=Column.convertObject(rc.data[i],ct[j]);\n\t\t\t\t} else {\n\t\t\t\t\trow[j]=rc.data[i];\n\t\t\t\t}\n\t\t\t}\n\t\t\trc.data=row;\n\t\t\trc=rc.next;\n\t\t}\n\t\tcount=t.insert(session,r);\n\t} finally {\n\t} \n\treturn updateResult;\n}","Distance":0.3333333333333333,"Automatic":"private Result executeInsertSelectStatement(CompiledStatement cs) throws HsqlException {\n\tResult r=s.getResult(session,Integer.MAX_VALUE);\n\tRecord rc=r.rRoot;\n\ttry {\n\t\twhile(rc != null){\n\t\t\trow=t.getNewRowData(session,ccl);\n\t\t\tfor (int i=0; i < len; i++){\n\t\t\t\tif(ct[j] != r.metaData.colTypes[i]){\n\t\t\t\t\trow[j]=Column.convertObject(rc.data[i],ct[j]);\n\t\t\t\t} else {\n\t\t\t\t\trow[j]=rc.data[i];\n\t\t\t\t}\n\t\t\t}\n\t\t\trc.data=row;\n\t\t\trc=rc.next;\n\t\t}\n\t\tcount=t.insert(session,r);\n\t} finally {\n\t\tsession.endNestedTransaction(!success);\n\t} \n}"},{"Origin":"private Result executeSelectStatement(CompiledStatement cs) throws HsqlException {\n\tSelect select=cs.select;\n\tResult result;\n\tif(select.sIntoTable != null){\n\t\tsession.checkDDLWrite();\n\t\tboolean exists=session.database.schemaManager.findUserTable(session,select.sIntoTable.name,select.sIntoTable.schema.name) != null;\n\t\tif(exists){\n\t\t\tthrow Trace.error(Trace.TABLE_ALREADY_EXISTS,select.sIntoTable.name);\n\t\t}\n\t\tresult=select.getResult(session,Integer.MAX_VALUE);\n\t\tresult=session.dbCommandInterpreter.processSelectInto(result,select.sIntoTable,select.intoType);\n\t\tsession.getDatabase().setMetaDirty(false);\n\t} else {\n\t\tresult=select.getResult(session,session.getMaxRows());\n\t}\n\treturn result;\n}","Original_Lines":15,"Target_Lines":8,"Manual":"private Result executeSelectStatement(CompiledStatement cs) throws HsqlException {\n\tif(select.sIntoTable != null){\n\t\tresult=select.getResult(session,Integer.MAX_VALUE);\n\t\tresult=session.dbCommandInterpreter.processSelectInto(result,select.sIntoTable,select.intoType);\n\t\tsession.getDatabase().setMetaDirty(false);\n\t} else {\n\t\tresult=select.getResult(session,session.getMaxRows());\n\t}\n\treturn result;\n}","Distance":0.5,"Automatic":"private Result executeSelectStatement(CompiledStatement cs) throws HsqlException {\n\tResult result;\n\tif(select.sIntoTable != null){\n\t\tboolean exists=session.database.schemaManager.findUserTable(session,select.sIntoTable.name,select.sIntoTable.schema.name) != null;\n\t\tresult=select.getResult(session,Integer.MAX_VALUE);\n\t\tresult=session.dbCommandInterpreter.processSelectInto(result,select.sIntoTable,select.intoType);\n\t} else {\n\t\tresult=select.getResult(session,session.getMaxRows());\n\t}\n}"},{"Origin":"private Result executeUpdateStatement(CompiledStatement cs) throws HsqlException {\n\tTable table=cs.targetTable;\n\tTableFilter filter=cs.targetFilter;\n\tint count=0;\n\tif(filter.findFirst(session)){\n\t\tint[] colmap=cs.columnMap;\n\t\tExpression[] colvalues=cs.columnValues;\n\t\tExpression condition=cs.condition;\n\t\tint len=colvalues.length;\n\t\tHashMappedList rowset=new HashMappedList();\n\t\tint size=table.getColumnCount();\n\t\tint[] coltypes=table.getColumnTypes();\n\t\tboolean success=false;\n\t\tdo{\n\t\t\tif(condition == null || condition.testCondition(session)){\n\t\t\t\ttry {\n\t\t\t\t\tRow row=filter.currentRow;\n\t\t\t\t\tObject[] ni=table.getEmptyRowData();\n\t\t\t\t\tSystem.arraycopy(row.getData(),0,ni,0,size);\n\t\t\t\t\tfor (int i=0; i < len; i++){\n\t\t\t\t\t\tint ci=colmap[i];\n\t\t\t\t\t\tni[ci]=colvalues[i].getValue(session,coltypes[ci]);\n\t\t\t\t\t}\n\t\t\t\t\trowset.add(row,ni);\n\t\t\t\t} catch (HsqlInternalException e){\n\t\t\t\t} \n\t\t\t}\n\t\t}while(filter.next(session))\n\t\tsession.beginNestedTransaction();\n\t\ttry {\n\t\t\tcount=table.update(session,rowset,colmap);\n\t\t\tsuccess=true;\n\t\t} finally {\n\t\t\tsession.endNestedTransaction(!success);\n\t\t} \n\t}\n\tupdateResult.updateCount=count;\n\treturn updateResult;\n}","Original_Lines":37,"Target_Lines":18,"Manual":"private Result executeUpdateStatement(CompiledStatement cs) throws HsqlException {\n\tif(filter.findFirst(session)){\n\t\tdo{\n\t\t\tif(condition == null || condition.testCondition(session)){\n\t\t\t\ttry {\n\t\t\t\t\tRow row=filter.currentRow;\n\t\t\t\t\tObject[] ni=table.getEmptyRowData();\n\t\t\t\t\tSystem.arraycopy(row.getData(),0,ni,0,size);\n\t\t\t\t\tfor (int i=0; i < len; i++){\n\t\t\t\t\t\tint ci=colmap[i];\n\t\t\t\t\t\tni[ci]=colvalues[i].getValue(session,coltypes[ci]);\n\t\t\t\t\t}\n\t\t\t\t\trowset.add(row,ni);\n\t\t\t\t} catch (HsqlInternalException e){\n\t\t\t\t} \n\t\t\t}\n\t\t}while(filter.next(session))\n\t}\n\treturn updateResult;\n}","Distance":0.4,"Automatic":"private Result executeUpdateStatement(CompiledStatement cs) throws HsqlException {\n\tif(filter.findFirst(session)){\n\t\tdo{\n\t\t\tif(condition == null || condition.testCondition(session)){\n\t\t\t\ttry {\n\t\t\t\t\tRow row=filter.currentRow;\n\t\t\t\t\tObject[] ni=table.getEmptyRowData();\n\t\t\t\t\tSystem.arraycopy(row.getData(),0,ni,0,size);\n\t\t\t\t\tfor (int i=0; i < len; i++){\n\t\t\t\t\t}\n\t\t\t\t\trowset.add(row,ni);\n\t\t\t\t} catch (HsqlInternalException e){\n\t\t\t\t} \n\t\t\t}\n\t\t}while(filter.next(session))\n\t\ttry {\n\t\t\tcount=table.update(session,rowset,colmap);\n\t\t} finally {\n\t\t\tsession.endNestedTransaction(!success);\n\t\t} \n\t}\n}"},{"Origin":"void close(int closemode) throws HsqlException {\n\tHsqlException he=null;\n\tsetState(DATABASE_CLOSING);\n\tsessionManager.closeAllSessions();\n\tsessionManager.clearAll();\n\tif(filesReadOnly){\n\t\tclosemode=CLOSEMODE_IMMEDIATELY;\n\t}\n\tlogger.closeLog(closemode);\n\ttry {\n\t\tif(closemode == CLOSEMODE_COMPACT){\n\t\t\tclearStructures();\n\t\t\treopen();\n\t\t\tsetState(DATABASE_CLOSING);\n\t\t\tlogger.closeLog(CLOSEMODE_NORMAL);\n\t\t}\n\t} catch (Throwable t){\n\t\tif(t instanceof HsqlException){\n\t\t\the=(HsqlException)t;\n\t\t} else {\n\t\t\the=Trace.error(Trace.GENERAL_ERROR,t.toString());\n\t\t}\n\t} \n\tclassLoader=null;\n\tlogger.releaseLock();\n\tsetState(DATABASE_SHUTDOWN);\n\tclearStructures();\n\tDatabaseManager.removeDatabase(this);\n\tif(he != null){\n\t\tthrow he;\n\t}\n}","Original_Lines":30,"Target_Lines":15,"Manual":"void close(int closemode) throws HsqlException {\n\tsetState(DATABASE_CLOSING);\n\tsessionManager.closeAllSessions();\n\tsessionManager.clearAll();\n\ttry {\n\t\tif(closemode == CLOSEMODE_COMPACT){\n\t\t\tclearStructures();\n\t\t\treopen();\n\t\t\tsetState(DATABASE_CLOSING);\n\t\t\tlogger.closeLog(CLOSEMODE_NORMAL);\n\t\t}\n\t} catch (Throwable t){\n\t} \n\tsetState(DATABASE_SHUTDOWN);\n\tclearStructures();\n\tDatabaseManager.removeDatabase(this);\n}","Distance":0.35714285714285715,"Automatic":"void close(int closemode) throws HsqlException {\n\tsetState(DATABASE_CLOSING);\n\tsessionManager.closeAllSessions();\n\tsessionManager.clearAll();\n\ttry {\n\t\tif(closemode == CLOSEMODE_COMPACT){\n\t\t\tclearStructures();\n\t\t\treopen();\n\t\t\tsetState(DATABASE_CLOSING);\n\t\t}\n\t} catch (Throwable t){\n\t\tif(t instanceof HsqlException){\n\t\t} else {\n\t\t\the=Trace.error(Trace.GENERAL_ERROR,t.toString());\n\t\t}\n\t} \n\tsetState(DATABASE_SHUTDOWN);\n}"},{"Origin":"Result execute(String sql){\n\tResult result;\n\tString token;\n\tint cmd;\n\tJavaSystem.gc();\n\tresult=null;\n\tcmd=Token.UNKNOWNTOKEN;\n\ttry {\n\t\ttokenizer.reset(sql);\n\t\twhile(true){\n\t\t\ttokenizer.setPartMarker();\n\t\t\tsession.setScripting(false);\n\t\t\ttoken=tokenizer.getSimpleToken();\n\t\t\tif(token.length() == 0){\n\t\t\t\tsession.endSchemaDefinition();\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcmd=Token.get(token);\n\t\t\tif(cmd == Token.SEMICOLON){\n\t\t\t\tsession.endSchemaDefinition();\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tresult=executePart(cmd,token);\n\t\t\tif(result.mode == ResultConstants.ERROR){\n\t\t\t\tsession.endSchemaDefinition();\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif(session.getScripting()){\n\t\t\t\tdatabase.logger.writeToLog(session,tokenizer.getLastPart());\n\t\t\t}\n\t\t}\n\t} catch (Throwable t){\n\t\ttry {\n\t\t\tsession.endSchemaDefinition();\n\t\t} catch (HsqlException e){\n\t\t} \n\t\tresult=new Result(t,tokenizer.getLastPart());\n\t} \n\treturn result == null ? Session.emptyUpdateCount : result;\n}","Original_Lines":38,"Target_Lines":20,"Manual":"Result execute(String sql){\n\ttry {\n\t\ttokenizer.reset(sql);\n\t\twhile(true){\n\t\t\ttokenizer.setPartMarker();\n\t\t\tsession.setScripting(false);\n\t\t\ttoken=tokenizer.getSimpleToken();\n\t\t\tcmd=Token.get(token);\n\t\t\tresult=executePart(cmd,token);\n\t\t\tif(session.getScripting()){\n\t\t\t\tdatabase.logger.writeToLog(session,tokenizer.getLastPart());\n\t\t\t}\n\t\t}\n\t} catch (Throwable t){\n\t\ttry {\n\t\t\tsession.endSchemaDefinition();\n\t\t} catch (HsqlException e){\n\t\t} \n\t\tresult=new Result(t,tokenizer.getLastPart());\n\t} \n\treturn result == null ? Session.emptyUpdateCount : result;\n}","Distance":0.4,"Automatic":"Result execute(String sql){\n\tResult result;\n\tString token;\n\tint cmd;\n\tresult=null;\n\tcmd=Token.UNKNOWNTOKEN;\n\ttry {\n\t\ttokenizer.reset(sql);\n\t\twhile(true){\n\t\t\ttokenizer.setPartMarker();\n\t\t\tsession.setScripting(false);\n\t\t\ttoken=tokenizer.getSimpleToken();\n\t\t\tcmd=Token.get(token);\n\t\t\tresult=executePart(cmd,token);\n\t\t\tif(session.getScripting()){\n\t\t\t\tdatabase.logger.writeToLog(session,tokenizer.getLastPart());\n\t\t\t}\n\t\t}\n\t} catch (Throwable t){\n\t\tresult=new Result(t,tokenizer.getLastPart());\n\t} \n\treturn result == null ? Session.emptyUpdateCount : result;\n}"},{"Origin":"private Result executePart(int cmd,String token) throws Throwable {\n\tResult result=Session.emptyUpdateCount;\n\tint brackets=0;\n\tif(session.isSchemaDefintion()){\n\t\tswitch (cmd){\n\t\tcase Token.CREATE: \n\t\tcase Token.GRANT: \n\t\t\tbreak;\n\t\tdefault:\n\t\t\tString schema=session.getSchemaName(null);\n\t\t\tsession.endSchemaDefinition();\n\t\t\tdatabase.schemaManager.dropSchema(schema,true);\n\t\t\tthrow Trace.error(Trace.INVALID_IDENTIFIER,Trace.IN_SCHEMA_DEFINITION,new Object[]{token});\n\t\t}\n\t}\n\tswitch (cmd){\n\tcase Token.OPENBRACKET:  {\n\t\tbrackets=Parser.parseOpenBrackets(tokenizer) + 1;\n\t\ttokenizer.getThis(Token.T_SELECT);\n\t}\n\tcase Token.SELECT:  {\n\t\tParser parser=new Parser(session,database,tokenizer);\n\t\tCompiledStatement cStatement=parser.compileSelectStatement(brackets);\n\t\tif(cStatement.parameters.length != 0){\n\t\t\tTrace.doAssert(false,Trace.getMessage(Trace.ASSERT_DIRECT_EXEC_WITH_PARAM));\n\t\t}\n\t\tresult=session.sqlExecuteCompiledNoPreChecks(cStatement);\n\t\tbreak;\n\t}\n\tcase Token.INSERT:  {\n\t\tParser parser=new Parser(session,database,tokenizer);\n\t\tCompiledStatement cStatement=parser.compileInsertStatement();\n\t\tif(cStatement.parameters.length != 0){\n\t\t\tTrace.doAssert(false,Trace.getMessage(Trace.ASSERT_DIRECT_EXEC_WITH_PARAM));\n\t\t}\n\t\tresult=session.sqlExecuteCompiledNoPreChecks(cStatement);\n\t\tbreak;\n\t}\n\tcase Token.UPDATE:  {\n\t\tParser parser=new Parser(session,database,tokenizer);\n\t\tCompiledStatement cStatement=parser.compileUpdateStatement();\n\t\tif(cStatement.parameters.length != 0){\n\t\t\tTrace.doAssert(false,Trace.getMessage(Trace.ASSERT_DIRECT_EXEC_WITH_PARAM));\n\t\t}\n\t\tresult=session.sqlExecuteCompiledNoPreChecks(cStatement);\n\t\tbreak;\n\t}\n\tcase Token.DELETE:  {\n\t\tParser parser=new Parser(session,database,tokenizer);\n\t\tCompiledStatement cStatement=parser.compileDeleteStatement();\n\t\tif(cStatement.parameters.length != 0){\n\t\t\tTrace.doAssert(false,Trace.getMessage(Trace.ASSERT_DIRECT_EXEC_WITH_PARAM));\n\t\t}\n\t\tresult=session.sqlExecuteCompiledNoPreChecks(cStatement);\n\t\tbreak;\n\t}\n\tcase Token.CALL:  {\n\t\tParser parser=new Parser(session,database,tokenizer);\n\t\tCompiledStatement cStatement=parser.compileCallStatement();\n\t\tif(cStatement.parameters.length != 0){\n\t\t\tTrace.doAssert(false,Trace.getMessage(Trace.ASSERT_DIRECT_EXEC_WITH_PARAM));\n\t\t}\n\t\tresult=session.sqlExecuteCompiledNoPreChecks(cStatement);\n\t\tbreak;\n\t}\n\tcase Token.SET: \n\t\tprocessSet();\n\t\tbreak;\n\tcase Token.COMMIT: \n\t\tprocessCommit();\n\t\tbreak;\n\tcase Token.ROLLBACK: \n\t\tprocessRollback();\n\t\tbreak;\n\tcase Token.SAVEPOINT: \n\t\tprocessSavepoint();\n\t\tbreak;\n\tcase Token.CREATE: \n\t\tprocessCreate();\n\t\tdatabase.setMetaDirty(true);\n\t\tbreak;\n\tcase Token.ALTER: \n\t\tprocessAlter();\n\t\tdatabase.setMetaDirty(true);\n\t\tbreak;\n\tcase Token.DROP: \n\t\tprocessDrop();\n\t\tdatabase.setMetaDirty(true);\n\t\tbreak;\n\tcase Token.GRANT: \n\t\tprocessGrantOrRevoke(true);\n\t\tdatabase.setMetaDirty(false);\n\t\tbreak;\n\tcase Token.REVOKE: \n\t\tprocessGrantOrRevoke(false);\n\t\tdatabase.setMetaDirty(true);\n\t\tbreak;\n\tcase Token.CONNECT: \n\t\tprocessConnect();\n\t\tdatabase.setMetaDirty(false);\n\t\tsession.setScripting(false);\n\t\tbreak;\n\tcase Token.DISCONNECT: \n\t\tprocessDisconnect();\n\t\tsession.setScripting(true);\n\t\tbreak;\n\tcase Token.SCRIPT: \n\t\tresult=processScript();\n\t\tbreak;\n\tcase Token.SHUTDOWN: \n\t\tprocessShutdown();\n\t\tbreak;\n\tcase Token.CHECKPOINT: \n\t\tprocessCheckpoint();\n\t\tbreak;\n\tcase Token.EXPLAIN: \n\t\tresult=processExplainPlan();\n\t\tbreak;\n\tcase Token.RELEASE: \n\t\tprocessReleaseSavepoint();\n\t\tbreak;\n\tdefault:\n\t\tthrow Trace.error(Trace.UNEXPECTED_TOKEN,token);\n\t}\n\treturn result;\n}","Original_Lines":124,"Target_Lines":43,"Manual":"private Result executePart(int cmd,String token) throws Throwable {\n\tif(session.isSchemaDefintion()){\n\t\tswitch (cmd){\n\t\tcase Token.CREATE: \n\t\tcase Token.GRANT: \n\t\t\tbreak;\n\t\tdefault:\n\t\t\tthrow Trace.error(Trace.INVALID_IDENTIFIER,Trace.IN_SCHEMA_DEFINITION,new Object[]{token});\n\t\t}\n\t}\n\tswitch (cmd){\n\tcase Token.OPENBRACKET:  {\n\t\tbrackets=Parser.parseOpenBrackets(tokenizer) + 1;\n\t\ttokenizer.getThis(Token.T_SELECT);\n\t}\n\tcase Token.SELECT:  {\n\t}\n\tcase Token.INSERT:  {\n\t}\n\tcase Token.UPDATE:  {\n\t}\n\tcase Token.DELETE:  {\n\t}\n\tcase Token.CALL:  {\n\t}\n\tcase Token.SET: \n\tcase Token.COMMIT: \n\tcase Token.ROLLBACK: \n\tcase Token.SAVEPOINT: \n\tcase Token.CREATE: \n\tcase Token.ALTER: \n\tcase Token.DROP: \n\tcase Token.GRANT: \n\tcase Token.REVOKE: \n\tcase Token.CONNECT: \n\tcase Token.DISCONNECT: \n\tcase Token.SCRIPT: \n\tcase Token.SHUTDOWN: \n\tcase Token.CHECKPOINT: \n\tcase Token.EXPLAIN: \n\tcase Token.RELEASE: \n\tdefault:\n\t}\n\treturn result;\n}","Distance":0.20512820512820512,"Automatic":"private Result executePart(int cmd,String token) throws Throwable {\n\tResult result=Session.emptyUpdateCount;\n\tif(session.isSchemaDefintion()){\n\t\tswitch (cmd){\n\t\tcase Token.CREATE: \n\t\tcase Token.GRANT: \n\t\tdefault:\n\t\t\tString schema=session.getSchemaName(null);\n\t\t\tsession.endSchemaDefinition();\n\t\t\tdatabase.schemaManager.dropSchema(schema,true);\n\t\t\tthrow Trace.error(Trace.INVALID_IDENTIFIER,Trace.IN_SCHEMA_DEFINITION,new Object[]{token});\n\t\t}\n\t}\n\tswitch (cmd){\n\tcase Token.OPENBRACKET:  {\n\t\tbrackets=Parser.parseOpenBrackets(tokenizer) + 1;\n\t\ttokenizer.getThis(Token.T_SELECT);\n\t}\n\tcase Token.SELECT:  {\n\t}\n\tcase Token.INSERT:  {\n\t}\n\tcase Token.UPDATE:  {\n\t}\n\tcase Token.SET: \n\tcase Token.COMMIT: \n\tcase Token.ROLLBACK: \n\tcase Token.SAVEPOINT: \n\tcase Token.CREATE: \n\tcase Token.ALTER: \n\tcase Token.DROP: \n\tcase Token.GRANT: \n\tcase Token.REVOKE: \n\tcase Token.CONNECT: \n\tcase Token.DISCONNECT: \n\tcase Token.SCRIPT: \n\tcase Token.SHUTDOWN: \n\tcase Token.CHECKPOINT: \n\tcase Token.EXPLAIN: \n\tcase Token.RELEASE: \n\tdefault:\n\t\tthrow Trace.error(Trace.UNEXPECTED_TOKEN,token);\n\t}\n\treturn result;\n}"},{"Origin":"public static JSONObject toJSONObject(String string) throws JSONException {\n\tString name;\n\tJSONObject jo=new JSONObject();\n\tObject value;\n\tJSONTokener x=new JSONTokener(string);\n\tjo.put(\"name\",x.nextTo('='));\n\tx.next('=');\n\tjo.put(\"value\",x.nextTo(';'));\n\tx.next();\n\twhile(x.more()){\n\t\tname=unescape(x.nextTo(\"=;\"));\n\t\tif(x.next() != '='){\n\t\t\tif(name.equals(\"secure\")){\n\t\t\t\tvalue=Boolean.TRUE;\n\t\t\t} else {\n\t\t\t\tthrow x.syntaxError(\"Missing '=' in cookie parameter.\");\n\t\t\t}\n\t\t} else {\n\t\t\tvalue=unescape(x.nextTo(';'));\n\t\t\tx.next();\n\t\t}\n\t\tjo.put(name,value);\n\t}\n\treturn jo;\n}","Original_Lines":23,"Target_Lines":7,"Manual":"public static JSONObject toJSONObject(String string) throws JSONException {\n\tJSONObject jo=new JSONObject();\n\tJSONTokener x=new JSONTokener(string);\n\twhile(x.more()){\n\t\tname=unescape(x.nextTo(\"=;\"));\n\t\tjo.put(name,value);\n\t}\n\treturn jo;\n}","Distance":0.375,"Automatic":"public static JSONObject toJSONObject(String string) throws JSONException {\n\tString name;\n\tJSONObject jo=new JSONObject();\n\tJSONTokener x=new JSONTokener(string);\n\twhile(x.more()){\n\t\tjo.put(name,value);\n\t}\n\treturn jo;\n}"},{"Origin":"public static String toString(JSONObject jo) throws JSONException {\n\tIterator keys=jo.keys();\n\tString string;\n\tStringBuffer sb=new StringBuffer();\n\tif(jo.has(\"Status-Code\") && jo.has(\"Reason-Phrase\")){\n\t\tsb.append(jo.getString(\"HTTP-Version\"));\n\t\tsb.append(' ');\n\t\tsb.append(jo.getString(\"Status-Code\"));\n\t\tsb.append(' ');\n\t\tsb.append(jo.getString(\"Reason-Phrase\"));\n\t} else if(jo.has(\"Method\") && jo.has(\"Request-URI\")){\n\t\tsb.append(jo.getString(\"Method\"));\n\t\tsb.append(' ');\n\t\tsb.append('\"');\n\t\tsb.append(jo.getString(\"Request-URI\"));\n\t\tsb.append('\"');\n\t\tsb.append(' ');\n\t\tsb.append(jo.getString(\"HTTP-Version\"));\n\t} else {\n\t\tthrow new JSONException(\"Not enough material for an HTTP header.\");\n\t}\n\tsb.append(CRLF);\n\twhile(keys.hasNext()){\n\t\tstring=keys.next().toString();\n\t\tif(!\"HTTP-Version\".equals(string) && !\"Status-Code\".equals(string) && !\"Reason-Phrase\".equals(string)&& !\"Method\".equals(string)&& !\"Request-URI\".equals(string)&& !jo.isNull(string)){\n\t\t\tsb.append(string);\n\t\t\tsb.append(\": \");\n\t\t\tsb.append(jo.getString(string));\n\t\t\tsb.append(CRLF);\n\t\t}\n\t}\n\tsb.append(CRLF);\n\treturn sb.toString();\n}","Original_Lines":32,"Target_Lines":21,"Manual":"public static String toString(JSONObject jo) throws JSONException {\n\tIterator keys=jo.keys();\n\tStringBuffer sb=new StringBuffer();\n\tif(jo.has(\"Status-Code\") && jo.has(\"Reason-Phrase\")){\n\t\tsb.append(jo.getString(\"HTTP-Version\"));\n\t\tsb.append(jo.getString(\"Status-Code\"));\n\t\tsb.append(jo.getString(\"Reason-Phrase\"));\n\t} else if(jo.has(\"Method\") && jo.has(\"Request-URI\")){\n\t\tsb.append(jo.getString(\"Method\"));\n\t\tsb.append(jo.getString(\"Request-URI\"));\n\t\tsb.append(jo.getString(\"HTTP-Version\"));\n\t} else {\n\t}\n\twhile(keys.hasNext()){\n\t\tstring=keys.next().toString();\n\t\tif(!\"HTTP-Version\".equals(string) && !\"Status-Code\".equals(string) && !\"Reason-Phrase\".equals(string)&& !\"Method\".equals(string)&& !\"Request-URI\".equals(string)&& !jo.isNull(string)){\n\t\t\tsb.append(string);\n\t\t\tsb.append(\": \");\n\t\t\tsb.append(jo.getString(string));\n\t\t}\n\t}\n\treturn sb.toString();\n}","Distance":0.21052631578947367,"Automatic":"public static String toString(JSONObject jo) throws JSONException {\n\tIterator keys=jo.keys();\n\tString string;\n\tStringBuffer sb=new StringBuffer();\n\tif(jo.has(\"Status-Code\") && jo.has(\"Reason-Phrase\")){\n\t\tsb.append(jo.getString(\"HTTP-Version\"));\n\t\tsb.append(jo.getString(\"Status-Code\"));\n\t\tsb.append(jo.getString(\"Reason-Phrase\"));\n\t} else if(jo.has(\"Method\") && jo.has(\"Request-URI\")){\n\t\tsb.append(jo.getString(\"Method\"));\n\t\tsb.append(jo.getString(\"Request-URI\"));\n\t\tsb.append(jo.getString(\"HTTP-Version\"));\n\t} else {\n\t}\n\twhile(keys.hasNext()){\n\t\tstring=keys.next().toString();\n\t\tif(!\"HTTP-Version\".equals(string) && !\"Status-Code\".equals(string) && !\"Reason-Phrase\".equals(string)&& !\"Method\".equals(string)&& !\"Request-URI\".equals(string)&& !jo.isNull(string)){\n\t\t\tsb.append(jo.getString(string));\n\t\t\tsb.append(CRLF);\n\t\t}\n\t}\n\treturn sb.toString();\n}"},{"Origin":"String toString(int indentFactor,int indent) throws JSONException {\n\tint len=this.length();\n\tif(len == 0){\n\t\treturn \"[]\";\n\t}\n\tint i;\n\tStringBuffer sb=new StringBuffer(\"[\");\n\tif(len == 1){\n\t\tsb.append(JSONObject.valueToString(this.myArrayList.get(0),indentFactor,indent));\n\t} else {\n\t\tint newindent=indent + indentFactor;\n\t\tsb.append('\\n');\n\t\tfor (i=0; i < len; i+=1){\n\t\t\tif(i > 0){\n\t\t\t\tsb.append(\",\\n\");\n\t\t\t}\n\t\t\tfor (int j=0; j < newindent; j+=1){\n\t\t\t\tsb.append(' ');\n\t\t\t}\n\t\t\tsb.append(JSONObject.valueToString(this.myArrayList.get(i),indentFactor,newindent));\n\t\t}\n\t\tsb.append('\\n');\n\t\tfor (i=0; i < indent; i+=1){\n\t\t\tsb.append(' ');\n\t\t}\n\t}\n\tsb.append(']');\n\treturn sb.toString();\n}","Original_Lines":27,"Target_Lines":12,"Manual":"String toString(int indentFactor,int indent) throws JSONException {\n\tint len=this.length();\n\tStringBuffer sb=new StringBuffer(\"[\");\n\tif(len == 1){\n\t\tsb.append(JSONObject.valueToString(this.myArrayList.get(0),indentFactor,indent));\n\t} else {\n\t\tint newindent=indent + indentFactor;\n\t\tfor (i=0; i < len; i+=1){\n\t\t\tsb.append(JSONObject.valueToString(this.myArrayList.get(i),indentFactor,newindent));\n\t\t}\n\t}\n\tsb.append(']');\n\treturn sb.toString();\n}","Distance":0.2,"Automatic":"String toString(int indentFactor,int indent) throws JSONException {\n\tint len=this.length();\n\tint i;\n\tStringBuffer sb=new StringBuffer(\"[\");\n\tif(len == 1){\n\t\tsb.append(JSONObject.valueToString(this.myArrayList.get(0),indentFactor,indent));\n\t} else {\n\t\tint newindent=indent + indentFactor;\n\t\tfor (i=0; i < len; i+=1){\n\t\t\tsb.append(JSONObject.valueToString(this.myArrayList.get(i),indentFactor,newindent));\n\t\t}\n\t}\n\treturn sb.toString();\n}"},{"Origin":"private static Object parse(XMLTokener x,boolean arrayForm,JSONArray ja) throws JSONException {\n\tString attribute;\n\tchar c;\n\tString closeTag=null;\n\tint i;\n\tJSONArray newja=null;\n\tJSONObject newjo=null;\n\tObject token;\n\tString tagName=null;\n\twhile(true){\n\t\tif(!x.more()){\n\t\t\tthrow x.syntaxError(\"Bad XML\");\n\t\t}\n\t\ttoken=x.nextContent();\n\t\tif(token == XML.LT){\n\t\t\ttoken=x.nextToken();\n\t\t\tif(token instanceof Character){\n\t\t\t\tif(token == XML.SLASH){\n\t\t\t\t\ttoken=x.nextToken();\n\t\t\t\t\tif(!(token instanceof String)){\n\t\t\t\t\t\tthrow new JSONException(\"Expected a closing name instead of '\" + token + \"'.\");\n\t\t\t\t\t}\n\t\t\t\t\tif(x.nextToken() != XML.GT){\n\t\t\t\t\t\tthrow x.syntaxError(\"Misshaped close tag\");\n\t\t\t\t\t}\n\t\t\t\t\treturn token;\n\t\t\t\t} else if(token == XML.BANG){\n\t\t\t\t\tc=x.next();\n\t\t\t\t\tif(c == '-'){\n\t\t\t\t\t\tif(x.next() == '-'){\n\t\t\t\t\t\t\tx.skipPast(\"-->\");\n\t\t\t\t\t\t}\n\t\t\t\t\t\tx.back();\n\t\t\t\t\t} else if(c == '['){\n\t\t\t\t\t\ttoken=x.nextToken();\n\t\t\t\t\t\tif(token.equals(\"CDATA\") && x.next() == '['){\n\t\t\t\t\t\t\tif(ja != null){\n\t\t\t\t\t\t\t\tja.put(x.nextCDATA());\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthrow x.syntaxError(\"Expected 'CDATA['\");\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\ti=1;\n\t\t\t\t\t\tdo{\n\t\t\t\t\t\t\ttoken=x.nextMeta();\n\t\t\t\t\t\t\tif(token == null){\n\t\t\t\t\t\t\t\tthrow x.syntaxError(\"Missing '>' after '<!'.\");\n\t\t\t\t\t\t\t} else if(token == XML.LT){\n\t\t\t\t\t\t\t\ti+=1;\n\t\t\t\t\t\t\t} else if(token == XML.GT){\n\t\t\t\t\t\t\t\ti-=1;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}while(i > 0)\n\t\t\t\t\t}\n\t\t\t\t} else if(token == XML.QUEST){\n\t\t\t\t\tx.skipPast(\"?>\");\n\t\t\t\t} else {\n\t\t\t\t\tthrow x.syntaxError(\"Misshaped tag\");\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif(!(token instanceof String)){\n\t\t\t\t\tthrow x.syntaxError(\"Bad tagName '\" + token + \"'.\");\n\t\t\t\t}\n\t\t\t\ttagName=(String)token;\n\t\t\t\tnewja=new JSONArray();\n\t\t\t\tnewjo=new JSONObject();\n\t\t\t\tif(arrayForm){\n\t\t\t\t\tnewja.put(tagName);\n\t\t\t\t\tif(ja != null){\n\t\t\t\t\t\tja.put(newja);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tnewjo.put(\"tagName\",tagName);\n\t\t\t\t\tif(ja != null){\n\t\t\t\t\t\tja.put(newjo);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\ttoken=null;\n\t\t\t\tfor (; ; ){\n\t\t\t\t\tif(token == null){\n\t\t\t\t\t\ttoken=x.nextToken();\n\t\t\t\t\t}\n\t\t\t\t\tif(token == null){\n\t\t\t\t\t\tthrow x.syntaxError(\"Misshaped tag\");\n\t\t\t\t\t}\n\t\t\t\t\tif(!(token instanceof String)){\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tattribute=(String)token;\n\t\t\t\t\tif(!arrayForm && (\"tagName\".equals(attribute) || \"childNode\".equals(attribute))){\n\t\t\t\t\t\tthrow x.syntaxError(\"Reserved attribute.\");\n\t\t\t\t\t}\n\t\t\t\t\ttoken=x.nextToken();\n\t\t\t\t\tif(token == XML.EQ){\n\t\t\t\t\t\ttoken=x.nextToken();\n\t\t\t\t\t\tif(!(token instanceof String)){\n\t\t\t\t\t\t\tthrow x.syntaxError(\"Missing value\");\n\t\t\t\t\t\t}\n\t\t\t\t\t\tnewjo.accumulate(attribute,XML.stringToValue((String)token));\n\t\t\t\t\t\ttoken=null;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tnewjo.accumulate(attribute,\"\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(arrayForm && newjo.length() > 0){\n\t\t\t\t\tnewja.put(newjo);\n\t\t\t\t}\n\t\t\t\tif(token == XML.SLASH){\n\t\t\t\t\tif(x.nextToken() != XML.GT){\n\t\t\t\t\t\tthrow x.syntaxError(\"Misshaped tag\");\n\t\t\t\t\t}\n\t\t\t\t\tif(ja == null){\n\t\t\t\t\t\tif(arrayForm){\n\t\t\t\t\t\t\treturn newja;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\treturn newjo;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif(token != XML.GT){\n\t\t\t\t\t\tthrow x.syntaxError(\"Misshaped tag\");\n\t\t\t\t\t}\n\t\t\t\t\tcloseTag=(String)parse(x,arrayForm,newja);\n\t\t\t\t\tif(closeTag != null){\n\t\t\t\t\t\tif(!closeTag.equals(tagName)){\n\t\t\t\t\t\t\tthrow x.syntaxError(\"Mismatched '\" + tagName + \"' and '\"+ closeTag+ \"'\");\n\t\t\t\t\t\t}\n\t\t\t\t\t\ttagName=null;\n\t\t\t\t\t\tif(!arrayForm && newja.length() > 0){\n\t\t\t\t\t\t\tnewjo.put(\"childNodes\",newja);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(ja == null){\n\t\t\t\t\t\t\tif(arrayForm){\n\t\t\t\t\t\t\t\treturn newja;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\treturn newjo;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tif(ja != null){\n\t\t\t\tja.put(token instanceof String ? XML.stringToValue((String)token) : token);\n\t\t\t}\n\t\t}\n\t}\n}","Original_Lines":147,"Target_Lines":76,"Manual":"private static Object parse(XMLTokener x,boolean arrayForm,JSONArray ja) throws JSONException {\n\tJSONArray newja=null;\n\tJSONObject newjo=null;\n\twhile(true){\n\t\ttoken=x.nextContent();\n\t\tif(token == XML.LT){\n\t\t\ttoken=x.nextToken();\n\t\t\tif(token instanceof Character){\n\t\t\t\tif(token == XML.SLASH){\n\t\t\t\t\ttoken=x.nextToken();\n\t\t\t\t\treturn token;\n\t\t\t\t} else if(token == XML.BANG){\n\t\t\t\t\tc=x.next();\n\t\t\t\t\tif(c == '-'){\n\t\t\t\t\t} else if(c == '['){\n\t\t\t\t\t} else {\n\t\t\t\t\t}\n\t\t\t\t} else if(token == XML.QUEST){\n\t\t\t\t\tx.skipPast(\"?>\");\n\t\t\t\t} else {\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\ttagName=(String)token;\n\t\t\t\tif(arrayForm){\n\t\t\t\t\tnewja.put(tagName);\n\t\t\t\t\tif(ja != null){\n\t\t\t\t\t\tja.put(newja);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tnewjo.put(\"tagName\",tagName);\n\t\t\t\t\tif(ja != null){\n\t\t\t\t\t\tja.put(newjo);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tfor (; ; ){\n\t\t\t\t\tattribute=(String)token;\n\t\t\t\t\ttoken=x.nextToken();\n\t\t\t\t\tif(token == XML.EQ){\n\t\t\t\t\t\ttoken=x.nextToken();\n\t\t\t\t\t\tnewjo.accumulate(attribute,XML.stringToValue((String)token));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tnewjo.accumulate(attribute,\"\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(arrayForm && newjo.length() > 0){\n\t\t\t\t\tnewja.put(newjo);\n\t\t\t\t}\n\t\t\t\tif(token == XML.SLASH){\n\t\t\t\t\tif(ja == null){\n\t\t\t\t\t\tif(arrayForm){\n\t\t\t\t\t\t\treturn newja;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\treturn newjo;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tcloseTag=(String)parse(x,arrayForm,newja);\n\t\t\t\t\tif(closeTag != null){\n\t\t\t\t\t\tif(!arrayForm && newja.length() > 0){\n\t\t\t\t\t\t\tnewjo.put(\"childNodes\",newja);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(ja == null){\n\t\t\t\t\t\t\tif(arrayForm){\n\t\t\t\t\t\t\t\treturn newja;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\treturn newjo;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tif(ja != null){\n\t\t\t\tja.put(token instanceof String ? XML.stringToValue((String)token) : token);\n\t\t\t}\n\t\t}\n\t}\n}","Distance":0.5072463768115942,"Automatic":"private static Object parse(XMLTokener x,boolean arrayForm,JSONArray ja) throws JSONException {\n\tString attribute;\n\tchar c;\n\tint i;\n\tJSONArray newja=null;\n\tJSONObject newjo=null;\n\tObject token;\n\tString tagName=null;\n\twhile(true){\n\t\ttoken=x.nextContent();\n\t\tif(token == XML.LT){\n\t\t\ttoken=x.nextToken();\n\t\t\tif(token instanceof Character){\n\t\t\t\tif(token == XML.SLASH){\n\t\t\t\t\ttoken=x.nextToken();\n\t\t\t\t\treturn token;\n\t\t\t\t} else if(token == XML.BANG){\n\t\t\t\t\tc=x.next();\n\t\t\t\t\tif(c == '-'){\n\t\t\t\t\t\tx.back();\n\t\t\t\t\t} else if(c == '['){\n\t\t\t\t\t\ttoken=x.nextToken();\n\t\t\t\t\t} else {\n\t\t\t\t\t\ti=1;\n\t\t\t\t\t\tdo{\n\t\t\t\t\t\t\ttoken=x.nextMeta();\n\t\t\t\t\t\t\tif(token == null){\n\t\t\t\t\t\t\t\tthrow x.syntaxError(\"Missing '>' after '<!'.\");\n\t\t\t\t\t\t\t} else if(token == XML.LT){\n\t\t\t\t\t\t\t\ti+=1;\n\t\t\t\t\t\t\t} else if(token == XML.GT){\n\t\t\t\t\t\t\t\ti-=1;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}while(i > 0)\n\t\t\t\t\t}\n\t\t\t\t} else if(token == XML.QUEST){\n\t\t\t\t\tx.skipPast(\"?>\");\n\t\t\t\t} else {\n\t\t\t\t\tthrow x.syntaxError(\"Misshaped tag\");\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\ttagName=(String)token;\n\t\t\t\tnewja=new JSONArray();\n\t\t\t\tnewjo=new JSONObject();\n\t\t\t\tif(arrayForm){\n\t\t\t\t\tnewja.put(tagName);\n\t\t\t\t} else {\n\t\t\t\t\tnewjo.put(\"tagName\",tagName);\n\t\t\t\t\tif(ja != null){\n\t\t\t\t\t\tja.put(newjo);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\ttoken=null;\n\t\t\t\tfor (; ; ){\n\t\t\t\t\tattribute=(String)token;\n\t\t\t\t\ttoken=x.nextToken();\n\t\t\t\t\tif(token == XML.EQ){\n\t\t\t\t\t\ttoken=x.nextToken();\n\t\t\t\t\t\tnewjo.accumulate(attribute,XML.stringToValue((String)token));\n\t\t\t\t\t\ttoken=null;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tnewjo.accumulate(attribute,\"\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(token == XML.SLASH){\n\t\t\t\t} else {\n\t\t\t\t\tcloseTag=(String)parse(x,arrayForm,newja);\n\t\t\t\t\tif(closeTag != null){\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tif(ja != null){\n\t\t\t\tja.put(token instanceof String ? XML.stringToValue((String)token) : token);\n\t\t\t}\n\t\t}\n\t}\n}"},{"Origin":"public static String toString(JSONArray ja) throws JSONException {\n\tint i;\n\tJSONObject jo;\n\tString key;\n\tIterator keys;\n\tint length;\n\tObject object;\n\tStringBuffer sb=new StringBuffer();\n\tString tagName;\n\tString value;\n\ttagName=ja.getString(0);\n\tXML.noSpace(tagName);\n\ttagName=XML.escape(tagName);\n\tsb.append('<');\n\tsb.append(tagName);\n\tobject=ja.opt(1);\n\tif(object instanceof JSONObject){\n\t\ti=2;\n\t\tjo=(JSONObject)object;\n\t\tkeys=jo.keys();\n\t\twhile(keys.hasNext()){\n\t\t\tkey=keys.next().toString();\n\t\t\tXML.noSpace(key);\n\t\t\tvalue=jo.optString(key);\n\t\t\tif(value != null){\n\t\t\t\tsb.append(' ');\n\t\t\t\tsb.append(XML.escape(key));\n\t\t\t\tsb.append('=');\n\t\t\t\tsb.append('\"');\n\t\t\t\tsb.append(XML.escape(value));\n\t\t\t\tsb.append('\"');\n\t\t\t}\n\t\t}\n\t} else {\n\t\ti=1;\n\t}\n\tlength=ja.length();\n\tif(i >= length){\n\t\tsb.append('/');\n\t\tsb.append('>');\n\t} else {\n\t\tsb.append('>');\n\t\tdo{\n\t\t\tobject=ja.get(i);\n\t\t\ti+=1;\n\t\t\tif(object != null){\n\t\t\t\tif(object instanceof String){\n\t\t\t\t\tsb.append(XML.escape(object.toString()));\n\t\t\t\t} else if(object instanceof JSONObject){\n\t\t\t\t\tsb.append(toString((JSONObject)object));\n\t\t\t\t} else if(object instanceof JSONArray){\n\t\t\t\t\tsb.append(toString((JSONArray)object));\n\t\t\t\t}\n\t\t\t}\n\t\t}while(i < length)\n\t\tsb.append('<');\n\t\tsb.append('/');\n\t\tsb.append(tagName);\n\t\tsb.append('>');\n\t}\n\treturn sb.toString();\n}","Original_Lines":60,"Target_Lines":42,"Manual":"public static String toString(JSONArray ja) throws JSONException {\n\tJSONObject jo;\n\tStringBuffer sb=new StringBuffer();\n\ttagName=ja.getString(0);\n\tXML.noSpace(tagName);\n\ttagName=XML.escape(tagName);\n\tsb.append(tagName);\n\tobject=ja.opt(1);\n\tif(object instanceof JSONObject){\n\t\ti=2;\n\t\tjo=(JSONObject)object;\n\t\tkeys=jo.keys();\n\t\twhile(keys.hasNext()){\n\t\t\tkey=keys.next().toString();\n\t\t\tXML.noSpace(key);\n\t\t\tvalue=jo.optString(key);\n\t\t\tif(value != null){\n\t\t\t\tsb.append(XML.escape(key));\n\t\t\t\tsb.append(XML.escape(value));\n\t\t\t}\n\t\t}\n\t} else {\n\t\ti=1;\n\t}\n\tlength=ja.length();\n\tif(i >= length){\n\t} else {\n\t\tdo{\n\t\t\tobject=ja.get(i);\n\t\t\ti+=1;\n\t\t\tif(object != null){\n\t\t\t\tif(object instanceof String){\n\t\t\t\t\tsb.append(XML.escape(object.toString()));\n\t\t\t\t} else if(object instanceof JSONObject){\n\t\t\t\t\tsb.append(toString((JSONObject)object));\n\t\t\t\t} else if(object instanceof JSONArray){\n\t\t\t\t\tsb.append(toString((JSONArray)object));\n\t\t\t\t}\n\t\t\t}\n\t\t}while(i < length)\n\t\tsb.append(tagName);\n\t}\n\treturn sb.toString();\n}","Distance":0.3076923076923077,"Automatic":"public static String toString(JSONArray ja) throws JSONException {\n\tint i;\n\tJSONObject jo;\n\tString key;\n\tIterator keys;\n\tObject object;\n\tStringBuffer sb=new StringBuffer();\n\tString tagName;\n\tString value;\n\ttagName=ja.getString(0);\n\tXML.noSpace(tagName);\n\ttagName=XML.escape(tagName);\n\tobject=ja.opt(1);\n\tif(object instanceof JSONObject){\n\t\tjo=(JSONObject)object;\n\t\tkeys=jo.keys();\n\t\twhile(keys.hasNext()){\n\t\t\tkey=keys.next().toString();\n\t\t\tXML.noSpace(key);\n\t\t\tvalue=jo.optString(key);\n\t\t\tif(value != null){\n\t\t\t\tsb.append(XML.escape(key));\n\t\t\t\tsb.append(XML.escape(value));\n\t\t\t}\n\t\t}\n\t} else {\n\t}\n\tlength=ja.length();\n\tif(i >= length){\n\t} else {\n\t\tdo{\n\t\t\tobject=ja.get(i);\n\t\t\tif(object != null){\n\t\t\t\tif(object instanceof String){\n\t\t\t\t\tsb.append(XML.escape(object.toString()));\n\t\t\t\t} else if(object instanceof JSONObject){\n\t\t\t\t\tsb.append(toString((JSONObject)object));\n\t\t\t\t} else if(object instanceof JSONArray){\n\t\t\t\t\tsb.append(toString((JSONArray)object));\n\t\t\t\t}\n\t\t\t}\n\t\t}while(i < length)\n\t}\n}"},{"Origin":"public static String quote(String string){\n\tif(string == null || string.length() == 0){\n\t\treturn \"\\\"\\\"\";\n\t}\n\tchar b;\n\tchar c=0;\n\tString hhhh;\n\tint i;\n\tint len=string.length();\n\tStringBuffer sb=new StringBuffer(len + 4);\n\tsb.append('\"');\n\tfor (i=0; i < len; i+=1){\n\t\tb=c;\n\t\tc=string.charAt(i);\n\t\tswitch (c){\n\t\tcase '\\\\': \n\t\tcase '\"': \n\t\t\tsb.append('\\\\');\n\t\t\tsb.append(c);\n\t\t\tbreak;\n\t\tcase '/': \n\t\t\tif(b == '<'){\n\t\t\t\tsb.append('\\\\');\n\t\t\t}\n\t\t\tsb.append(c);\n\t\t\tbreak;\n\t\tcase '\\b': \n\t\t\tsb.append(\"\\\\b\");\n\t\t\tbreak;\n\t\tcase '\\t': \n\t\t\tsb.append(\"\\\\t\");\n\t\t\tbreak;\n\t\tcase '\\n': \n\t\t\tsb.append(\"\\\\n\");\n\t\t\tbreak;\n\t\tcase '\\f': \n\t\t\tsb.append(\"\\\\f\");\n\t\t\tbreak;\n\t\tcase '\\r': \n\t\t\tsb.append(\"\\\\r\");\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tif(c < ' ' || (c >= '\\u0080' && c < '\\u00a0') || (c >= '\\u2000' && c < '\\u2100')){\n\t\t\t\thhhh=\"000\" + Integer.toHexString(c);\n\t\t\t\tsb.append(\"\\\\u\" + hhhh.substring(hhhh.length() - 4));\n\t\t\t} else {\n\t\t\t\tsb.append(c);\n\t\t\t}\n\t\t}\n\t}\n\tsb.append('\"');\n\treturn sb.toString();\n}","Original_Lines":51,"Target_Lines":23,"Manual":"public static String quote(String string){\n\tStringBuffer sb=new StringBuffer(len + 4);\n\tfor (i=0; i < len; i+=1){\n\t\tb=c;\n\t\tc=string.charAt(i);\n\t\tswitch (c){\n\t\tcase '\\\\': \n\t\tcase '\"': \n\t\tcase '/': \n\t\tcase '\\b': \n\t\tcase '\\t': \n\t\tcase '\\n': \n\t\tcase '\\f': \n\t\tcase '\\r': \n\t\tdefault:\n\t\t\tif(c < ' ' || (c >= '\\u0080' && c < '\\u00a0') || (c >= '\\u2000' && c < '\\u2100')){\n\t\t\t\thhhh=\"000\" + Integer.toHexString(c);\n\t\t\t\tsb.append(\"\\\\u\" + hhhh.substring(hhhh.length() - 4));\n\t\t\t} else {\n\t\t\t\tsb.append(c);\n\t\t\t}\n\t\t}\n\t}\n\treturn sb.toString();\n}","Distance":0.4166666666666667,"Automatic":"public static String quote(String string){\n\tchar b;\n\tchar c=0;\n\tString hhhh;\n\tint i;\n\tint len=string.length();\n\tStringBuffer sb=new StringBuffer(len + 4);\n\tfor (i=0; i < len; i+=1){\n\t\tswitch (c){\n\t\tcase '\\\\': \n\t\tcase '\"': \n\t\tcase '/': \n\t\tcase '\\b': \n\t\tcase '\\t': \n\t\tcase '\\n': \n\t\tcase '\\f': \n\t\tcase '\\r': \n\t\t}\n\t}\n}"},{"Origin":"public static Object stringToValue(String string){\n\tDouble d;\n\tif(string.equals(\"\")){\n\t\treturn string;\n\t}\n\tif(string.equalsIgnoreCase(\"true\")){\n\t\treturn Boolean.TRUE;\n\t}\n\tif(string.equalsIgnoreCase(\"false\")){\n\t\treturn Boolean.FALSE;\n\t}\n\tif(string.equalsIgnoreCase(\"null\")){\n\t\treturn JSONObject.NULL;\n\t}\n\tchar b=string.charAt(0);\n\tif((b >= '0' && b <= '9') || b == '.' || b == '-' || b == '+'){\n\t\ttry {\n\t\t\tif(string.indexOf('.') > -1 || string.indexOf('e') > -1 || string.indexOf('E') > -1){\n\t\t\t\td=Double.valueOf(string);\n\t\t\t\tif(!d.isInfinite() && !d.isNaN()){\n\t\t\t\t\treturn d;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tLong myLong=new Long(string);\n\t\t\t\tif(myLong.longValue() == myLong.intValue()){\n\t\t\t\t\treturn new Integer(myLong.intValue());\n\t\t\t\t} else {\n\t\t\t\t\treturn myLong;\n\t\t\t\t}\n\t\t\t}\n\t\t} catch (Exception ignore){\n\t\t} \n\t}\n\treturn string;\n}","Original_Lines":33,"Target_Lines":26,"Manual":"public static Object stringToValue(String string){\n\tif(string.equalsIgnoreCase(\"false\")){\n\t\treturn Boolean.FALSE;\n\t}\n\tif(string.equalsIgnoreCase(\"null\")){\n\t\treturn JSONObject.NULL;\n\t}\n\tchar b=string.charAt(0);\n\tif((b >= '0' && b <= '9') || b == '.' || b == '-' || b == '+'){\n\t\ttry {\n\t\t\tif(string.indexOf('.') > -1 || string.indexOf('e') > -1 || string.indexOf('E') > -1){\n\t\t\t\td=Double.valueOf(string);\n\t\t\t\tif(!d.isInfinite() && !d.isNaN()){\n\t\t\t\t\treturn d;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tLong myLong=new Long(string);\n\t\t\t\tif(myLong.longValue() == myLong.intValue()){\n\t\t\t\t\treturn new Integer(myLong.intValue());\n\t\t\t\t} else {\n\t\t\t\t\treturn myLong;\n\t\t\t\t}\n\t\t\t}\n\t\t} catch (Exception ignore){\n\t\t} \n\t}\n\treturn string;\n}","Distance":0.2631578947368421,"Automatic":"public static Object stringToValue(String string){\n\tDouble d;\n\tif(string.equals(\"\")){\n\t\treturn string;\n\t}\n\tif(string.equalsIgnoreCase(\"null\")){\n\t\treturn JSONObject.NULL;\n\t}\n\tchar b=string.charAt(0);\n\tif((b >= '0' && b <= '9') || b == '.' || b == '-' || b == '+'){\n\t\ttry {\n\t\t\tif(string.indexOf('.') > -1 || string.indexOf('e') > -1 || string.indexOf('E') > -1){\n\t\t\t\td=Double.valueOf(string);\n\t\t\t\tif(!d.isInfinite() && !d.isNaN()){\n\t\t\t\t\treturn d;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tLong myLong=new Long(string);\n\t\t\t\tif(myLong.longValue() == myLong.intValue()){\n\t\t\t\t\treturn new Integer(myLong.intValue());\n\t\t\t\t} else {\n\t\t\t\t\treturn myLong;\n\t\t\t\t}\n\t\t\t}\n\t\t} catch (Exception ignore){\n\t\t} \n\t}\n\treturn string;\n}"},{"Origin":"String toString(int indentFactor,int indent) throws JSONException {\n\tint i;\n\tint length=this.length();\n\tif(length == 0){\n\t\treturn \"{}\";\n\t}\n\tIterator keys=this.keys();\n\tint newindent=indent + indentFactor;\n\tObject object;\n\tStringBuffer sb=new StringBuffer(\"{\");\n\tif(length == 1){\n\t\tobject=keys.next();\n\t\tsb.append(quote(object.toString()));\n\t\tsb.append(\": \");\n\t\tsb.append(valueToString(this.map.get(object),indentFactor,indent));\n\t} else {\n\t\twhile(keys.hasNext()){\n\t\t\tobject=keys.next();\n\t\t\tif(sb.length() > 1){\n\t\t\t\tsb.append(\",\\n\");\n\t\t\t} else {\n\t\t\t\tsb.append('\\n');\n\t\t\t}\n\t\t\tfor (i=0; i < newindent; i+=1){\n\t\t\t\tsb.append(' ');\n\t\t\t}\n\t\t\tsb.append(quote(object.toString()));\n\t\t\tsb.append(\": \");\n\t\t\tsb.append(valueToString(this.map.get(object),indentFactor,newindent));\n\t\t}\n\t\tif(sb.length() > 1){\n\t\t\tsb.append('\\n');\n\t\t\tfor (i=0; i < indent; i+=1){\n\t\t\t\tsb.append(' ');\n\t\t\t}\n\t\t}\n\t}\n\tsb.append('}');\n\treturn sb.toString();\n}","Original_Lines":38,"Target_Lines":16,"Manual":"String toString(int indentFactor,int indent) throws JSONException {\n\tIterator keys=this.keys();\n\tint newindent=indent + indentFactor;\n\tStringBuffer sb=new StringBuffer(\"{\");\n\tif(length == 1){\n\t\tobject=keys.next();\n\t\tsb.append(quote(object.toString()));\n\t\tsb.append(valueToString(this.map.get(object),indentFactor,indent));\n\t} else {\n\t\twhile(keys.hasNext()){\n\t\t\tobject=keys.next();\n\t\t\tsb.append(quote(object.toString()));\n\t\t\tsb.append(valueToString(this.map.get(object),indentFactor,newindent));\n\t\t}\n\t}\n\tsb.append('}');\n\treturn sb.toString();\n}","Distance":0.375,"Automatic":"String toString(int indentFactor,int indent) throws JSONException {\n\tint i;\n\tIterator keys=this.keys();\n\tint newindent=indent + indentFactor;\n\tObject object;\n\tStringBuffer sb=new StringBuffer(\"{\");\n\tif(length == 1){\n\t\tobject=keys.next();\n\t\tsb.append(valueToString(this.map.get(object),indentFactor,indent));\n\t} else {\n\t\twhile(keys.hasNext()){\n\t\t\tobject=keys.next();\n\t\t\tsb.append(quote(object.toString()));\n\t\t\tsb.append(\": \");\n\t\t\tsb.append(valueToString(this.map.get(object),indentFactor,newindent));\n\t\t}\n\t}\n}"},{"Origin":"public String nextString(char quote) throws JSONException {\n\tchar c;\n\tStringBuffer sb=new StringBuffer();\n\tfor (; ; ){\n\t\tc=this.next();\n\t\tswitch (c){\n\t\tcase 0: \n\t\tcase '\\n': \n\t\tcase '\\r': \n\t\t\tthrow this.syntaxError(\"Unterminated string\");\n\t\tcase '\\\\': \n\t\t\tc=this.next();\n\t\t\tswitch (c){\n\t\t\tcase 'b': \n\t\t\t\tsb.append('\\b');\n\t\t\t\tbreak;\n\t\t\tcase 't': \n\t\t\t\tsb.append('\\t');\n\t\t\t\tbreak;\n\t\t\tcase 'n': \n\t\t\t\tsb.append('\\n');\n\t\t\t\tbreak;\n\t\t\tcase 'f': \n\t\t\t\tsb.append('\\f');\n\t\t\t\tbreak;\n\t\t\tcase 'r': \n\t\t\t\tsb.append('\\r');\n\t\t\t\tbreak;\n\t\t\tcase 'u': \n\t\t\t\tsb.append((char)Integer.parseInt(this.next(4),16));\n\t\t\t\tbreak;\n\t\t\tcase '\"': \n\t\t\tcase '\\'': \n\t\t\tcase '\\\\': \n\t\t\tcase '/': \n\t\t\t\tsb.append(c);\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tthrow this.syntaxError(\"Illegal escape.\");\n\t\t\t}\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tif(c == quote){\n\t\t\t\treturn sb.toString();\n\t\t\t}\n\t\t\tsb.append(c);\n\t\t}\n\t}\n}","Original_Lines":47,"Target_Lines":31,"Manual":"public String nextString(char quote) throws JSONException {\n\tStringBuffer sb=new StringBuffer();\n\tfor (; ; ){\n\t\tc=this.next();\n\t\tswitch (c){\n\t\tcase 0: \n\t\tcase '\\n': \n\t\tcase '\\r': \n\t\tcase '\\\\': \n\t\t\tc=this.next();\n\t\t\tswitch (c){\n\t\t\tcase 'b': \n\t\t\t\tsb.append('\\b');\n\t\t\t\tbreak;\n\t\t\tcase 't': \n\t\t\tcase 'n': \n\t\t\tcase 'f': \n\t\t\tcase 'r': \n\t\t\tcase 'u': \n\t\t\tcase '\"': \n\t\t\tcase '\\'': \n\t\t\tcase '\\\\': \n\t\t\tcase '/': \n\t\t\tdefault:\n\t\t\t}\n\t\tdefault:\n\t\t\tif(c == quote){\n\t\t\t\treturn sb.toString();\n\t\t\t}\n\t\t\tsb.append(c);\n\t\t}\n\t}\n}","Distance":0.07142857142857142,"Automatic":"public String nextString(char quote) throws JSONException {\n\tchar c;\n\tStringBuffer sb=new StringBuffer();\n\tfor (; ; ){\n\t\tc=this.next();\n\t\tswitch (c){\n\t\tcase 0: \n\t\tcase '\\n': \n\t\tcase '\\r': \n\t\tcase '\\\\': \n\t\t\tswitch (c){\n\t\t\tcase 'b': \n\t\t\t\tsb.append('\\b');\n\t\t\t\tbreak;\n\t\t\tcase 't': \n\t\t\tcase 'n': \n\t\t\tcase 'f': \n\t\t\tcase 'r': \n\t\t\tcase 'u': \n\t\t\tcase '\"': \n\t\t\tcase '\\'': \n\t\t\tcase '\\\\': \n\t\t\tcase '/': \n\t\t\tdefault:\n\t\t\t}\n\t\tdefault:\n\t\t\tif(c == quote){\n\t\t\t\treturn sb.toString();\n\t\t\t}\n\t\t\tsb.append(c);\n\t\t}\n\t}\n}"},{"Origin":"GeneralRange<T> intersect(GeneralRange<T> other){\n\tcheckNotNull(other);\n\tcheckArgument(comparator.equals(other.comparator));\n\tboolean hasLowBound=this.hasLowerBound;\n\t@Nullable T lowEnd=lowerEndpoint;\n\tBoundType lowType=lowerBoundType;\n\tif(!hasLowerBound()){\n\t\thasLowBound=other.hasLowerBound;\n\t\tlowEnd=other.lowerEndpoint;\n\t\tlowType=other.lowerBoundType;\n\t} else if(other.hasLowerBound()){\n\t\tint cmp=comparator.compare(lowerEndpoint,other.lowerEndpoint);\n\t\tif(cmp < 0 || (cmp == 0 && other.lowerBoundType == OPEN)){\n\t\t\tlowEnd=other.lowerEndpoint;\n\t\t\tlowType=other.lowerBoundType;\n\t\t}\n\t}\n\tboolean hasUpBound=this.hasUpperBound;\n\t@Nullable T upEnd=upperEndpoint;\n\tBoundType upType=upperBoundType;\n\tif(!hasUpperBound()){\n\t\thasUpBound=other.hasUpperBound;\n\t\tupEnd=other.upperEndpoint;\n\t\tupType=other.upperBoundType;\n\t} else if(other.hasUpperBound()){\n\t\tint cmp=comparator.compare(upperEndpoint,other.upperEndpoint);\n\t\tif(cmp > 0 || (cmp == 0 && other.upperBoundType == OPEN)){\n\t\t\tupEnd=other.upperEndpoint;\n\t\t\tupType=other.upperBoundType;\n\t\t}\n\t}\n\tif(hasLowBound && hasUpBound){\n\t\tint cmp=comparator.compare(lowEnd,upEnd);\n\t\tif(cmp > 0 || (cmp == 0 && lowType == OPEN && upType == OPEN)){\n\t\t\tlowEnd=upEnd;\n\t\t\tlowType=OPEN;\n\t\t\tupType=CLOSED;\n\t\t}\n\t}\n\treturn new GeneralRange<T>(comparator,hasLowBound,lowEnd,lowType,hasUpBound,upEnd,upType);\n}","Original_Lines":39,"Target_Lines":23,"Manual":"GeneralRange<T> intersect(GeneralRange<T> other){\n\tif(!hasLowerBound()){\n\t\thasLowBound=other.hasLowerBound;\n\t\tlowEnd=other.lowerEndpoint;\n\t\tlowType=other.lowerBoundType;\n\t} else if(other.hasLowerBound()){\n\t\tint cmp=comparator.compare(lowerEndpoint,other.lowerEndpoint);\n\t\tif(cmp < 0 || (cmp == 0 && other.lowerBoundType == OPEN)){\n\t\t\tlowEnd=other.lowerEndpoint;\n\t\t\tlowType=other.lowerBoundType;\n\t\t}\n\t}\n\tif(!hasUpperBound()){\n\t} else if(other.hasUpperBound()){\n\t}\n\tif(hasLowBound && hasUpBound){\n\t\tint cmp=comparator.compare(lowEnd,upEnd);\n\t\tif(cmp > 0 || (cmp == 0 && lowType == OPEN && upType == OPEN)){\n\t\t\tlowEnd=upEnd;\n\t\t\tlowType=OPEN;\n\t\t\tupType=CLOSED;\n\t\t}\n\t}\n\treturn new GeneralRange<T>(comparator,hasLowBound,lowEnd,lowType,hasUpBound,upEnd,upType);\n}","Distance":0.4583333333333333,"Automatic":"GeneralRange<T> intersect(GeneralRange<T> other){\n\tboolean hasLowBound=this.hasLowerBound;\n\tBoundType lowType=lowerBoundType;\n\tif(!hasLowerBound()){\n\t\thasLowBound=other.hasLowerBound;\n\t\tlowEnd=other.lowerEndpoint;\n\t\tlowType=other.lowerBoundType;\n\t} else if(other.hasLowerBound()){\n\t\tif(cmp < 0 || (cmp == 0 && other.lowerBoundType == OPEN)){\n\t\t\tlowEnd=other.lowerEndpoint;\n\t\t\tlowType=other.lowerBoundType;\n\t\t}\n\t}\n\tboolean hasUpBound=this.hasUpperBound;\n\tBoundType upType=upperBoundType;\n\tif(!hasUpperBound()){\n\t\thasUpBound=other.hasUpperBound;\n\t} else if(other.hasUpperBound()){\n\t\tint cmp=comparator.compare(upperEndpoint,other.upperEndpoint);\n\t}\n\tif(hasLowBound && hasUpBound){\n\t\tint cmp=comparator.compare(lowEnd,upEnd);\n\t}\n\treturn new GeneralRange<T>(comparator,hasLowBound,lowEnd,lowType,hasUpBound,upEnd,upType);\n}"},{"Origin":"@GwtIncompatible(\"java.io.ObjectInputStream\") private void readObject(ObjectInputStream stream) throws IOException, ClassNotFoundException {\n\tstream.defaultReadObject();\n\tint keyCount=stream.readInt();\n\tif(keyCount < 0){\n\t\tthrow new InvalidObjectException(\"Invalid key count \" + keyCount);\n\t}\n\tImmutableMap.Builder<Object,ImmutableSet<Object>> builder=ImmutableMap.builder();\n\tint tmpSize=0;\n\tfor (int i=0; i < keyCount; i++){\n\t\tObject key=stream.readObject();\n\t\tint valueCount=stream.readInt();\n\t\tif(valueCount <= 0){\n\t\t\tthrow new InvalidObjectException(\"Invalid value count \" + valueCount);\n\t\t}\n\t\tObject[] array=new Object[valueCount];\n\t\tfor (int j=0; j < valueCount; j++){\n\t\t\tarray[j]=stream.readObject();\n\t\t}\n\t\tImmutableSet<Object> valueSet=ImmutableSet.copyOf(array);\n\t\tif(valueSet.size() != array.length){\n\t\t\tthrow new InvalidObjectException(\"Duplicate key-value pairs exist for key \" + key);\n\t\t}\n\t\tbuilder.put(key,valueSet);\n\t\ttmpSize+=valueCount;\n\t}\n\tImmutableMap<Object,ImmutableSet<Object>> tmpMap;\n\ttry {\n\t\ttmpMap=builder.build();\n\t} catch (IllegalArgumentException e){\n\t\tthrow (InvalidObjectException)new InvalidObjectException(e.getMessage()).initCause(e);\n\t} \n\tFieldSettersHolder.MAP_FIELD_SETTER.set(this,tmpMap);\n\tFieldSettersHolder.SIZE_FIELD_SETTER.set(this,tmpSize);\n}","Original_Lines":32,"Target_Lines":20,"Manual":"@GwtIncompatible(\"java.io.ObjectInputStream\") private void readObject(ObjectInputStream stream) throws IOException, ClassNotFoundException {\n\tint keyCount=stream.readInt();\n\tImmutableMap.Builder<Object,ImmutableSet<Object>> builder=ImmutableMap.builder();\n\tfor (int i=0; i < keyCount; i++){\n\t\tObject key=stream.readObject();\n\t\tint valueCount=stream.readInt();\n\t\tObject[] array=new Object[valueCount];\n\t\tfor (int j=0; j < valueCount; j++){\n\t\t\tarray[j]=stream.readObject();\n\t\t}\n\t\tImmutableSet<Object> valueSet=ImmutableSet.copyOf(array);\n\t\tbuilder.put(key,valueSet);\n\t\ttmpSize+=valueCount;\n\t}\n\tImmutableMap<Object,ImmutableSet<Object>> tmpMap;\n\ttry {\n\t\ttmpMap=builder.build();\n\t} catch (IllegalArgumentException e){\n\t} \n\tFieldSettersHolder.MAP_FIELD_SETTER.set(this,tmpMap);\n\tFieldSettersHolder.SIZE_FIELD_SETTER.set(this,tmpSize);\n}","Distance":0.2631578947368421,"Automatic":"@GwtIncompatible(\"java.io.ObjectInputStream\") private void readObject(ObjectInputStream stream) throws IOException, ClassNotFoundException {\n\tstream.defaultReadObject();\n\tint keyCount=stream.readInt();\n\tif(keyCount < 0){\n\t}\n\tImmutableMap.Builder<Object,ImmutableSet<Object>> builder=ImmutableMap.builder();\n\tint tmpSize=0;\n\tfor (int i=0; i < keyCount; i++){\n\t\tObject key=stream.readObject();\n\t\tint valueCount=stream.readInt();\n\t\tObject[] array=new Object[valueCount];\n\t\tImmutableSet<Object> valueSet=ImmutableSet.copyOf(array);\n\t\tbuilder.put(key,valueSet);\n\t\ttmpSize+=valueCount;\n\t}\n\tImmutableMap<Object,ImmutableSet<Object>> tmpMap;\n\ttry {\n\t\ttmpMap=builder.build();\n\t} catch (IllegalArgumentException e){\n\t} \n\tFieldSettersHolder.MAP_FIELD_SETTER.set(this,tmpMap);\n\tFieldSettersHolder.SIZE_FIELD_SETTER.set(this,tmpSize);\n}"},{"Origin":"private static final void transferStreams(InputStream source,OutputStream destination,String path,IProgressMonitor monitor) throws CoreException {\n\tmonitor=Policy.monitorFor(monitor);\n\ttry {\n\t\tsynchronized (buffer){\n\t\t\twhile(true){\n\t\t\t\tint bytesRead=-1;\n\t\t\t\ttry {\n\t\t\t\t\tbytesRead=source.read(buffer);\n\t\t\t\t} catch (IOException e){\n\t\t\t\t\tString msg=NLS.bind(Messages.failedReadDuringWrite,path);\n\t\t\t\t\tPolicy.error(EFS.ERROR_READ,msg,e);\n\t\t\t\t} \n\t\t\t\tif(bytesRead == -1)\n\t\t\t\t\tbreak;\n\t\t\t\ttry {\n\t\t\t\t\tdestination.write(buffer,0,bytesRead);\n\t\t\t\t} catch (IOException e){\n\t\t\t\t\tString msg=NLS.bind(Messages.couldNotWrite,path);\n\t\t\t\t\tPolicy.error(EFS.ERROR_WRITE,msg,e);\n\t\t\t\t} \n\t\t\t\tmonitor.worked(1);\n\t\t\t}\n\t\t}\n\t} finally {\n\t\tPolicy.safeClose(source);\n\t\tPolicy.safeClose(destination);\n\t} \n}","Original_Lines":26,"Target_Lines":16,"Manual":"private static final void transferStreams(InputStream source,OutputStream destination,String path,IProgressMonitor monitor) throws CoreException {\n\ttry {\n\t\tsynchronized (buffer){\n\t\t\twhile(true){\n\t\t\t\ttry {\n\t\t\t\t\tbytesRead=source.read(buffer);\n\t\t\t\t} catch (IOException e){\n\t\t\t\t} \n\t\t\t\ttry {\n\t\t\t\t\tdestination.write(buffer,0,bytesRead);\n\t\t\t\t} catch (IOException e){\n\t\t\t\t} \n\t\t\t\tmonitor.worked(1);\n\t\t\t}\n\t\t}\n\t} finally {\n\t} \n}","Distance":0.4166666666666667,"Automatic":"private static final void transferStreams(InputStream source,OutputStream destination,String path,IProgressMonitor monitor) throws CoreException {\n\ttry {\n\t\tsynchronized (buffer){\n\t\t\twhile(true){\n\t\t\t\ttry {\n\t\t\t\t\tbytesRead=source.read(buffer);\n\t\t\t\t} catch (IOException e){\n\t\t\t\t\tString msg=NLS.bind(Messages.failedReadDuringWrite,path);\n\t\t\t\t\tPolicy.error(EFS.ERROR_READ,msg,e);\n\t\t\t\t} \n\t\t\t\ttry {\n\t\t\t\t\tdestination.write(buffer,0,bytesRead);\n\t\t\t\t} catch (IOException e){\n\t\t\t\t\tString msg=NLS.bind(Messages.couldNotWrite,path);\n\t\t\t\t\tPolicy.error(EFS.ERROR_WRITE,msg,e);\n\t\t\t\t} \n\t\t\t}\n\t\t}\n\t} finally {\n\t} \n}"},{"Origin":"static AbstractDataTreeNode[] assembleWith(AbstractDataTreeNode[] oldNodes,AbstractDataTreeNode[] newNodes,boolean keepDeleted){\n\tif(newNodes.length == 0)\n\t\treturn oldNodes;\n\tAbstractDataTreeNode[] resultNodes=new AbstractDataTreeNode[oldNodes.length + newNodes.length];\n\tint oldIndex=0;\n\tint newIndex=0;\n\tint resultIndex=0;\n\twhile(oldIndex < oldNodes.length && newIndex < newNodes.length){\n\t\tint compare=oldNodes[oldIndex].name.compareTo(newNodes[newIndex].name);\n\t\tif(compare == 0){\n\t\t\tAbstractDataTreeNode node=oldNodes[oldIndex++].assembleWith(newNodes[newIndex++]);\n\t\t\tif(node != null && (!node.isDeleted() || keepDeleted)){\n\t\t\t\tresultNodes[resultIndex++]=node;\n\t\t\t}\n\t\t} else if(compare < 0){\n\t\t\tresultNodes[resultIndex++]=oldNodes[oldIndex++];\n\t\t} else if(compare > 0){\n\t\t\tAbstractDataTreeNode node=newNodes[newIndex++];\n\t\t\tif(!node.isDeleted() || keepDeleted){\n\t\t\t\tresultNodes[resultIndex++]=node;\n\t\t\t}\n\t\t}\n\t}\n\twhile(oldIndex < oldNodes.length){\n\t\tresultNodes[resultIndex++]=oldNodes[oldIndex++];\n\t}\n\twhile(newIndex < newNodes.length){\n\t\tAbstractDataTreeNode resultNode=newNodes[newIndex++];\n\t\tif(!resultNode.isDeleted() || keepDeleted){\n\t\t\tresultNodes[resultIndex++]=resultNode;\n\t\t}\n\t}\n\tif(resultIndex < resultNodes.length){\n\t\tSystem.arraycopy(resultNodes,0,resultNodes=new AbstractDataTreeNode[resultIndex],0,resultIndex);\n\t}\n\treturn resultNodes;\n}","Original_Lines":35,"Target_Lines":16,"Manual":"static AbstractDataTreeNode[] assembleWith(AbstractDataTreeNode[] oldNodes,AbstractDataTreeNode[] newNodes,boolean keepDeleted){\n\tAbstractDataTreeNode[] resultNodes=new AbstractDataTreeNode[oldNodes.length + newNodes.length];\n\twhile(oldIndex < oldNodes.length && newIndex < newNodes.length){\n\t\tint compare=oldNodes[oldIndex].name.compareTo(newNodes[newIndex].name);\n\t\tif(compare == 0){\n\t\t} else if(compare < 0){\n\t\t} else if(compare > 0){\n\t\t}\n\t}\n\twhile(oldIndex < oldNodes.length){\n\t}\n\twhile(newIndex < newNodes.length){\n\t}\n\tif(resultIndex < resultNodes.length){\n\t\tSystem.arraycopy(resultNodes,0,resultNodes=new AbstractDataTreeNode[resultIndex],0,resultIndex);\n\t}\n\treturn resultNodes;\n}","Distance":0.6111111111111112,"Automatic":"static AbstractDataTreeNode[] assembleWith(AbstractDataTreeNode[] oldNodes,AbstractDataTreeNode[] newNodes,boolean keepDeleted){\n\tif(newNodes.length == 0)\n\tAbstractDataTreeNode[] resultNodes=new AbstractDataTreeNode[oldNodes.length + newNodes.length];\n\tint oldIndex=0;\n\tint newIndex=0;\n\tint resultIndex=0;\n\twhile(oldIndex < oldNodes.length && newIndex < newNodes.length){\n\t\tint compare=oldNodes[oldIndex].name.compareTo(newNodes[newIndex].name);\n\t\tif(compare == 0){\n\t\t\tAbstractDataTreeNode node=oldNodes[oldIndex++].assembleWith(newNodes[newIndex++]);\n\t\t} else if(compare < 0){\n\t\t\tresultNodes[resultIndex++]=oldNodes[oldIndex++];\n\t\t} else if(compare > 0){\n\t\t\tAbstractDataTreeNode node=newNodes[newIndex++];\n\t\t}\n\t}\n\treturn resultNodes;\n}"},{"Origin":"protected static AbstractDataTreeNode[] compareWith(AbstractDataTreeNode[] oldNodes,AbstractDataTreeNode[] newNodes,IComparator comparator){\n\tint oldLen=oldNodes.length;\n\tint newLen=newNodes.length;\n\tint oldIndex=0;\n\tint newIndex=0;\n\tAbstractDataTreeNode[] comparedNodes=new AbstractDataTreeNode[oldLen + newLen];\n\tint count=0;\n\twhile(oldIndex < oldLen && newIndex < newLen){\n\t\tDataTreeNode oldNode=(DataTreeNode)oldNodes[oldIndex];\n\t\tDataTreeNode newNode=(DataTreeNode)newNodes[newIndex];\n\t\tint compare=oldNode.name.compareTo(newNode.name);\n\t\tif(compare < 0){\n\t\t\tint userComparison=comparator.compare(oldNode.getData(),null);\n\t\t\tif(userComparison != 0){\n\t\t\t\tcomparedNodes[count++]=convertToRemovedComparisonNode(oldNode,userComparison);\n\t\t\t}\n\t\t\t++oldIndex;\n\t\t} else if(compare > 0){\n\t\t\tint userComparison=comparator.compare(null,newNode.getData());\n\t\t\tif(userComparison != 0){\n\t\t\t\tcomparedNodes[count++]=convertToAddedComparisonNode(newNode,userComparison);\n\t\t\t}\n\t\t\t++newIndex;\n\t\t} else {\n\t\t\tAbstractDataTreeNode comparedNode=oldNode.compareWith(newNode,comparator);\n\t\t\tNodeComparison comparison=(NodeComparison)comparedNode.getData();\n\t\t\tif(!(comparison.isUnchanged() && comparedNode.size() == 0)){\n\t\t\t\tcomparedNodes[count++]=comparedNode;\n\t\t\t}\n\t\t\t++oldIndex;\n\t\t\t++newIndex;\n\t\t}\n\t}\n\twhile(oldIndex < oldLen){\n\t\tDataTreeNode oldNode=(DataTreeNode)oldNodes[oldIndex++];\n\t\tint userComparison=comparator.compare(oldNode.getData(),null);\n\t\tif(userComparison != 0){\n\t\t\tcomparedNodes[count++]=convertToRemovedComparisonNode(oldNode,userComparison);\n\t\t}\n\t}\n\twhile(newIndex < newLen){\n\t\tDataTreeNode newNode=(DataTreeNode)newNodes[newIndex++];\n\t\tint userComparison=comparator.compare(null,newNode.getData());\n\t\tif(userComparison != 0){\n\t\t\tcomparedNodes[count++]=convertToAddedComparisonNode(newNode,userComparison);\n\t\t}\n\t}\n\tif(count == 0){\n\t\treturn NO_CHILDREN;\n\t}\n\tif(count < comparedNodes.length){\n\t\tSystem.arraycopy(comparedNodes,0,comparedNodes=new AbstractDataTreeNode[count],0,count);\n\t}\n\treturn comparedNodes;\n}","Original_Lines":53,"Target_Lines":21,"Manual":"protected static AbstractDataTreeNode[] compareWith(AbstractDataTreeNode[] oldNodes,AbstractDataTreeNode[] newNodes,IComparator comparator){\n\tAbstractDataTreeNode[] comparedNodes=new AbstractDataTreeNode[oldLen + newLen];\n\twhile(oldIndex < oldLen && newIndex < newLen){\n\t\tDataTreeNode oldNode=(DataTreeNode)oldNodes[oldIndex];\n\t\tDataTreeNode newNode=(DataTreeNode)newNodes[newIndex];\n\t\tint compare=oldNode.name.compareTo(newNode.name);\n\t\tif(compare < 0){\n\t\t} else if(compare > 0){\n\t\t} else {\n\t\t}\n\t}\n\twhile(oldIndex < oldLen){\n\t}\n\twhile(newIndex < newLen){\n\t}\n\tif(count == 0){\n\t\treturn NO_CHILDREN;\n\t}\n\tif(count < comparedNodes.length){\n\t\tSystem.arraycopy(comparedNodes,0,comparedNodes=new AbstractDataTreeNode[count],0,count);\n\t}\n\treturn comparedNodes;\n}","Distance":0.6521739130434783,"Automatic":"protected static AbstractDataTreeNode[] compareWith(AbstractDataTreeNode[] oldNodes,AbstractDataTreeNode[] newNodes,IComparator comparator){\n\tint newIndex=0;\n\tAbstractDataTreeNode[] comparedNodes=new AbstractDataTreeNode[oldLen + newLen];\n\tint count=0;\n\twhile(oldIndex < oldLen && newIndex < newLen){\n\t\tDataTreeNode oldNode=(DataTreeNode)oldNodes[oldIndex];\n\t\tDataTreeNode newNode=(DataTreeNode)newNodes[newIndex];\n\t\tint compare=oldNode.name.compareTo(newNode.name);\n\t\tif(compare < 0){\n\t\t\t++oldIndex;\n\t\t} else if(compare > 0){\n\t\t\tint userComparison=comparator.compare(null,newNode.getData());\n\t\t\t++newIndex;\n\t\t} else {\n\t\t\tAbstractDataTreeNode comparedNode=oldNode.compareWith(newNode,comparator);\n\t\t\tNodeComparison comparison=(NodeComparison)comparedNode.getData();\n\t\t\t++oldIndex;\n\t\t\t++newIndex;\n\t\t}\n\t}\n\twhile(newIndex < newLen){\n\t}\n}"},{"Origin":"public DataTreeLookup lookup(IPath key){\n\tint keyLength=key.segmentCount();\n\tfor (DeltaDataTree tree=this; tree != null; tree=tree.parent){\n\t\tAbstractDataTreeNode node=tree.rootNode;\n\t\tboolean complete=!node.isDelta();\n\t\tfor (int i=0; i < keyLength; i++){\n\t\t\tnode=node.childAtOrNull(key.segment(i));\n\t\t\tif(node == null){\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcomplete|=!node.isDelta();\n\t\t}\n\t\tif(node != null){\n\t\t\tif(node.hasData()){\n\t\t\t\treturn DataTreeLookup.newLookup(key,true,node.getData(),tree == this);\n\t\t\t} else if(node.isDeleted()){\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif(complete){\n\t\t\tbreak;\n\t\t}\n\t}\n\treturn DataTreeLookup.newLookup(key,false,null);\n}","Original_Lines":23,"Target_Lines":16,"Manual":"public DataTreeLookup lookup(IPath key){\n\tfor (DeltaDataTree tree=this; tree != null; tree=tree.parent){\n\t\tAbstractDataTreeNode node=tree.rootNode;\n\t\tboolean complete=!node.isDelta();\n\t\tfor (int i=0; i < keyLength; i++){\n\t\t\tnode=node.childAtOrNull(key.segment(i));\n\t\t\tcomplete|=!node.isDelta();\n\t\t}\n\t\tif(node != null){\n\t\t\tif(node.hasData()){\n\t\t\t\treturn DataTreeLookup.newLookup(key,true,node.getData(),tree == this);\n\t\t\t} else if(node.isDeleted()){\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\treturn DataTreeLookup.newLookup(key,false,null);\n}","Distance":0.15384615384615385,"Automatic":"public DataTreeLookup lookup(IPath key){\n\tint keyLength=key.segmentCount();\n\tfor (DeltaDataTree tree=this; tree != null; tree=tree.parent){\n\t\tAbstractDataTreeNode node=tree.rootNode;\n\t\tfor (int i=0; i < keyLength; i++){\n\t\t\tnode=node.childAtOrNull(key.segment(i));\n\t\t\tcomplete|=!node.isDelta();\n\t\t}\n\t\tif(node != null){\n\t\t\tif(node.hasData()){\n\t\t\t\treturn DataTreeLookup.newLookup(key,true,node.getData(),tree == this);\n\t\t\t} else if(node.isDeleted()){\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\treturn DataTreeLookup.newLookup(key,false,null);\n}"},{"Origin":"public CssProperty order(CssProperty property,StyleSheet style,CssSelectors selector){\n\tpropertyData=new CssProperty[10];\n\tpropertyCount=0;\n\tUtil.verbose(\"CASCADING ORDER \" + property.getPropertyName() + \" in \"+ selector);\n\tfor (Enumeration e=style.getRules().elements(); e.hasMoreElements(); ){\n\t\tCssSelectors context=(CssSelectors)e.nextElement();\n\t\tUtil.verbose(\"######## test with \" + context + \" and \"+ selector);\n\t\tif(context.canApply(selector)){\n\t\t\tCssProperty prop=property.getPropertyInStyle(context.getStyle(),false);\n\t\t\tUtil.verbose(\"%%%%%%%%%%%%%%%%% Found \" + context);\n\t\t\tif(prop != null){\n\t\t\t\taddProperty(prop);\n\t\t\t}\n\t\t}\n\t}\n\tif(propertyCount == 0){\n\t\tif(selector.getNext() != null && property.inherited()){\n\t\t\tUtil.verbose(\"Found nothing ... try the next \" + selector.getNext());\n\t\t\tCssStyle s=style.getStyle(selector.getNext());\n\t\t\tproperty=property.getPropertyInStyle(s,true);\n\t\t}\n\t} else {\n\t\tUtil.verbose(\"@@@@@@@@@@@@@@ FOUND \" + propertyCount + \" properties\");\n\t\tproperty=getProperty(selector);\n\t\tif(property.isSoftlyInherited() && selector.getNext() != null){\n\t\t\tCssStyle s=style.getStyle(selector.getNext());\n\t\t\tproperty=property.getPropertyInStyle(s,true);\n\t\t}\n\t}\n\tproperty=property.duplicate();\n\tproperty.setSelectors(selector);\n\treturn property;\n}","Original_Lines":31,"Target_Lines":18,"Manual":"public CssProperty order(CssProperty property,StyleSheet style,CssSelectors selector){\n\tpropertyData=new CssProperty[10];\n\tpropertyCount=0;\n\tfor (Enumeration e=style.getRules().elements(); e.hasMoreElements(); ){\n\t\tCssSelectors context=(CssSelectors)e.nextElement();\n\t\tif(context.canApply(selector)){\n\t\t}\n\t}\n\tif(propertyCount == 0){\n\t\tif(selector.getNext() != null && property.inherited()){\n\t\t\tCssStyle s=style.getStyle(selector.getNext());\n\t\t}\n\t} else {\n\t\tproperty=getProperty(selector);\n\t\tif(property.isSoftlyInherited() && selector.getNext() != null){\n\t\t\tCssStyle s=style.getStyle(selector.getNext());\n\t\t}\n\t}\n\treturn property;\n}","Distance":0.4,"Automatic":"public CssProperty order(CssProperty property,StyleSheet style,CssSelectors selector){\n\tfor (Enumeration e=style.getRules().elements(); e.hasMoreElements(); ){\n\t\tCssSelectors context=(CssSelectors)e.nextElement();\n\t\tif(context.canApply(selector)){\n\t\t\tCssProperty prop=property.getPropertyInStyle(context.getStyle(),false);\n\t\t}\n\t}\n\tif(propertyCount == 0){\n\t\tif(selector.getNext() != null && property.inherited()){\n\t\t\tCssStyle s=style.getStyle(selector.getNext());\n\t\t}\n\t} else {\n\t\tproperty=getProperty(selector);\n\t\tif(property.isSoftlyInherited() && selector.getNext() != null){\n\t\t\tCssStyle s=style.getStyle(selector.getNext());\n\t\t\tproperty=property.getPropertyInStyle(s,true);\n\t\t}\n\t}\n\tproperty.setSelectors(selector);\n}"},{"Origin":"public void parseURL(ApplContext ac,URL url,String title,String kind,String media,int origin){\n\tsetWarningLevel(ac.getWarningLevel());\n\tif(Util.onDebug){\n\t\tSystem.err.println(\"StyleSheet.parseURL(\" + url + \", \"+ title+ \", \"+ kind+ \", \"+ media+ \", \"+ origin+ \")\");\n\t}\n\tif(kind != null){\n\t\tkind=kind.trim().toLowerCase();\n\t\tif(!kind.equals(\"stylesheet\") && !kind.equals(\"alternate stylesheet\")){\n\t\t\treturn;\n\t\t}\n\t}\n\ttry {\n\t\tac.setOrigin(origin);\n\t\tcssFouffa=new CssFouffa(ac,url);\n\t\tcssFouffa.addListener(this);\n\t\tif(media == null){\n\t\t\tif(ac.getMedium() == null){\n\t\t\t\tmedia=\"all\";\n\t\t\t} else {\n\t\t\t\tmedia=ac.getMedium();\n\t\t\t}\n\t\t}\n\t\tAtRuleMedia m=new AtRuleMedia();\n\t\ttry {\n\t\t\taddMedias(m,media,ac);\n\t\t\tcssFouffa.setAtRule(m);\n\t\t} catch (org.w3c.css.util.InvalidParamException e){\n\t\t\tErrors er=new Errors();\n\t\t\ter.addError(new org.w3c.css.parser.CssError(url.toString(),-1,e));\n\t\t\tnotifyErrors(er);\n\t\t\treturn;\n\t\t} \n\t\tcssFouffa.parseStyle();\n\t} catch (Exception e){\n\t\tErrors er=new Errors();\n\t\ter.addError(new org.w3c.css.parser.CssError(url.toString(),-1,e));\n\t\tnotifyErrors(er);\n\t} \n}","Original_Lines":37,"Target_Lines":20,"Manual":"public void parseURL(ApplContext ac,URL url,String title,String kind,String media,int origin){\n\ttry {\n\t\tac.setOrigin(origin);\n\t\tcssFouffa=new CssFouffa(ac,url);\n\t\tcssFouffa.addListener(this);\n\t\tif(media == null){\n\t\t\tif(ac.getMedium() == null){\n\t\t\t\tmedia=\"all\";\n\t\t\t} else {\n\t\t\t\tmedia=ac.getMedium();\n\t\t\t}\n\t\t}\n\t\tAtRuleMedia m=new AtRuleMedia();\n\t\ttry {\n\t\t\taddMedias(m,media,ac);\n\t\t\tcssFouffa.setAtRule(m);\n\t\t} catch (org.w3c.css.util.InvalidParamException e){\n\t\t} \n\t\tcssFouffa.parseStyle();\n\t} catch (Exception e){\n\t} \n}","Distance":0.13333333333333333,"Automatic":"public void parseURL(ApplContext ac,URL url,String title,String kind,String media,int origin){\n\ttry {\n\t\tac.setOrigin(origin);\n\t\tcssFouffa=new CssFouffa(ac,url);\n\t\tcssFouffa.addListener(this);\n\t\tif(media == null){\n\t\t\tif(ac.getMedium() == null){\n\t\t\t\tmedia=\"all\";\n\t\t\t} else {\n\t\t\t\tmedia=ac.getMedium();\n\t\t\t}\n\t\t}\n\t\tAtRuleMedia m=new AtRuleMedia();\n\t\ttry {\n\t\t\taddMedias(m,media,ac);\n\t\t\tcssFouffa.setAtRule(m);\n\t\t} catch (org.w3c.css.util.InvalidParamException e){\n\t\t\ter.addError(new org.w3c.css.parser.CssError(url.toString(),-1,e));\n\t\t} \n\t\tcssFouffa.parseStyle();\n\t} catch (Exception e){\n\t\ter.addError(new org.w3c.css.parser.CssError(url.toString(),-1,e));\n\t} \n}"},{"Origin":"public void parseStyleElement(ApplContext ac,InputStream input,String title,String media,URL url,int lineno){\n\tstyle.setWarningLevel(ac.getWarningLevel());\n\tif(Util.onDebug){\n\t\tSystem.err.println(\"StyleSheet.parseStyleElement(\" + title + \", \"+ media+ \", \"+ url+ \",\"+ lineno+ \")\");\n\t}\n\ttry {\n\t\tString charset=ac.getCharsetForURL(url);\n\t\tcssFouffa=new CssFouffa(ac,input,charset,url,lineno);\n\t\tcssFouffa.addListener(this);\n\t\tif(media == null){\n\t\t\tmedia=\"all\";\n\t\t}\n\t\tAtRuleMedia m=new AtRuleMedia();\n\t\ttry {\n\t\t\taddMedias(m,media,ac);\n\t\t\tcssFouffa.setAtRule(m);\n\t\t} catch (org.w3c.css.util.InvalidParamException e){\n\t\t\tErrors er=new Errors();\n\t\t\ter.addError(new org.w3c.css.parser.CssError(url.toString(),-1,e));\n\t\t\tnotifyErrors(er);\n\t\t\treturn;\n\t\t} \n\t\tcssFouffa.parseStyle();\n\t} catch (IOException e){\n\t\tErrors er=new Errors();\n\t\ter.addError(new org.w3c.css.parser.CssError(url.toString(),-1,e));\n\t\tnotifyErrors(er);\n\t} catch (TokenMgrError e){\n\t\tErrors er=new Errors();\n\t\tCssParseException cpe=null;\n\t\tif(co != null){\n\t\t\ttry {\n\t\t\t\tObject o[]=new Object[1];\n\t\t\t\to[0]=e;\n\t\t\t\tException new_e=(Exception)co.newInstance(o);\n\t\t\t\tcpe=new CssParseException(new_e);\n\t\t\t} catch (Exception ex){\n\t\t\t\tcpe=null;\n\t\t\t} \n\t\t}\n\t\tif(cpe == null){\n\t\t\tcpe=new CssParseException(new Exception(e.getMessage()));\n\t\t}\n\t\ter.addError(new org.w3c.css.parser.CssError(url.toString(),-1,cpe));\n\t\tnotifyErrors(er);\n\t} catch (RuntimeException e){\n\t\tErrors er=new Errors();\n\t\ter.addError(new org.w3c.css.parser.CssError(url.toString(),cssFouffa.getLine(),new CssParseException(e)));\n\t\tnotifyErrors(er);\n\t} \n}","Original_Lines":49,"Target_Lines":18,"Manual":"public void parseStyleElement(ApplContext ac,InputStream input,String title,String media,URL url,int lineno){\n\ttry {\n\t\tString charset=ac.getCharsetForURL(url);\n\t\tcssFouffa=new CssFouffa(ac,input,charset,url,lineno);\n\t\tcssFouffa.addListener(this);\n\t\tif(media == null){\n\t\t\tmedia=\"all\";\n\t\t}\n\t\tAtRuleMedia m=new AtRuleMedia();\n\t\ttry {\n\t\t\taddMedias(m,media,ac);\n\t\t\tcssFouffa.setAtRule(m);\n\t\t} catch (org.w3c.css.util.InvalidParamException e){\n\t\t} \n\t\tcssFouffa.parseStyle();\n\t} catch (IOException e){\n\t} catch (TokenMgrError e){\n\t} catch (RuntimeException e){\n\t} \n}","Distance":0.5,"Automatic":"public void parseStyleElement(ApplContext ac,InputStream input,String title,String media,URL url,int lineno){\n\ttry {\n\t\tString charset=ac.getCharsetForURL(url);\n\t\tcssFouffa=new CssFouffa(ac,input,charset,url,lineno);\n\t\tcssFouffa.addListener(this);\n\t\tAtRuleMedia m=new AtRuleMedia();\n\t\ttry {\n\t\t\taddMedias(m,media,ac);\n\t\t\tcssFouffa.setAtRule(m);\n\t\t} catch (org.w3c.css.util.InvalidParamException e){\n\t\t\ter.addError(new org.w3c.css.parser.CssError(url.toString(),-1,e));\n\t\t} \n\t} catch (IOException e){\n\t\ter.addError(new org.w3c.css.parser.CssError(url.toString(),-1,e));\n\t} catch (TokenMgrError e){\n\t\tif(co != null){\n\t\t}\n\t\ter.addError(new org.w3c.css.parser.CssError(url.toString(),-1,cpe));\n\t} catch (RuntimeException e){\n\t\ter.addError(new org.w3c.css.parser.CssError(url.toString(),cssFouffa.getLine(),new CssParseException(e)));\n\t} \n}"},{"Origin":"public void parseStyleAttribute(ApplContext ac,InputStream input,String id,URL url,int lineno){\n\tstyle.setWarningLevel(ac.getWarningLevel());\n\tlineno--;\n\tif(Util.onDebug){\n\t\tSystem.err.println(\"StyleSheet.parseStyleAttribute(\" + id + \",\"+ url+ \",\"+ lineno+ \")\");\n\t}\n\ttry {\n\t\tString charset=ac.getCharsetForURL(url);\n\t\tcssFouffa=new CssFouffa(ac,input,charset,url,lineno);\n\t\tcssFouffa.addListener(this);\n\t\tCssSelectors selector=new CssSelectors(ac);\n\t\ttry {\n\t\t\tAtRuleMedia media=new AtRuleMedia();\n\t\t\tmedia.addMedia(\"all\",ac);\n\t\t\tcssFouffa.setAtRule(media);\n\t\t} catch (InvalidParamException e){\n\t\t} \n\t\ttry {\n\t\t\tselector.addId(new IdSelector(id.substring(1)));\n\t\t\t;\n\t\t} catch (InvalidParamException e){\n\t\t\tstyle.removeThisRule();\n\t\t\tac.getFrame().addError(new CssError(e));\n\t\t} \n\t\tcssFouffa.parseDeclarations(selector);\n\t} catch (IOException e){\n\t\tErrors er=new Errors();\n\t\ter.addError(new org.w3c.css.parser.CssError(url.toString(),-1,e));\n\t\tnotifyErrors(er);\n\t} \n}","Original_Lines":29,"Target_Lines":19,"Manual":"public void parseStyleAttribute(ApplContext ac,InputStream input,String id,URL url,int lineno){\n\tlineno--;\n\ttry {\n\t\tString charset=ac.getCharsetForURL(url);\n\t\tcssFouffa=new CssFouffa(ac,input,charset,url,lineno);\n\t\tcssFouffa.addListener(this);\n\t\tCssSelectors selector=new CssSelectors(ac);\n\t\ttry {\n\t\t\tAtRuleMedia media=new AtRuleMedia();\n\t\t\tmedia.addMedia(\"all\",ac);\n\t\t\tcssFouffa.setAtRule(media);\n\t\t} catch (InvalidParamException e){\n\t\t} \n\t\ttry {\n\t\t\tselector.addId(new IdSelector(id.substring(1)));\n\t\t} catch (InvalidParamException e){\n\t\t} \n\t\tcssFouffa.parseDeclarations(selector);\n\t} catch (IOException e){\n\t} \n}","Distance":0.1875,"Automatic":"public void parseStyleAttribute(ApplContext ac,InputStream input,String id,URL url,int lineno){\n\tlineno--;\n\ttry {\n\t\tString charset=ac.getCharsetForURL(url);\n\t\tcssFouffa=new CssFouffa(ac,input,charset,url,lineno);\n\t\tcssFouffa.addListener(this);\n\t\tCssSelectors selector=new CssSelectors(ac);\n\t\ttry {\n\t\t\tAtRuleMedia media=new AtRuleMedia();\n\t\t\tmedia.addMedia(\"all\",ac);\n\t\t\tcssFouffa.setAtRule(media);\n\t\t} catch (InvalidParamException e){\n\t\t} \n\t\ttry {\n\t\t\tselector.addId(new IdSelector(id.substring(1)));\n\t\t} catch (InvalidParamException e){\n\t\t\tstyle.removeThisRule();\n\t\t\tac.getFrame().addError(new CssError(e));\n\t\t} \n\t\tcssFouffa.parseDeclarations(selector);\n\t} catch (IOException e){\n\t\ter.addError(new org.w3c.css.parser.CssError(url.toString(),-1,e));\n\t} \n}"},{"Origin":"public void processingInstruction(String target,String data) throws SAXException {\n\tHashMap<String,String> atts=getValues(data);\n\tif(\"xml-stylesheet\".equals(target)){\n\t\tString rel=atts.get(\"alternate\");\n\t\tString type=atts.get(\"type\");\n\t\tString href=atts.get(\"href\");\n\t\tif(Util.onDebug){\n\t\t\tSystem.err.println(\"<?xml-stylesheet alternate=\\\"\" + rel + \"\\\" type=\\\"\"+ type+ \"\\\"\"+ \"   href=\\\"\"+ href+ \"\\\"?>\");\n\t\t}\n\t\tif(\"yes\".equalsIgnoreCase(rel)){\n\t\t\trel=\"alternate stylesheet\";\n\t\t} else {\n\t\t\trel=\"stylesheet\";\n\t\t}\n\t\tif(href == null){\n\t\t\tint line=-1;\n\t\t\tif(locator != null){\n\t\t\t\tline=locator.getLineNumber();\n\t\t\t}\n\t\t\tCssError er=new CssError(baseURI.toString(),line,new InvalidParamException(\"unrecognized.link\",ac));\n\t\t\tErrors ers=new Errors();\n\t\t\ters.addError(er);\n\t\t\tstyleSheetParser.notifyErrors(ers);\n\t\t}\n\t\tif(href.charAt(0) == '#'){\n\t\t\treturn;\n\t\t}\n\t\tif(type != null){\n\t\t\tMimeType mt=null;\n\t\t\ttry {\n\t\t\t\tnew MimeType(type);\n\t\t\t} catch (Exception ex){\n\t\t\t} \n\t\t\t;\n\t\t\tif(mt != null && (MimeType.TEXT_CSS.match(mt) == MimeType.MATCH_SPECIFIC_SUBTYPE)){\n\t\t\t\tURL url;\n\t\t\t\ttry {\n\t\t\t\t\tif(baseURI != null){\n\t\t\t\t\t\turl=new URL(baseURI,href);\n\t\t\t\t\t} else {\n\t\t\t\t\t\turl=new URL(href);\n\t\t\t\t\t}\n\t\t\t\t} catch (MalformedURLException e){\n\t\t\t\t\treturn;\n\t\t\t\t} \n\t\t\t\tif(Util.onDebug){\n\t\t\t\t\tSystem.err.println(\"[TagSoupStyleSheetHandler::\" + \"initialize(): \" + \"should parse CSS url: \" + url.toString() + \"]\");\n\t\t\t\t}\n\t\t\t\tString media=atts.get(\"media\");\n\t\t\t\tif(media == null){\n\t\t\t\t\tmedia=\"all\";\n\t\t\t\t}\n\t\t\t\tstyleSheetParser.parseURL(ac,url,atts.get(\"title\"),rel,media,StyleSheetOrigin.AUTHOR);\n\t\t\t\tif(Util.onDebug){\n\t\t\t\t\tSystem.err.println(\"[parsed!]\");\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}","Original_Lines":58,"Target_Lines":37,"Manual":"public void processingInstruction(String target,String data) throws SAXException {\n\tHashMap<String,String> atts=getValues(data);\n\tif(\"xml-stylesheet\".equals(target)){\n\t\tString rel=atts.get(\"alternate\");\n\t\tString type=atts.get(\"type\");\n\t\tString href=atts.get(\"href\");\n\t\tif(\"yes\".equalsIgnoreCase(rel)){\n\t\t\trel=\"alternate stylesheet\";\n\t\t} else {\n\t\t\trel=\"stylesheet\";\n\t\t}\n\t\tif(href == null){\n\t\t\tstyleSheetParser.notifyErrors(ers);\n\t\t}\n\t\tif(type != null){\n\t\t\tMimeType mt=null;\n\t\t\ttry {\n\t\t\t\tnew MimeType(type);\n\t\t\t} catch (Exception ex){\n\t\t\t} \n\t\t\tif(mt != null && (MimeType.TEXT_CSS.match(mt) == MimeType.MATCH_SPECIFIC_SUBTYPE)){\n\t\t\t\tURL url;\n\t\t\t\ttry {\n\t\t\t\t\tif(baseURI != null){\n\t\t\t\t\t\turl=new URL(baseURI,href);\n\t\t\t\t\t} else {\n\t\t\t\t\t\turl=new URL(href);\n\t\t\t\t\t}\n\t\t\t\t} catch (MalformedURLException e){\n\t\t\t\t} \n\t\t\t\tString media=atts.get(\"media\");\n\t\t\t\tif(media == null){\n\t\t\t\t\tmedia=\"all\";\n\t\t\t\t}\n\t\t\t\tstyleSheetParser.parseURL(ac,url,atts.get(\"title\"),rel,media,StyleSheetOrigin.AUTHOR);\n\t\t\t}\n\t\t}\n\t}\n}","Distance":0.45454545454545453,"Automatic":"public void processingInstruction(String target,String data) throws SAXException {\n\tHashMap<String,String> atts=getValues(data);\n\tif(\"xml-stylesheet\".equals(target)){\n\t\tString rel=atts.get(\"alternate\");\n\t\tString type=atts.get(\"type\");\n\t\tString href=atts.get(\"href\");\n\t\tif(href == null){\n\t\t\tint line=-1;\n\t\t\tCssError er=new CssError(baseURI.toString(),line,new InvalidParamException(\"unrecognized.link\",ac));\n\t\t\tErrors ers=new Errors();\n\t\t}\n\t\tif(href.charAt(0) == '#'){\n\t\t\treturn;\n\t\t}\n\t\tif(type != null){\n\t\t\tMimeType mt=null;\n\t\t\t;\n\t\t\tif(mt != null && (MimeType.TEXT_CSS.match(mt) == MimeType.MATCH_SPECIFIC_SUBTYPE)){\n\t\t\t\tURL url;\n\t\t\t\ttry {\n\t\t\t\t\tif(baseURI != null){\n\t\t\t\t\t\turl=new URL(baseURI,href);\n\t\t\t\t\t} else {\n\t\t\t\t\t\turl=new URL(href);\n\t\t\t\t\t}\n\t\t\t\t} catch (MalformedURLException e){\n\t\t\t\t\treturn;\n\t\t\t\t} \n\t\t\t\tif(Util.onDebug){\n\t\t\t\t\tSystem.err.println(\"[TagSoupStyleSheetHandler::\" + \"initialize(): \" + \"should parse CSS url: \" + url.toString() + \"]\");\n\t\t\t\t}\n\t\t\t\tString media=atts.get(\"media\");\n\t\t\t\tif(media == null){\n\t\t\t\t\tmedia=\"all\";\n\t\t\t\t}\n\t\t\t\tstyleSheetParser.parseURL(ac,url,atts.get(\"title\"),rel,media,StyleSheetOrigin.AUTHOR);\n\t\t\t}\n\t\t}\n\t}\n}"},{"Origin":"public void startElement(String namespaceURI,String localName,String qName,Attributes atts) throws SAXException {\n\tif(isRoot){\n\t\tthis.namespaceURI=namespaceURI;\n\t\tisRoot=false;\n\t}\n\tif(XHTML_NS.equals(namespaceURI)){\n\t\tif(\"base\".equals(localName)){\n\t\t\tString href=atts.getValue(\"href\");\n\t\t\tif(Util.onDebug){\n\t\t\t\tSystem.err.println(\"BASE href=\\\"\" + href + \"\\\"\");\n\t\t\t}\n\t\t\tif(href != null){\n\t\t\t\ttry {\n\t\t\t\t\tbaseURI=new URL(documentURI,href);\n\t\t\t\t\tdocumentURI=baseURI;\n\t\t\t\t} catch (MalformedURLException e){\n\t\t\t\t\treturn;\n\t\t\t\t} \n\t\t\t}\n\t\t} else if(\"link\".equals(localName)){\n\t\t\tString rel=atts.getValue(\"rel\");\n\t\t\tString type=atts.getValue(\"type\");\n\t\t\tString href=atts.getValue(\"href\");\n\t\t\tif(Util.onDebug){\n\t\t\t\tSystem.err.println(\"link rel=\\\"\" + rel + \"\\\" type=\\\"\"+ type+ \"\\\"\"+ \"   href=\\\"\"+ href+ \"\\\"\");\n\t\t\t}\n\t\t\tif(type == null){\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tMimeType mt=null;\n\t\t\ttry {\n\t\t\t\tmt=new MimeType(type);\n\t\t\t} catch (MimeTypeFormatException mtfe){\n\t\t\t\treturn;\n\t\t\t} \n\t\t\tif(MimeType.TEXT_CSS.match(mt) != MimeType.MATCH_SPECIFIC_SUBTYPE){\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif(href == null){\n\t\t\t\tint line=-1;\n\t\t\t\tif(locator != null){\n\t\t\t\t\tline=locator.getLineNumber();\n\t\t\t\t}\n\t\t\t\tCssError er=new CssError(baseURI.toString(),line,new InvalidParamException(\"unrecognized.link\",ac));\n\t\t\t\tErrors ers=new Errors();\n\t\t\t\ters.addError(er);\n\t\t\t\tstyleSheetParser.notifyErrors(ers);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif((rel != null) && rel.toLowerCase().indexOf(\"stylesheet\") != -1){\n\t\t\t\tURL url;\n\t\t\t\ttry {\n\t\t\t\t\tif(baseURI != null){\n\t\t\t\t\t\turl=new URL(baseURI,href);\n\t\t\t\t\t} else {\n\t\t\t\t\t\turl=new URL(href);\n\t\t\t\t\t}\n\t\t\t\t} catch (MalformedURLException e){\n\t\t\t\t\treturn;\n\t\t\t\t} \n\t\t\t\tif(Util.onDebug){\n\t\t\t\t\tSystem.err.println(\"[TagSoupStyleSheetHandler::initialize(): \" + \"should parse CSS url: \" + url.toString() + \"]\");\n\t\t\t\t}\n\t\t\t\tString media=atts.getValue(\"media\");\n\t\t\t\tif(media == null){\n\t\t\t\t\tmedia=\"all\";\n\t\t\t\t}\n\t\t\t\tstyleSheetParser.parseURL(ac,url,atts.getValue(\"title\"),rel,media,StyleSheetOrigin.AUTHOR);\n\t\t\t\tif(Util.onDebug){\n\t\t\t\t\tSystem.err.println(\"[parsed!]\");\n\t\t\t\t}\n\t\t\t}\n\t\t} else if(\"style\".equals(localName)){\n\t\t\tmedia=atts.getValue(\"media\");\n\t\t\ttype=atts.getValue(\"type\");\n\t\t\ttitle=atts.getValue(\"title\");\n\t\t\tif(media == null){\n\t\t\t\tmedia=\"all\";\n\t\t\t}\n\t\t\tif(Util.onDebug){\n\t\t\t\tSystem.err.println(\"style media=\\\"\" + media + \"\\\" type=\\\"\"+ type+ \"\\\"\"+ \"   title=\\\"\"+ title+ \"\\\"\");\n\t\t\t}\n\t\t\tif(type == null){\n\t\t\t\tint line=-1;\n\t\t\t\tif(locator != null){\n\t\t\t\t\tline=locator.getLineNumber();\n\t\t\t\t}\n\t\t\t\tCssError er=new CssError(baseURI.toString(),line,new InvalidParamException(\"unrecognized.link\",ac));\n\t\t\t\tErrors ers=new Errors();\n\t\t\t\ters.addError(er);\n\t\t\t\tstyleSheetParser.notifyErrors(ers);\n\t\t\t} else {\n\t\t\t\ttry {\n\t\t\t\t\tMimeType mt=new MimeType(type);\n\t\t\t\t\tif(MimeType.TEXT_CSS.match(mt) == MimeType.MATCH_SPECIFIC_SUBTYPE){\n\t\t\t\t\t\ttext.setLength(0);\n\t\t\t\t\t\tinStyle=true;\n\t\t\t\t\t}\n\t\t\t\t} catch (MimeTypeFormatException ex){\n\t\t\t\t} \n\t\t\t}\n\t\t} else if(atts.getValue(\"style\") != null){\n\t\t\tString value=atts.getValue(\"style\");\n\t\t\tif(value != null){\n\t\t\t\tString id=atts.getValue(\"id\");\n\t\t\t\thandleStyleAttribute(value,id);\n\t\t\t}\n\t\t}\n\t} else {\n\t\tString value=atts.getValue(XHTML_NS,\"style\");\n\t\tif(value != null){\n\t\t\tString id=atts.getValue(XHTML_NS,\"id\");\n\t\t\thandleStyleAttribute(value,id);\n\t\t}\n\t}\n}","Original_Lines":114,"Target_Lines":64,"Manual":"public void startElement(String namespaceURI,String localName,String qName,Attributes atts) throws SAXException {\n\tif(isRoot){\n\t\tthis.namespaceURI=namespaceURI;\n\t\tisRoot=false;\n\t}\n\tif(XHTML_NS.equals(namespaceURI)){\n\t\tif(\"base\".equals(localName)){\n\t\t\tif(href != null){\n\t\t\t\ttry {\n\t\t\t\t\tbaseURI=new URL(documentURI,href);\n\t\t\t\t\tdocumentURI=baseURI;\n\t\t\t\t} catch (MalformedURLException e){\n\t\t\t\t} \n\t\t\t}\n\t\t} else if(\"link\".equals(localName)){\n\t\t\tMimeType mt=null;\n\t\t\ttry {\n\t\t\t\tmt=new MimeType(type);\n\t\t\t} catch (MimeTypeFormatException mtfe){\n\t\t\t} \n\t\t\tif((rel != null) && rel.toLowerCase().indexOf(\"stylesheet\") != -1){\n\t\t\t\tURL url;\n\t\t\t\ttry {\n\t\t\t\t\tif(baseURI != null){\n\t\t\t\t\t\turl=new URL(baseURI,href);\n\t\t\t\t\t} else {\n\t\t\t\t\t\turl=new URL(href);\n\t\t\t\t\t}\n\t\t\t\t} catch (MalformedURLException e){\n\t\t\t\t} \n\t\t\t\tString media=atts.getValue(\"media\");\n\t\t\t\tif(media == null){\n\t\t\t\t\tmedia=\"all\";\n\t\t\t\t}\n\t\t\t\tstyleSheetParser.parseURL(ac,url,atts.getValue(\"title\"),rel,media,StyleSheetOrigin.AUTHOR);\n\t\t\t}\n\t\t} else if(\"style\".equals(localName)){\n\t\t\tif(media == null){\n\t\t\t\tmedia=\"all\";\n\t\t\t}\n\t\t\tif(type == null){\n\t\t\t} else {\n\t\t\t\ttry {\n\t\t\t\t\tMimeType mt=new MimeType(type);\n\t\t\t\t\tif(MimeType.TEXT_CSS.match(mt) == MimeType.MATCH_SPECIFIC_SUBTYPE){\n\t\t\t\t\t\ttext.setLength(0);\n\t\t\t\t\t\tinStyle=true;\n\t\t\t\t\t}\n\t\t\t\t} catch (MimeTypeFormatException ex){\n\t\t\t\t} \n\t\t\t}\n\t\t} else if(atts.getValue(\"style\") != null){\n\t\t\tString value=atts.getValue(\"style\");\n\t\t\tif(value != null){\n\t\t\t\tString id=atts.getValue(\"id\");\n\t\t\t\thandleStyleAttribute(value,id);\n\t\t\t}\n\t\t}\n\t} else {\n\t\tString value=atts.getValue(XHTML_NS,\"style\");\n\t\tif(value != null){\n\t\t\tString id=atts.getValue(XHTML_NS,\"id\");\n\t\t\thandleStyleAttribute(value,id);\n\t\t}\n\t}\n}","Distance":0.35185185185185186,"Automatic":"public void startElement(String namespaceURI,String localName,String qName,Attributes atts) throws SAXException {\n\tif(XHTML_NS.equals(namespaceURI)){\n\t\tif(\"base\".equals(localName)){\n\t\t\tString href=atts.getValue(\"href\");\n\t\t\tif(href != null){\n\t\t\t\ttry {\n\t\t\t\t\tbaseURI=new URL(documentURI,href);\n\t\t\t\t\tdocumentURI=baseURI;\n\t\t\t\t} catch (MalformedURLException e){\n\t\t\t\t} \n\t\t\t}\n\t\t} else if(\"link\".equals(localName)){\n\t\t\tString rel=atts.getValue(\"rel\");\n\t\t\tString type=atts.getValue(\"type\");\n\t\t\tString href=atts.getValue(\"href\");\n\t\t\tMimeType mt=null;\n\t\t\ttry {\n\t\t\t\tmt=new MimeType(type);\n\t\t\t} catch (MimeTypeFormatException mtfe){\n\t\t\t} \n\t\t\tif(href == null){\n\t\t\t\tCssError er=new CssError(baseURI.toString(),line,new InvalidParamException(\"unrecognized.link\",ac));\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif((rel != null) && rel.toLowerCase().indexOf(\"stylesheet\") != -1){\n\t\t\t\tURL url;\n\t\t\t\ttry {\n\t\t\t\t\tif(baseURI != null){\n\t\t\t\t\t\turl=new URL(baseURI,href);\n\t\t\t\t\t} else {\n\t\t\t\t\t\turl=new URL(href);\n\t\t\t\t\t}\n\t\t\t\t} catch (MalformedURLException e){\n\t\t\t\t} \n\t\t\t\tString media=atts.getValue(\"media\");\n\t\t\t\tstyleSheetParser.parseURL(ac,url,atts.getValue(\"title\"),rel,media,StyleSheetOrigin.AUTHOR);\n\t\t\t}\n\t\t} else if(\"style\".equals(localName)){\n\t\t\tmedia=atts.getValue(\"media\");\n\t\t\ttype=atts.getValue(\"type\");\n\t\t\ttitle=atts.getValue(\"title\");\n\t\t\tif(type == null){\n\t\t\t\tint line=-1;\n\t\t\t\tCssError er=new CssError(baseURI.toString(),line,new InvalidParamException(\"unrecognized.link\",ac));\n\t\t\t\tErrors ers=new Errors();\n\t\t\t} else {\n\t\t\t\ttry {\n\t\t\t\t\tMimeType mt=new MimeType(type);\n\t\t\t\t\tif(MimeType.TEXT_CSS.match(mt) == MimeType.MATCH_SPECIFIC_SUBTYPE){\n\t\t\t\t\t\ttext.setLength(0);\n\t\t\t\t\t\tinStyle=true;\n\t\t\t\t\t}\n\t\t\t\t} catch (MimeTypeFormatException ex){\n\t\t\t\t} \n\t\t\t}\n\t\t} else if(atts.getValue(\"style\") != null){\n\t\t\tString value=atts.getValue(\"style\");\n\t\t\tif(value != null){\n\t\t\t\tString id=atts.getValue(\"id\");\n\t\t\t\thandleStyleAttribute(value,id);\n\t\t\t}\n\t\t}\n\t} else {\n\t\tString value=atts.getValue(XHTML_NS,\"style\");\n\t\tif(value != null){\n\t\t\tString id=atts.getValue(XHTML_NS,\"id\");\n\t\t\thandleStyleAttribute(value,id);\n\t\t}\n\t}\n}"},{"Origin":"public void handleImport(URL url,String file,boolean is_url,AtRuleMedia media){\n\tAtRuleImport importrule=new AtRuleImport(file,is_url,media);\n\tnewAtRule(importrule);\n\tendOfAtRule();\n\tif(url.getProtocol().equals(\"file\")){\n\t\tac.getFrame().addWarning(\"unsupported-import\");\n\t\treturn;\n\t}\n\ttry {\n\t\tURL importedURL=HTTPURL.getURL(url,file);\n\t\tString surl=importedURL.toString();\n\t\tif(visited == null){\n\t\t\tvisited=new Vector<String>(2);\n\t\t} else {\n\t\t\tif(visited.contains(surl)){\n\t\t\t\tCssError cerr=new CssError(new Exception(\"Import loop\" + \" detected in \" + surl));\n\t\t\t\tac.getFrame().addError(cerr);\n\t\t\t\treturn;\n\t\t\t} else if(visited.size() > 42){\n\t\t\t\tCssError cerr=new CssError(new Exception(\"Maximum number\" + \" of imports \" + \"reached\"));\n\t\t\t\tac.getFrame().addError(cerr);\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\tVector<String> newVisited=new Vector<String>(visited);\n\t\tnewVisited.addElement(surl);\n\t\tif(Util.importSecurity){\n\t\t\tthrow new FileNotFoundException(\"[SECURITY] You can't \" + \"import URL sorry.\");\n\t\t}\n\t\tURLConnection importURL=HTTPURL.getConnection(importedURL,ac);\n\t\tString charset=HTTPURL.getCharacterEncoding(ac,importURL);\n\t\tif(importURL instanceof HttpURLConnection){\n\t\t\tHttpURLConnection httpURL=(HttpURLConnection)importURL;\n\t\t\tString httpCL=httpURL.getHeaderField(\"Content-Location\");\n\t\t\tif(httpCL != null){\n\t\t\t\timportedURL=HTTPURL.getURL(importedURL,httpCL);\n\t\t\t}\n\t\t\tString mtype=httpURL.getContentType();\n\t\t\tif(mtype == null){\n\t\t\t\tthrow new FileNotFoundException(importURL.getURL() + \"No Media Type defined\");\n\t\t\t} else {\n\t\t\t\tif(mtype.toLowerCase().indexOf(\"text/html\") != -1){\n\t\t\t\t\tthrow new FileNotFoundException(importURL.getURL() + \": You can't import\" + \" an HTML document\");\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tFrame f=ac.getFrame();\n\t\ttry {\n\t\t\tCssFouffa cssFouffa=new CssFouffa(ac,HTTPURL.getInputStream(ac,importURL),importedURL,listeners,newVisited,properties,mode);\n\t\t\tcssFouffa.setOrigin(getOrigin());\n\t\t\tif(!media.isEmpty()){\n\t\t\t\tcssFouffa.setAtRule(media);\n\t\t\t} else {\n\t\t\t\tcssFouffa.setAtRule(getAtRule());\n\t\t\t}\n\t\t\tcssFouffa.parseStyle();\n\t\t} finally {\n\t\t\tac.setFrame(f);\n\t\t} \n\t} catch (Exception e){\n\t\tif(!Util.noErrorTrace){\n\t\t\tac.getFrame().addError(new CssError(e));\n\t\t}\n\t} \n}","Original_Lines":63,"Target_Lines":37,"Manual":"public void handleImport(URL url,String file,boolean is_url,AtRuleMedia media){\n\tAtRuleImport importrule=new AtRuleImport(file,is_url,media);\n\tnewAtRule(importrule);\n\tendOfAtRule();\n\ttry {\n\t\tURL importedURL=HTTPURL.getURL(url,file);\n\t\tString surl=importedURL.toString();\n\t\tif(visited == null){\n\t\t\tvisited=new Vector<String>(2);\n\t\t} else {\n\t\t}\n\t\tVector<String> newVisited=new Vector<String>(visited);\n\t\tnewVisited.addElement(surl);\n\t\tURLConnection importURL=HTTPURL.getConnection(importedURL,ac);\n\t\tString charset=HTTPURL.getCharacterEncoding(ac,importURL);\n\t\tif(importURL instanceof HttpURLConnection){\n\t\t\tHttpURLConnection httpURL=(HttpURLConnection)importURL;\n\t\t\tString httpCL=httpURL.getHeaderField(\"Content-Location\");\n\t\t\tif(httpCL != null){\n\t\t\t\timportedURL=HTTPURL.getURL(importedURL,httpCL);\n\t\t\t}\n\t\t\tString mtype=httpURL.getContentType();\n\t\t}\n\t\tFrame f=ac.getFrame();\n\t\ttry {\n\t\t\tCssFouffa cssFouffa=new CssFouffa(ac,HTTPURL.getInputStream(ac,importURL),importedURL,listeners,newVisited,properties,mode);\n\t\t\tcssFouffa.setOrigin(getOrigin());\n\t\t\tif(!media.isEmpty()){\n\t\t\t\tcssFouffa.setAtRule(media);\n\t\t\t} else {\n\t\t\t\tcssFouffa.setAtRule(getAtRule());\n\t\t\t}\n\t\t\tcssFouffa.parseStyle();\n\t\t} finally {\n\t\t\tac.setFrame(f);\n\t\t} \n\t} catch (Exception e){\n\t} \n}","Distance":0.22580645161290322,"Automatic":"public void handleImport(URL url,String file,boolean is_url,AtRuleMedia media){\n\tAtRuleImport importrule=new AtRuleImport(file,is_url,media);\n\ttry {\n\t\tURL importedURL=HTTPURL.getURL(url,file);\n\t\tString surl=importedURL.toString();\n\t\tif(visited == null){\n\t\t\tvisited=new Vector<String>(2);\n\t\t} else {\n\t\t\tif(visited.contains(surl)){\n\t\t\t\treturn;\n\t\t\t} else if(visited.size() > 42){\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\tVector<String> newVisited=new Vector<String>(visited);\n\t\tnewVisited.addElement(surl);\n\t\tURLConnection importURL=HTTPURL.getConnection(importedURL,ac);\n\t\tString charset=HTTPURL.getCharacterEncoding(ac,importURL);\n\t\tif(importURL instanceof HttpURLConnection){\n\t\t\tHttpURLConnection httpURL=(HttpURLConnection)importURL;\n\t\t\tString httpCL=httpURL.getHeaderField(\"Content-Location\");\n\t\t\tif(httpCL != null){\n\t\t\t\timportedURL=HTTPURL.getURL(importedURL,httpCL);\n\t\t\t}\n\t\t\tString mtype=httpURL.getContentType();\n\t\t}\n\t\ttry {\n\t\t\tCssFouffa cssFouffa=new CssFouffa(ac,HTTPURL.getInputStream(ac,importURL),importedURL,listeners,newVisited,properties,mode);\n\t\t\tcssFouffa.setOrigin(getOrigin());\n\t\t\tif(!media.isEmpty()){\n\t\t\t\tcssFouffa.setAtRule(media);\n\t\t\t} else {\n\t\t\t\tcssFouffa.setAtRule(getAtRule());\n\t\t\t}\n\t\t\tcssFouffa.parseStyle();\n\t\t} finally {\n\t\t\tac.setFrame(f);\n\t\t} \n\t} catch (Exception e){\n\t} \n}"},{"Origin":"public CssProperty handleDeclaration(String property,CssExpression expression,boolean important) throws InvalidParamException {\n\tCssProperty prop;\n\tif(Util.onDebug){\n\t\tSystem.err.println(\"Creating \" + property + \": \"+ expression);\n\t}\n\ttry {\n\t\tif(getMediaDeclaration().equals(\"on\") && (getAtRule() instanceof AtRuleMedia)){\n\t\t\tprop=properties.createMediaFeature(ac,getAtRule(),property,expression);\n\t\t} else {\n\t\t\tprop=properties.createProperty(ac,getAtRule(),property,expression);\n\t\t}\n\t} catch (InvalidParamException e){\n\t\tthrow e;\n\t} catch (Exception e){\n\t\tif(Util.onDebug){\n\t\t\te.printStackTrace();\n\t\t}\n\t\tthrow new InvalidParamException(e.toString(),ac);\n\t} \n\tif(important){\n\t\tprop.setImportant();\n\t}\n\tprop.setOrigin(origin);\n\tprop.setInfo(ac.getFrame().getLine(),ac.getFrame().getSourceFile());\n\treturn prop;\n}","Original_Lines":24,"Target_Lines":10,"Manual":"public CssProperty handleDeclaration(String property,CssExpression expression,boolean important) throws InvalidParamException {\n\ttry {\n\t\tif(getMediaDeclaration().equals(\"on\") && (getAtRule() instanceof AtRuleMedia)){\n\t\t\tprop=properties.createMediaFeature(ac,getAtRule(),property,expression);\n\t\t} else {\n\t\t\tprop=properties.createProperty(ac,getAtRule(),property,expression);\n\t\t}\n\t} catch (InvalidParamException e){\n\t} catch (Exception e){\n\t} \n\treturn prop;\n}","Distance":0.16666666666666666,"Automatic":"public CssProperty handleDeclaration(String property,CssExpression expression,boolean important) throws InvalidParamException {\n\tCssProperty prop;\n\ttry {\n\t\tif(getMediaDeclaration().equals(\"on\") && (getAtRule() instanceof AtRuleMedia)){\n\t\t\tprop=properties.createMediaFeature(ac,getAtRule(),property,expression);\n\t\t} else {\n\t\t\tprop=properties.createProperty(ac,getAtRule(),property,expression);\n\t\t}\n\t} catch (InvalidParamException e){\n\t} catch (Exception e){\n\t} \n\treturn prop;\n}"},{"Origin":"public synchronized CssProperty createMediaFeature(ApplContext ac,AtRule atRule,String property,CssExpression expression) throws Exception {\n\tString media=atRule.toString();\n\tint pos=-1;\n\tint pos2=media.toUpperCase().indexOf(\"AND\");\n\tif(pos2 == -1){\n\t\tpos2=media.length();\n\t}\n\tif(media.toUpperCase().indexOf(\"NOT\") != -1){\n\t\tpos=media.toUpperCase().indexOf(\"NOT\");\n\t\tmedia=media.substring(pos + 4,pos2);\n\t} else if(media.toUpperCase().indexOf(\"ONLY\") != -1){\n\t\tpos=media.toUpperCase().indexOf(\"ONLY\");\n\t\tmedia=media.substring(pos + 4,pos2);\n\t} else {\n\t\tpos=media.indexOf(\" \");\n\t\tmedia=media.substring(pos + 1,pos2);\n\t}\n\tmedia=media.trim();\n\tString classname=properties.getProperty(\"mediafeature\" + \".\" + property);\n\tif(classname == null){\n\t\tif(atRule instanceof AtRuleMedia && (!media.equals(\"all\"))){\n\t\t\tthrow new InvalidParamException(\"noexistence-media\",property,media,ac);\n\t\t} else {\n\t\t\tthrow new InvalidParamException(\"noexistence\",property,media,ac);\n\t\t}\n\t}\n\ttry {\n\t\tClass expressionclass=CssExpression.class;\n\t\tif(expression != null){\n\t\t\texpressionclass=expression.getClass();\n\t\t}\n\t\tClass[] parametersType={ac.getClass(),expressionclass};\n\t\tConstructor constructor=Class.forName(classname).getConstructor(parametersType);\n\t\tObject[] parameters={ac,expression};\n\t\treturn (CssProperty)constructor.newInstance(parameters);\n\t} catch (InvocationTargetException e){\n\t\tInvocationTargetException iv=e;\n\t\tException ex=(Exception)iv.getTargetException();\n\t\tthrow ex;\n\t} \n}","Original_Lines":39,"Target_Lines":29,"Manual":"public synchronized CssProperty createMediaFeature(ApplContext ac,AtRule atRule,String property,CssExpression expression) throws Exception {\n\tString media=atRule.toString();\n\tint pos=-1;\n\tint pos2=media.toUpperCase().indexOf(\"AND\");\n\tif(pos2 == -1){\n\t\tpos2=media.length();\n\t}\n\tif(media.toUpperCase().indexOf(\"NOT\") != -1){\n\t\tpos=media.toUpperCase().indexOf(\"NOT\");\n\t\tmedia=media.substring(pos + 4,pos2);\n\t} else if(media.toUpperCase().indexOf(\"ONLY\") != -1){\n\t\tpos=media.toUpperCase().indexOf(\"ONLY\");\n\t\tmedia=media.substring(pos + 4,pos2);\n\t} else {\n\t\tpos=media.indexOf(\" \");\n\t\tmedia=media.substring(pos + 1,pos2);\n\t}\n\tmedia=media.trim();\n\tString classname=properties.getProperty(\"mediafeature\" + \".\" + property);\n\ttry {\n\t\tClass expressionclass=CssExpression.class;\n\t\tif(expression != null){\n\t\t\texpressionclass=expression.getClass();\n\t\t}\n\t\tClass[] parametersType={ac.getClass(),expressionclass};\n\t\tConstructor constructor=Class.forName(classname).getConstructor(parametersType);\n\t\tObject[] parameters={ac,expression};\n\t\treturn (CssProperty)constructor.newInstance(parameters);\n\t} catch (InvocationTargetException e){\n\t} \n}","Distance":0.19230769230769232,"Automatic":"public synchronized CssProperty createMediaFeature(ApplContext ac,AtRule atRule,String property,CssExpression expression) throws Exception {\n\tString media=atRule.toString();\n\tint pos=-1;\n\tint pos2=media.toUpperCase().indexOf(\"AND\");\n\tif(media.toUpperCase().indexOf(\"NOT\") != -1){\n\t\tpos=media.toUpperCase().indexOf(\"NOT\");\n\t\tmedia=media.substring(pos + 4,pos2);\n\t} else if(media.toUpperCase().indexOf(\"ONLY\") != -1){\n\t\tpos=media.toUpperCase().indexOf(\"ONLY\");\n\t\tmedia=media.substring(pos + 4,pos2);\n\t} else {\n\t\tpos=media.indexOf(\" \");\n\t\tmedia=media.substring(pos + 1,pos2);\n\t}\n\tmedia=media.trim();\n\tString classname=properties.getProperty(\"mediafeature\" + \".\" + property);\n\tif(classname == null){\n\t}\n\ttry {\n\t\tClass expressionclass=CssExpression.class;\n\t\tif(expression != null){\n\t\t\texpressionclass=expression.getClass();\n\t\t}\n\t\tClass[] parametersType={ac.getClass(),expressionclass};\n\t\tConstructor constructor=Class.forName(classname).getConstructor(parametersType);\n\t\tObject[] parameters={ac,expression};\n\t\treturn (CssProperty)constructor.newInstance(parameters);\n\t} catch (InvocationTargetException e){\n\t\tInvocationTargetException iv=e;\n\t\tException ex=(Exception)iv.getTargetException();\n\t} \n}"},{"Origin":"public synchronized CssProperty createProperty(ApplContext ac,AtRule atRule,String property,CssExpression expression) throws Exception {\n\tString classname=null;\n\tString media=atRule.toString();\n\tint pos=-1;\n\tString upperMedia=media.toUpperCase();\n\tint pos2=upperMedia.indexOf(\"AND \");\n\tif(pos2 == -1){\n\t\tpos2=media.length();\n\t}\n\tif((pos=upperMedia.indexOf(\"NOT\")) != -1){\n\t\tmedia=media.substring(pos + 4,pos2);\n\t} else if((pos=upperMedia.indexOf(\"ONLY\")) != -1){\n\t\tmedia=media.substring(pos + 4,pos2);\n\t} else {\n\t\tpos=media.indexOf(' ');\n\t\tmedia=media.substring(pos + 1,pos2);\n\t}\n\tmedia=media.trim();\n\tclassname=setClassName(atRule,media,ac,property);\n\tif(classname == null){\n\t\tArrayList<String> pfsOk=new ArrayList<String>();\n\t\tfor (int i=0; i < SORTEDPROFILES.length; ++i){\n\t\t\tString p=String.valueOf(SORTEDPROFILES[i]);\n\t\t\tif(!p.equals(ac.getCssVersion()) && PropertiesLoader.getProfile(p).containsKey(property)){\n\t\t\t\tpfsOk.add(p);\n\t\t\t}\n\t\t}\n\t\tif(pfsOk.size() > 0){\n\t\t\tthrow new InvalidParamException(\"noexistence\",new String[]{property,ac.getMsg().getString(ac.getCssVersion()),pfsOk.toString()},ac);\n\t\t} else {\n\t\t\tthrow new InvalidParamException(\"noexistence-at-all\",property,ac);\n\t\t}\n\t}\n\tCssIdent initial=new CssIdent(\"initial\");\n\ttry {\n\t\tif(expression.getValue().equals(initial) && ac.getCssVersion().equals(\"css3\")){\n\t\t\tClass[] parametersType={};\n\t\t\tConstructor constructor=Class.forName(classname).getConstructor(parametersType);\n\t\t\tObject[] parameters={};\n\t\t\treturn (CssProperty)constructor.newInstance(parameters);\n\t\t} else {\n\t\t\tClass[] parametersType={ac.getClass(),expression.getClass(),boolean.class};\n\t\t\tConstructor constructor=Class.forName(classname).getConstructor(parametersType);\n\t\t\tObject[] parameters={ac,expression,Boolean.TRUE};\n\t\t\treturn (CssProperty)constructor.newInstance(parameters);\n\t\t}\n\t} catch (InvocationTargetException e){\n\t\tInvocationTargetException iv=e;\n\t\tException ex=(Exception)iv.getTargetException();\n\t\tthrow ex;\n\t} \n}","Original_Lines":50,"Target_Lines":33,"Manual":"public synchronized CssProperty createProperty(ApplContext ac,AtRule atRule,String property,CssExpression expression) throws Exception {\n\tString classname=null;\n\tString media=atRule.toString();\n\tint pos=-1;\n\tString upperMedia=media.toUpperCase();\n\tint pos2=upperMedia.indexOf(\"AND \");\n\tif(pos2 == -1){\n\t\tpos2=media.length();\n\t}\n\tif((pos=upperMedia.indexOf(\"NOT\")) != -1){\n\t\tmedia=media.substring(pos + 4,pos2);\n\t} else if((pos=upperMedia.indexOf(\"ONLY\")) != -1){\n\t\tmedia=media.substring(pos + 4,pos2);\n\t} else {\n\t\tpos=media.indexOf(' ');\n\t\tmedia=media.substring(pos + 1,pos2);\n\t}\n\tmedia=media.trim();\n\tclassname=setClassName(atRule,media,ac,property);\n\tCssIdent initial=new CssIdent(\"initial\");\n\ttry {\n\t\tif(expression.getValue().equals(initial) && ac.getCssVersion().equals(\"css3\")){\n\t\t\tClass[] parametersType={};\n\t\t\tConstructor constructor=Class.forName(classname).getConstructor(parametersType);\n\t\t\tObject[] parameters={};\n\t\t\treturn (CssProperty)constructor.newInstance(parameters);\n\t\t} else {\n\t\t\tClass[] parametersType={ac.getClass(),expression.getClass(),boolean.class};\n\t\t\tConstructor constructor=Class.forName(classname).getConstructor(parametersType);\n\t\t\tObject[] parameters={ac,expression,Boolean.TRUE};\n\t\t\treturn (CssProperty)constructor.newInstance(parameters);\n\t\t}\n\t} catch (InvocationTargetException e){\n\t} \n}","Distance":0.20689655172413793,"Automatic":"public synchronized CssProperty createProperty(ApplContext ac,AtRule atRule,String property,CssExpression expression) throws Exception {\n\tString classname=null;\n\tString media=atRule.toString();\n\tint pos=-1;\n\tString upperMedia=media.toUpperCase();\n\tint pos2=upperMedia.indexOf(\"AND \");\n\tif((pos=upperMedia.indexOf(\"NOT\")) != -1){\n\t\tmedia=media.substring(pos + 4,pos2);\n\t} else if((pos=upperMedia.indexOf(\"ONLY\")) != -1){\n\t\tmedia=media.substring(pos + 4,pos2);\n\t} else {\n\t\tpos=media.indexOf(' ');\n\t\tmedia=media.substring(pos + 1,pos2);\n\t}\n\tmedia=media.trim();\n\tclassname=setClassName(atRule,media,ac,property);\n\tif(classname == null){\n\t\tfor (int i=0; i < SORTEDPROFILES.length; ++i){\n\t\t\tString p=String.valueOf(SORTEDPROFILES[i]);\n\t\t}\n\t}\n\ttry {\n\t\tif(expression.getValue().equals(initial) && ac.getCssVersion().equals(\"css3\")){\n\t\t\tClass[] parametersType={};\n\t\t\tConstructor constructor=Class.forName(classname).getConstructor(parametersType);\n\t\t\tObject[] parameters={};\n\t\t\treturn (CssProperty)constructor.newInstance(parameters);\n\t\t} else {\n\t\t\tClass[] parametersType={ac.getClass(),expression.getClass(),boolean.class};\n\t\t\tConstructor constructor=Class.forName(classname).getConstructor(parametersType);\n\t\t\tObject[] parameters={ac,expression,Boolean.TRUE};\n\t\t\treturn (CssProperty)constructor.newInstance(parameters);\n\t\t}\n\t} catch (InvocationTargetException e){\n\t} \n}"},{"Origin":"public ColorProfile(ApplContext ac,CssExpression expression,boolean check) throws InvalidParamException {\n\tchar op=SPACE;\n\tCssValue val=expression.getValue();\n\tint counter=0;\n\tboolean correct=true;\n\tString errorval=new String();\n\tif(val.equals(inherit)){\n\t\tvalue=inherit;\n\t\texpression.next();\n\t} else if(val.equals(auto)){\n\t\tvalue=none;\n\t\texpression.next();\n\t} else if(val.equals(sRGB)){\n\t\tvalue=sRGB;\n\t\texpression.next();\n\t} else {\n\t\twhile((op == SPACE) && (counter < expression.getCount() && correct == true)){\n\t\t\tif(val instanceof CssURL){\n\t\t\t\tvalues.addElement(val);\n\t\t\t} else if(val instanceof CssFunction){\n\t\t\t\tif(((CssFunction)val).getName().equals(\"local\")){\n\t\t\t\t\tif((((CssFunction)val).getParameters().getCount() == 1) && (((CssFunction)val).getParameters().getValue() instanceof CssURL)){\n\t\t\t\t\t\tvalues.addElement(val);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcorrect=false;\n\t\t\t\t\t\terrorval=val.toString();\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tcorrect=false;\n\t\t\t\t\terrorval=val.toString();\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tcorrect=false;\n\t\t\t\terrorval=val.toString();\n\t\t\t}\n\t\t\texpression.next();\n\t\t\tcounter++;\n\t\t\tval=expression.getValue();\n\t\t\top=expression.getOperator();\n\t\t}\n\t\tif(!correct){\n\t\t\tthrow new InvalidParamException(\"value\",val.toString(),getPropertyName(),ac);\n\t\t}\n\t}\n}","Original_Lines":43,"Target_Lines":21,"Manual":"public ColorProfile(ApplContext ac,CssExpression expression,boolean check) throws InvalidParamException {\n\tchar op=SPACE;\n\tCssValue val=expression.getValue();\n\tint counter=0;\n\tboolean correct=true;\n\tString errorval=new String();\n\tif(val.equals(inherit)){\n\t} else if(val.equals(auto)){\n\t} else if(val.equals(sRGB)){\n\t} else {\n\t\twhile((op == SPACE) && (counter < expression.getCount() && correct == true)){\n\t\t\tif(val instanceof CssURL){\n\t\t\t\tvalues.addElement(val);\n\t\t\t} else if(val instanceof CssFunction){\n\t\t\t} else {\n\t\t\t}\n\t\t\texpression.next();\n\t\t\tcounter++;\n\t\t\tval=expression.getValue();\n\t\t\top=expression.getOperator();\n\t\t}\n\t}\n}","Distance":0.4,"Automatic":"public ColorProfile(ApplContext ac,CssExpression expression,boolean check) throws InvalidParamException {\n\tCssValue val=expression.getValue();\n\tif(val.equals(inherit)){\n\t} else if(val.equals(auto)){\n\t} else if(val.equals(sRGB)){\n\t\tvalue=sRGB;\n\t\texpression.next();\n\t} else {\n\t\twhile((op == SPACE) && (counter < expression.getCount() && correct == true)){\n\t\t\tif(val instanceof CssURL){\n\t\t\t\tvalues.addElement(val);\n\t\t\t} else if(val instanceof CssFunction){\n\t\t\t} else {\n\t\t\t\tcorrect=false;\n\t\t\t\terrorval=val.toString();\n\t\t\t}\n\t\t\texpression.next();\n\t\t\tcounter++;\n\t\t\tval=expression.getValue();\n\t\t\top=expression.getOperator();\n\t\t}\n\t}\n}"},{"Origin":"public ColorProfileSrc(ApplContext ac,CssExpression expression,boolean check) throws InvalidParamException {\n\tchar op=expression.getOperator();\n\tCssValue val=expression.getValue();\n\tif((val.toString().toLowerCase()).equals(\"srgb\")){\n\t\tcpSrc=sRGB;\n\t\texpression.next();\n\t} else if(val instanceof CssFunction){\n\t\tCssFunction fun=(CssFunction)val;\n\t\tCssExpression params=fun.getParameters();\n\t\tif(fun.getName().equals(\"local\")){\n\t\t\tif((params.getCount() == 1)){\n\t\t\t\tcpSrc=val;\n\t\t\t\texpression.next();\n\t\t\t} else {\n\t\t\t\tthrow new InvalidParamException(\"value\",params.getValue(),getPropertyName(),ac);\n\t\t\t}\n\t\t} else {\n\t\t\tthrow new InvalidParamException(\"value\",val,getPropertyName(),ac);\n\t\t}\n\t\tval=expression.getValue();\n\t\tif(val != null){\n\t\t\tif(op != SPACE){\n\t\t\t\tthrow new InvalidParamException(\"operator\",new Character(op),getPropertyName(),ac);\n\t\t\t}\n\t\t\tif(val instanceof CssURL){\n\t\t\t\tcpSrcs.addElement(cpSrc);\n\t\t\t\tcpSrcs.addElement(val);\n\t\t\t\tcpSrc=null;\n\t\t\t\texpression.next();\n\t\t\t}\n\t\t}\n\t} else if(val instanceof CssURL){\n\t\tcpSrc=val;\n\t\texpression.next();\n\t} else {\n\t\tthrow new InvalidParamException(\"cpSrc\",expression.getValue(),getPropertyName(),ac);\n\t}\n}","Original_Lines":36,"Target_Lines":27,"Manual":"public ColorProfileSrc(ApplContext ac,CssExpression expression,boolean check) throws InvalidParamException {\n\tchar op=expression.getOperator();\n\tCssValue val=expression.getValue();\n\tif((val.toString().toLowerCase()).equals(\"srgb\")){\n\t\tcpSrc=sRGB;\n\t\texpression.next();\n\t} else if(val instanceof CssFunction){\n\t\tCssFunction fun=(CssFunction)val;\n\t\tCssExpression params=fun.getParameters();\n\t\tif(fun.getName().equals(\"local\")){\n\t\t} else {\n\t\t}\n\t\tval=expression.getValue();\n\t\tif(val != null){\n\t\t\tif(op != SPACE){\n\t\t\t}\n\t\t\tif(val instanceof CssURL){\n\t\t\t\tcpSrcs.addElement(cpSrc);\n\t\t\t\tcpSrcs.addElement(val);\n\t\t\t\tcpSrc=null;\n\t\t\t\texpression.next();\n\t\t\t}\n\t\t}\n\t} else if(val instanceof CssURL){\n\t\tcpSrc=val;\n\t\texpression.next();\n\t} else {\n\t}\n}","Distance":0.13636363636363635,"Automatic":"public ColorProfileSrc(ApplContext ac,CssExpression expression,boolean check) throws InvalidParamException {\n\tchar op=expression.getOperator();\n\tCssValue val=expression.getValue();\n\tif((val.toString().toLowerCase()).equals(\"srgb\")){\n\t\tcpSrc=sRGB;\n\t\texpression.next();\n\t} else if(val instanceof CssFunction){\n\t\tCssFunction fun=(CssFunction)val;\n\t\tCssExpression params=fun.getParameters();\n\t\tif(fun.getName().equals(\"local\")){\n\t\t} else {\n\t\t\tthrow new InvalidParamException(\"value\",val,getPropertyName(),ac);\n\t\t}\n\t\tval=expression.getValue();\n\t\tif(val != null){\n\t\t\tif(val instanceof CssURL){\n\t\t\t\tcpSrcs.addElement(cpSrc);\n\t\t\t\tcpSrcs.addElement(val);\n\t\t\t\tcpSrc=null;\n\t\t\t\texpression.next();\n\t\t\t}\n\t\t}\n\t} else if(val instanceof CssURL){\n\t\tcpSrc=val;\n\t\texpression.next();\n\t} else {\n\t\tthrow new InvalidParamException(\"cpSrc\",expression.getValue(),getPropertyName(),ac);\n\t}\n}"},{"Origin":"public EnableBackground(ApplContext ac,CssExpression expression,boolean check) throws InvalidParamException {\n\tthis.ac=ac;\n\tsetByUser();\n\tCssValue val=expression.getValue();\n\tchar op=SPACE;\n\tif(val instanceof CssIdent){\n\t\tif(val.equals(inherit)){\n\t\t\tvalue=inherit;\n\t\t\texpression.next();\n\t\t} else if(val.equals(accumulate)){\n\t\t\tvalue=accumulate;\n\t\t\texpression.next();\n\t\t} else {\n\t\t\tthrow new InvalidParamException(\"value\",val.toString(),getPropertyName(),ac);\n\t\t}\n\t} else if(val instanceof CssNumber){\n\t\tvalues.addElement(val);\n\t\texpression.next();\n\t\tval=expression.getValue();\n\t\top=expression.getOperator();\n\t\tif(val instanceof CssNumber){\n\t\t\tvalues.addElement(val);\n\t\t\texpression.next();\n\t\t} else {\n\t\t\tthrow new InvalidParamException(\"value\",val.toString(),getPropertyName(),ac);\n\t\t}\n\t\tval=expression.getValue();\n\t\top=expression.getOperator();\n\t\ttry {\n\t\t\tCssWidth width=new CssWidth(ac,expression);\n\t\t\tvalues.addElement(width);\n\t\t} catch (InvalidParamException e){\n\t\t\tthrow new InvalidParamException(\"value\",val.toString(),getPropertyName(),ac);\n\t\t} \n\t\tval=expression.getValue();\n\t\top=expression.getOperator();\n\t\ttry {\n\t\t\tCssWidth width=new CssWidth(ac,expression);\n\t\t\tvalues.addElement(width);\n\t\t\texpression.next();\n\t\t} catch (InvalidParamException e){\n\t\t\tthrow new InvalidParamException(\"value\",val.toString(),getPropertyName(),ac);\n\t\t} \n\t} else {\n\t\tthrow new InvalidParamException(\"value\",val.toString(),getPropertyName(),ac);\n\t}\n}","Original_Lines":45,"Target_Lines":36,"Manual":"public EnableBackground(ApplContext ac,CssExpression expression,boolean check) throws InvalidParamException {\n\tthis.ac=ac;\n\tsetByUser();\n\tCssValue val=expression.getValue();\n\tchar op=SPACE;\n\tif(val instanceof CssIdent){\n\t\tif(val.equals(inherit)){\n\t\t} else if(val.equals(accumulate)){\n\t\t} else {\n\t\t}\n\t} else if(val instanceof CssNumber){\n\t\tvalues.addElement(val);\n\t\texpression.next();\n\t\tval=expression.getValue();\n\t\top=expression.getOperator();\n\t\tif(val instanceof CssNumber){\n\t\t\tvalues.addElement(val);\n\t\t\texpression.next();\n\t\t} else {\n\t\t}\n\t\tval=expression.getValue();\n\t\top=expression.getOperator();\n\t\ttry {\n\t\t\tCssWidth width=new CssWidth(ac,expression);\n\t\t\tvalues.addElement(width);\n\t\t} catch (InvalidParamException e){\n\t\t} \n\t\tval=expression.getValue();\n\t\top=expression.getOperator();\n\t\ttry {\n\t\t\tCssWidth width=new CssWidth(ac,expression);\n\t\t\tvalues.addElement(width);\n\t\t\texpression.next();\n\t\t} catch (InvalidParamException e){\n\t\t} \n\t} else {\n\t}\n}","Distance":0.35294117647058826,"Automatic":"public EnableBackground(ApplContext ac,CssExpression expression,boolean check) throws InvalidParamException {\n\tthis.ac=ac;\n\tCssValue val=expression.getValue();\n\tchar op=SPACE;\n\tif(val instanceof CssIdent){\n\t\tif(val.equals(inherit)){\n\t\t\tvalue=inherit;\n\t\t\texpression.next();\n\t\t} else if(val.equals(accumulate)){\n\t\t\tvalue=accumulate;\n\t\t\texpression.next();\n\t\t} else {\n\t\t\tthrow new InvalidParamException(\"value\",val.toString(),getPropertyName(),ac);\n\t\t}\n\t} else if(val instanceof CssNumber){\n\t\tvalues.addElement(val);\n\t\texpression.next();\n\t\tval=expression.getValue();\n\t\top=expression.getOperator();\n\t\tval=expression.getValue();\n\t\top=expression.getOperator();\n\t\ttry {\n\t\t\tCssWidth width=new CssWidth(ac,expression);\n\t\t\tvalues.addElement(width);\n\t\t} catch (InvalidParamException e){\n\t\t\tthrow new InvalidParamException(\"value\",val.toString(),getPropertyName(),ac);\n\t\t} \n\t\tval=expression.getValue();\n\t\top=expression.getOperator();\n\t\ttry {\n\t\t\tCssWidth width=new CssWidth(ac,expression);\n\t\t\tvalues.addElement(width);\n\t\t\texpression.next();\n\t\t} catch (InvalidParamException e){\n\t\t\tthrow new InvalidParamException(\"value\",val.toString(),getPropertyName(),ac);\n\t\t} \n\t} else {\n\t\tthrow new InvalidParamException(\"value\",val.toString(),getPropertyName(),ac);\n\t}\n}"},{"Origin":"public FloodColor(ApplContext ac,CssExpression expression,boolean check) throws InvalidParamException {\n\tthis.ac=ac;\n\tsetByUser();\n\tCssValue val=expression.getValue();\n\tboolean correct=true;\n\tString errorval=\"\";\n\tchar op=expression.getOperator();\n\tif(val.equals(inherit)){\n\t\tfloodColor=inherit;\n\t\texpression.next();\n\t} else if(val.equals(currentColor)){\n\t\tfloodColor=currentColor;\n\t\texpression.next();\n\t} else {\n\t\ttry {\n\t\t\tCssColor color=new CssColor(ac,expression);\n\t\t\tvalues.addElement(val);\n\t\t} catch (InvalidParamException e){\n\t\t\tcorrect=false;\n\t\t\terrorval=val.toString();\n\t\t} \n\t\top=expression.getOperator();\n\t\tval=expression.getValue();\n\t\tif(val != null){\n\t\t\tif(val instanceof CssFunction){\n\t\t\t\tCssValue function=val;\n\t\t\t\tif(!((CssFunction)val).getName().equals(\"icc-color\")){\n\t\t\t\t\tcorrect=false;\n\t\t\t\t\terrorval=val.toString();\n\t\t\t\t} else {\n\t\t\t\t\tCssExpression params=((CssFunction)val).getParameters();\n\t\t\t\t\top=params.getOperator();\n\t\t\t\t\tval=params.getValue();\n\t\t\t\t\tif(!(val instanceof CssIdent)){\n\t\t\t\t\t\tcorrect=false;\n\t\t\t\t\t\terrorval=val.toString();\n\t\t\t\t\t}\n\t\t\t\t\tparams.next();\n\t\t\t\t\top=params.getOperator();\n\t\t\t\t\tval=params.getValue();\n\t\t\t\t\tif(!params.end()){\n\t\t\t\t\t\tint counter=0;\n\t\t\t\t\t\twhile((op == COMMA || op == SPACE) && (counter < (params.getCount() - 1) && correct == true)){\n\t\t\t\t\t\t\tif((!(val instanceof CssNumber)) || (((CssNumber)val).getValue() < 0)){\n\t\t\t\t\t\t\t\tcorrect=false;\n\t\t\t\t\t\t\t\terrorval=val.toString();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tparams.next();\n\t\t\t\t\t\t\tcounter++;\n\t\t\t\t\t\t\tval=params.getValue();\n\t\t\t\t\t\t\top=params.getOperator();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif(correct){\n\t\t\t\t\t\tparams.starts();\n\t\t\t\t\t\tvalues.addElement(function);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tcorrect=false;\n\t\t\t\terrorval=val.toString();\n\t\t\t}\n\t\t} else {\n\t\t\tcorrect=false;\n\t\t\terrorval=new String(\"\");\n\t\t}\n\t\texpression.next();\n\t}\n\tif(!correct){\n\t\tthrow new InvalidParamException(\"value\",errorval,getPropertyName(),ac);\n\t}\n}","Original_Lines":70,"Target_Lines":44,"Manual":"public FloodColor(ApplContext ac,CssExpression expression,boolean check) throws InvalidParamException {\n\tthis.ac=ac;\n\tsetByUser();\n\tCssValue val=expression.getValue();\n\tif(val.equals(inherit)){\n\t} else if(val.equals(currentColor)){\n\t} else {\n\t\ttry {\n\t\t\tCssColor color=new CssColor(ac,expression);\n\t\t\tvalues.addElement(val);\n\t\t} catch (InvalidParamException e){\n\t\t} \n\t\top=expression.getOperator();\n\t\tval=expression.getValue();\n\t\tif(val != null){\n\t\t\tif(val instanceof CssFunction){\n\t\t\t\tCssValue function=val;\n\t\t\t\tif(!((CssFunction)val).getName().equals(\"icc-color\")){\n\t\t\t\t} else {\n\t\t\t\t\tCssExpression params=((CssFunction)val).getParameters();\n\t\t\t\t\top=params.getOperator();\n\t\t\t\t\tval=params.getValue();\n\t\t\t\t\tparams.next();\n\t\t\t\t\top=params.getOperator();\n\t\t\t\t\tval=params.getValue();\n\t\t\t\t\tif(!params.end()){\n\t\t\t\t\t\tint counter=0;\n\t\t\t\t\t\twhile((op == COMMA || op == SPACE) && (counter < (params.getCount() - 1) && correct == true)){\n\t\t\t\t\t\t\tparams.next();\n\t\t\t\t\t\t\tcounter++;\n\t\t\t\t\t\t\tval=params.getValue();\n\t\t\t\t\t\t\top=params.getOperator();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif(correct){\n\t\t\t\t\t\tparams.starts();\n\t\t\t\t\t\tvalues.addElement(function);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t}\n\t\t} else {\n\t\t}\n\t\texpression.next();\n\t}\n}","Distance":0.14705882352941177,"Automatic":"public FloodColor(ApplContext ac,CssExpression expression,boolean check) throws InvalidParamException {\n\tCssValue val=expression.getValue();\n\tchar op=expression.getOperator();\n\tif(val.equals(inherit)){\n\t} else if(val.equals(currentColor)){\n\t} else {\n\t\ttry {\n\t\t\tCssColor color=new CssColor(ac,expression);\n\t\t\tvalues.addElement(val);\n\t\t} catch (InvalidParamException e){\n\t\t} \n\t\top=expression.getOperator();\n\t\tval=expression.getValue();\n\t\tif(val != null){\n\t\t\tif(val instanceof CssFunction){\n\t\t\t\tCssValue function=val;\n\t\t\t\tif(!((CssFunction)val).getName().equals(\"icc-color\")){\n\t\t\t\t} else {\n\t\t\t\t\tCssExpression params=((CssFunction)val).getParameters();\n\t\t\t\t\top=params.getOperator();\n\t\t\t\t\tval=params.getValue();\n\t\t\t\t\tparams.next();\n\t\t\t\t\top=params.getOperator();\n\t\t\t\t\tval=params.getValue();\n\t\t\t\t\tif(!params.end()){\n\t\t\t\t\t\tint counter=0;\n\t\t\t\t\t\twhile((op == COMMA || op == SPACE) && (counter < (params.getCount() - 1) && correct == true)){\n\t\t\t\t\t\t\tparams.next();\n\t\t\t\t\t\t\tcounter++;\n\t\t\t\t\t\t\tval=params.getValue();\n\t\t\t\t\t\t\top=params.getOperator();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif(correct){\n\t\t\t\t\t\tparams.starts();\n\t\t\t\t\t\tvalues.addElement(function);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tcorrect=false;\n\t\t\t\terrorval=val.toString();\n\t\t\t}\n\t\t} else {\n\t\t}\n\t\texpression.next();\n\t}\n}"}],"ObjectiveFunctionValue":0.30231573814416857,"Iterations":100000}